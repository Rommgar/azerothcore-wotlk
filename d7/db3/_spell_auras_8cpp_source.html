<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Azerotcore-wotlk: src/server/game/Spells/Auras/SpellAuras.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Azerotcore-wotlk
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_075bb3ff235063c77951cd176d15a741.html">server</a></li><li class="navelem"><a class="el" href="../../dir_6f9eed72e6ac35fa9b9946c34be827b2.html">game</a></li><li class="navelem"><a class="el" href="../../dir_28109df01c3e8d9e4b0f50ca11224ae3.html">Spells</a></li><li class="navelem"><a class="el" href="../../dir_4db58f7ee0023c1be25a3610f51566de.html">Auras</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">SpellAuras.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d7/db3/_spell_auras_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * This file is part of the AzerothCore Project. See AUTHORS file for Copyright information</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * This program is free software; you can redistribute it and/or modify it</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * under the terms of the GNU Affero General Public License as published by the</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * Free Software Foundation; either version 3 of the License, or (at your</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * option) any later version.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * This program is distributed in the hope that it will be useful, but WITHOUT</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * more details.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You should have received a copy of the GNU General Public License along</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/ded/_arena_spectator_8h.html">ArenaSpectator.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d39/_cell_impl_8h.html">CellImpl.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;Common.h&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/db0/_dynamic_object_8h.html">DynamicObject.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/dc9/_grid_notifiers_8h.html">GridNotifiers.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/df9/_grid_notifiers_impl_8h.html">GridNotifiersImpl.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;Log.h&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d59/_object_accessor_8h.html">ObjectAccessor.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d77/_object_mgr_8h.html">ObjectMgr.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d10/_opcodes_8h.html">Opcodes.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d39/_player_8h.html">Player.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/d7d/_script_mgr_8h.html">ScriptMgr.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/dfa/_spell_8h.html">Spell.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d82/_spell_aura_effects_8h.html">SpellAuraEffects.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d75/_spell_mgr_8h.html">SpellMgr.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/df6/_spell_script_8h.html">SpellScript.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d32/_unit_8h.html">Unit.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;Util.h&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d90/_vehicle_8h.html">Vehicle.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d66/_world_packet_8h.html">WorldPacket.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">// update aura target map every 500 ms instead of every update - reduce amount of grid searcher calls</span></div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="../../d7/db3/_spell_auras_8cpp.html#a49c1eff45f8eb67e523f8593923a5df0">   40</a></span>&#160;<span class="keyword">static</span> constexpr <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> <a class="code" href="../../d7/db3/_spell_auras_8cpp.html#a49c1eff45f8eb67e523f8593923a5df0">UPDATE_TARGET_MAP_INTERVAL</a> = 500;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="../../d8/da3/class_aura_application.html#ace7adda123954ef4cd5c5f9837b9708a">   42</a></span>&#160;<a class="code" href="../../d8/da3/class_aura_application.html#ace7adda123954ef4cd5c5f9837b9708a">AuraApplication::AuraApplication</a>(<a class="code" href="../../da/db7/class_unit.html">Unit</a>* target, <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster, <a class="code" href="../../d2/dde/class_aura.html">Aura</a>* aura, <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> effMask):</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    _target(target), _base(aura), _removeMode(<a class="code" href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94a1d65b866fb33f41d71498231aeb4e6e5">AURA_REMOVE_NONE</a>), _slot(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a4c7deb1171a45d3528d20c5534828707">MAX_AURAS</a>),</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    _flags(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#ab37150561c6522271a12b3ea9778fe24a8164f31786209a706f519d4e4256d66f">AFLAG_NONE</a>), _effectsToApply(effMask), _needClientUpdate(<a class="code" href="../../db/def/_c99_2stdbool_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>), _disableMask(0)</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(<a class="code" href="../../d8/da3/class_aura_application.html#a48f6d82daf06f6f2ced98484c2b56248">GetTarget</a>() &amp;&amp; <a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>());</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>()-&gt;CanBeSentToClient())</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="comment">// Try find slot for aura</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> slot = <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a4c7deb1171a45d3528d20c5534828707">MAX_AURAS</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="comment">// Lookup for auras already applied from spell</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a>* foundAura = <a class="code" href="../../d8/da3/class_aura_application.html#a48f6d82daf06f6f2ced98484c2b56248">GetTarget</a>()-&gt;GetAuraApplication(<a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>()-&gt;<a class="code" href="../../df/d1b/namespace_account_mgr.html#aa215c9a96c37b8a5d76d980ecf8de114">GetId</a>(), <a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>()-&gt;GetCasterGUID(), <a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>()-&gt;GetCastItemGUID()))</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            <span class="comment">// allow use single slot only by auras from same caster</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            slot = foundAura-&gt;GetSlot();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            <a class="code" href="../../da/db7/class_unit.html#a6bbd36a660c01a3d5f3e28a6e8eb894c">Unit::VisibleAuraMap</a> <span class="keyword">const</span>* visibleAuras = <a class="code" href="../../d8/da3/class_aura_application.html#a48f6d82daf06f6f2ced98484c2b56248">GetTarget</a>()-&gt;<a class="code" href="../../da/db7/class_unit.html#a287b4053316a12110b478f5e757a3055">GetVisibleAuras</a>();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <span class="comment">// lookup for free slots in units visibleAuras</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            Unit::VisibleAuraMap::const_iterator itr = visibleAuras-&gt;find(0);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> freeSlot = 0; freeSlot &lt; <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a4c7deb1171a45d3528d20c5534828707">MAX_AURAS</a>; ++itr, ++freeSlot)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                <span class="keywordflow">if</span> (itr == visibleAuras-&gt;end() || itr-&gt;first != freeSlot)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                    slot = freeSlot;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="comment">// Register Visible Aura</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">if</span> (slot &lt; <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a4c7deb1171a45d3528d20c5534828707">MAX_AURAS</a>)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <a class="code" href="../../d8/da3/class_aura_application.html#a233ba733e1634be3a745665de8925e25">_slot</a> = slot;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <a class="code" href="../../d8/da3/class_aura_application.html#a48f6d82daf06f6f2ced98484c2b56248">GetTarget</a>()-&gt;<a class="code" href="../../da/db7/class_unit.html#aa0334351e83f140bc1af4c9ed33557c4">SetVisibleAura</a>(slot, <span class="keyword">this</span>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <a class="code" href="../../d8/da3/class_aura_application.html#ad15259f132b607f215d94e43ddd69009">SetNeedClientUpdate</a>();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <a class="code" href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a47ac782b14a7531c6232777165a1a161">LOG_DEBUG</a>(<span class="stringliteral">&quot;spells.aura&quot;</span>, <span class="stringliteral">&quot;Aura: %u Effect: %d put to unit visible auras slot: %u&quot;</span>, <a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>()-&gt;<a class="code" href="../../df/d1b/namespace_account_mgr.html#aa215c9a96c37b8a5d76d980ecf8de114">GetId</a>(), <a class="code" href="../../d8/da3/class_aura_application.html#a5f37e8e4c660272fa2e73721604b7e97">GetEffectMask</a>(), slot);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <a class="code" href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a43832e3fa8508deb4ce43e520005fcd9">LOG_ERROR</a>(<span class="stringliteral">&quot;spells.aura&quot;</span>, <span class="stringliteral">&quot;Aura: %u Effect: %d could not find empty unit visible slot&quot;</span>, <a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>()-&gt;<a class="code" href="../../df/d1b/namespace_account_mgr.html#aa215c9a96c37b8a5d76d980ecf8de114">GetId</a>(), <a class="code" href="../../d8/da3/class_aura_application.html#a5f37e8e4c660272fa2e73721604b7e97">GetEffectMask</a>());</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="../../d8/da3/class_aura_application.html#a6beb5bdaa8621586c7ff7ca0b436a30c">_InitFlags</a>(caster, effMask);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;}</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="../../d8/da3/class_aura_application.html#a99ef59ad583a7802b21f6799d58d2017">   89</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/da3/class_aura_application.html#a99ef59ad583a7802b21f6799d58d2017">AuraApplication::_Remove</a>()</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> slot = <a class="code" href="../../d8/da3/class_aura_application.html#ab216ef41e9d7370cb5fcfce7d42f84cc">GetSlot</a>();</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">if</span> (slot &gt;= <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a4c7deb1171a45d3528d20c5534828707">MAX_AURAS</a>)</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a>* foundAura = <a class="code" href="../../d8/da3/class_aura_application.html#af9dc1969efa6eb3dbab368a3f09e0f9c">_target</a>-&gt;<a class="code" href="../../da/db7/class_unit.html#a3ac5eb5e55d7c23cda7d7a7f3d23cc68">GetAuraApplication</a>(<a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>()-&gt;<a class="code" href="../../df/d1b/namespace_account_mgr.html#aa215c9a96c37b8a5d76d980ecf8de114">GetId</a>(), <a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>()-&gt;GetCasterGUID(), <a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>()-&gt;GetCastItemGUID()))</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="comment">// Reuse visible aura slot by aura which is still applied - prevent storing dead pointers</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">if</span> (slot == foundAura-&gt;GetSlot())</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d8/da3/class_aura_application.html#a48f6d82daf06f6f2ced98484c2b56248">GetTarget</a>()-&gt;GetVisibleAura(slot) == <span class="keyword">this</span>)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                <a class="code" href="../../d8/da3/class_aura_application.html#a48f6d82daf06f6f2ced98484c2b56248">GetTarget</a>()-&gt;<a class="code" href="../../da/db7/class_unit.html#aa0334351e83f140bc1af4c9ed33557c4">SetVisibleAura</a>(slot, foundAura);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                foundAura-&gt;SetNeedClientUpdate();</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <span class="comment">// set not valid slot for aura - prevent removing other visible aura</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            slot = <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a4c7deb1171a45d3528d20c5534828707">MAX_AURAS</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// update for out of range group members</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">if</span> (slot &lt; <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a4c7deb1171a45d3528d20c5534828707">MAX_AURAS</a>)</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <a class="code" href="../../d8/da3/class_aura_application.html#a48f6d82daf06f6f2ced98484c2b56248">GetTarget</a>()-&gt;<a class="code" href="../../da/db7/class_unit.html#a4bc8894be0429317c16b9caa371032f6">RemoveVisibleAura</a>(slot);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <a class="code" href="../../d8/da3/class_aura_application.html#a45c36a5104886209be9fb1819924f106">ClientUpdate</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="../../d8/da3/class_aura_application.html#a6beb5bdaa8621586c7ff7ca0b436a30c">  119</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/da3/class_aura_application.html#a6beb5bdaa8621586c7ff7ca0b436a30c">AuraApplication::_InitFlags</a>(<a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster, <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> effMask)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// mark as selfcasted if needed</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="../../d8/da3/class_aura_application.html#abb45aa5fa55c1e566e16022a972d72d6">_flags</a> |= (<a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>()-&gt;<a class="code" href="../../d2/dde/class_aura.html#a3c4dfe75dad16fbf2afaf23ce77e4262">GetCasterGUID</a>() == <a class="code" href="../../d8/da3/class_aura_application.html#a48f6d82daf06f6f2ced98484c2b56248">GetTarget</a>()-&gt;<a class="code" href="../../d8/d83/class_object.html#ad23b997e2442fa6a6228ba73a7ecc138">GetGUID</a>()) ? <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#ab37150561c6522271a12b3ea9778fe24aa45c6dd1c787f9a244b1da6a457992a6">AFLAG_CASTER</a> : <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#ab37150561c6522271a12b3ea9778fe24a8164f31786209a706f519d4e4256d66f">AFLAG_NONE</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// aura is casted by self or an enemy</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// one negative effect and we know aura is negative</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/da3/class_aura_application.html#aa47dcf75b9d9676aee31bab4dbdb92aa">IsSelfcasted</a>() || !caster || !caster-&gt;<a class="code" href="../../da/db7/class_unit.html#abdfe022523c40277d917754f75edb722">IsFriendlyTo</a>(<a class="code" href="../../d8/da3/class_aura_application.html#a48f6d82daf06f6f2ced98484c2b56248">GetTarget</a>()))</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordtype">bool</span> negativeFound = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordflow">if</span> (((1 &lt;&lt; i) &amp; effMask) &amp;&amp; !<a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>()-&gt;<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#afbd5cba63decf0bf28500d4fc795bc44">IsPositiveEffect</a>(i))</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                negativeFound = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <a class="code" href="../../d8/da3/class_aura_application.html#abb45aa5fa55c1e566e16022a972d72d6">_flags</a> |= negativeFound ? <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#ab37150561c6522271a12b3ea9778fe24a8b96c862bd69c042bbfe15b27fe32edd">AFLAG_NEGATIVE</a> : <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#ab37150561c6522271a12b3ea9778fe24a22252331a1f6efa27b043fa107a2b6e9">AFLAG_POSITIVE</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// aura is casted by friend</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// one positive effect and we know aura is positive</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordtype">bool</span> positiveFound = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="keywordflow">if</span> (((1 &lt;&lt; i) &amp; effMask) &amp;&amp; <a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>()-&gt;<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#afbd5cba63decf0bf28500d4fc795bc44">IsPositiveEffect</a>(i))</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                positiveFound = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <a class="code" href="../../d8/da3/class_aura_application.html#abb45aa5fa55c1e566e16022a972d72d6">_flags</a> |= positiveFound ? <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#ab37150561c6522271a12b3ea9778fe24a22252331a1f6efa27b043fa107a2b6e9">AFLAG_POSITIVE</a> : <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#ab37150561c6522271a12b3ea9778fe24a8b96c862bd69c042bbfe15b27fe32edd">AFLAG_NEGATIVE</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="../../d8/da3/class_aura_application.html#a6319e8a7e0abd0e572f41c099378b5da">  156</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/da3/class_aura_application.html#a6319e8a7e0abd0e572f41c099378b5da">AuraApplication::_HandleEffect</a>(<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> effIndex, <span class="keywordtype">bool</span> <a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a>)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;{</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* aurEff = <a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>()-&gt;<a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(effIndex);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(aurEff);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(<a class="code" href="../../d8/da3/class_aura_application.html#af3e44cda4fe299e5bf2ba8ca37142cba">HasEffect</a>(effIndex) == (!<a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a>));</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>((1 &lt;&lt; effIndex) &amp; <a class="code" href="../../d8/da3/class_aura_application.html#a5c7a5164ed0a58b967de33c5fc578292">_effectsToApply</a>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a47ac782b14a7531c6232777165a1a161">LOG_DEBUG</a>(<span class="stringliteral">&quot;spells.aura&quot;</span>, <span class="stringliteral">&quot;AuraApplication::_HandleEffect: %u, apply: %u: amount: %u&quot;</span>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a120cf8a45a3c816e4ef588733fa812e5">GetAuraType</a>(), <a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#afcf272bebf373ad3aebc03cce644cbee">GetAmount</a>());</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a>)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(!(<a class="code" href="../../d8/da3/class_aura_application.html#abb45aa5fa55c1e566e16022a972d72d6">_flags</a> &amp; (1 &lt;&lt; effIndex)));</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <a class="code" href="../../d8/da3/class_aura_application.html#abb45aa5fa55c1e566e16022a972d72d6">_flags</a> |= 1 &lt;&lt; effIndex;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a7710e32fe9dc267292c3b15333521560">HandleEffect</a>(<span class="keyword">this</span>, <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a82ebee9e3cf7eaf2ab892a6eb7796288a9db592566b0111486336c591e7a06e2b">AURA_EFFECT_HANDLE_REAL</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(<a class="code" href="../../d8/da3/class_aura_application.html#abb45aa5fa55c1e566e16022a972d72d6">_flags</a> &amp; (1 &lt;&lt; effIndex));</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <a class="code" href="../../d8/da3/class_aura_application.html#abb45aa5fa55c1e566e16022a972d72d6">_flags</a> &amp;= ~(1 &lt;&lt; effIndex);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a7710e32fe9dc267292c3b15333521560">HandleEffect</a>(<span class="keyword">this</span>, <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a82ebee9e3cf7eaf2ab892a6eb7796288a9db592566b0111486336c591e7a06e2b">AURA_EFFECT_HANDLE_REAL</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="comment">// Remove all triggered by aura spells vs unlimited duration</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ac313992b1527bbeddf09365da0d28ebc">CleanupTriggeredSpells</a>(<a class="code" href="../../d8/da3/class_aura_application.html#a48f6d82daf06f6f2ced98484c2b56248">GetTarget</a>());</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">// Stacking!</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> groupId = aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a36e4e8b964658519a723d668b7ad0bba">GetAuraGroup</a>())</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <a class="code" href="../../d3/d75/_spell_mgr_8h.html#a3384f828e7f362dbdaecb22673641c88">SpellGroupStackFlags</a> sFlag = <a class="code" href="../../d3/d75/_spell_mgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>-&gt;GetGroupStackFlags(groupId);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">if</span> (!aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a7d45367044e196745676c63d61fbd89d">IsPeriodic</a>() &amp;&amp; (sFlag &amp; <a class="code" href="../../d3/d75/_spell_mgr_8h.html#a3384f828e7f362dbdaecb22673641c88ae78c94e5be26a7c2c8f4dcd4d22c9036">SPELL_GROUP_STACK_FLAG_EFFECT_EXCLUSIVE</a>))</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a>* strongestApp = <a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a> ? this : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* strongestEff = <a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a> ? aurEff : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> amount = <a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a> ? <a class="code" href="../../d0/d45/_matrix_8h.html#aaf9f9f8a87c718439346b4e96107f5e9">abs</a>(aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#afcf272bebf373ad3aebc03cce644cbee">GetAmount</a>()) : 0;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <a class="code" href="../../da/db7/class_unit.html">Unit</a>* target = <a class="code" href="../../d8/da3/class_aura_application.html#a48f6d82daf06f6f2ced98484c2b56248">GetTarget</a>();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <a class="code" href="../../da/db7/class_unit.html#adcdd87d0c137619dfc869536c1315dd7">Unit::AuraEffectList</a> <span class="keyword">const</span>&amp; auraList = target-&gt;<a class="code" href="../../da/db7/class_unit.html#af00ac6c4dc7e639ac646fdafef336e85">GetAuraEffectsByType</a>(aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a120cf8a45a3c816e4ef588733fa812e5">GetAuraType</a>());</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keywordflow">for</span> (Unit::AuraEffectList::const_iterator iter = auraList.begin(); iter != auraList.end(); ++iter)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="keywordflow">if</span> ((*iter)-&gt;GetAuraGroup() != groupId || (*iter) == strongestEff || (*iter)-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a0417bd1d648cb9d2888937ddad75788c">GetBase</a>()-&gt;<a class="code" href="../../d2/dde/class_aura.html#a462457cadd52ba8a0edd5609c71ebbc0">IsRemoved</a>())</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <span class="comment">// xinef: skip different misc values</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                <span class="keywordflow">if</span> (aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a120cf8a45a3c816e4ef588733fa812e5">GetAuraType</a>() != <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799aba7e00a7ce6cd006b67262e5e3731364">SPELL_AURA_230</a> <span class="comment">/*SPELL_AURA_MOD_INCREASE_HEALTH_2*/</span> &amp;&amp; aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a120cf8a45a3c816e4ef588733fa812e5">GetAuraType</a>() != <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799af034ae8de320204d3de55be2f4eb6919">SPELL_AURA_MOD_CASTING_SPEED_NOT_STACK</a> &amp;&amp;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                        aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#aa183791665930afb43bbac2163b1d8d4">GetMiscValue</a>() != (*iter)-&gt;GetMiscValue())</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                <span class="comment">// xinef: should not happen</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a>* aurApp = (*iter)-&gt;<a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>()-&gt;<a class="code" href="../../d2/dde/class_aura.html#a9fb02e4e6e4b16378e89d2126cc291e7">GetApplicationOfTarget</a>(target-&gt;<a class="code" href="../../d8/d83/class_object.html#ad23b997e2442fa6a6228ba73a7ecc138">GetGUID</a>());</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                <span class="keywordflow">if</span> (!aurApp)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                <span class="keywordflow">if</span> (amount &lt; <a class="code" href="../../d0/d45/_matrix_8h.html#aaf9f9f8a87c718439346b4e96107f5e9">abs</a>((*iter)-&gt;GetForcedAmount()))</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                    <span class="comment">// xinef: if we have strongest aura and it is active, turn it off</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                    <span class="comment">// xinef: otherwise just save new aura;</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                    <span class="keywordflow">if</span> (strongestApp &amp;&amp; strongestEff &amp;&amp; strongestApp-&gt;<a class="code" href="../../d8/da3/class_aura_application.html#a051b0814a63b9398b523a6bfd23998d2">IsActive</a>(strongestEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>()))</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                    {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                        strongestEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a7710e32fe9dc267292c3b15333521560">HandleEffect</a>(strongestApp, <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a82ebee9e3cf7eaf2ab892a6eb7796288a2b4b8f92986980a3905f0c2d299beaae">AURA_EFFECT_HANDLE_CHANGE_AMOUNT</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                        <span class="keywordflow">if</span> (!strongestEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a93f49c4b2f8cabfc0372c8aef24f022e">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#abdcbf79c1c255a5f7029a93a75e5cebf">HasAreaAuraEffect</a>())</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                            strongestEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a063903240b281f490908845ef93ec68a">SetEnabled</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                        strongestApp-&gt;<a class="code" href="../../d8/da3/class_aura_application.html#af9f3adb73dfe0cfa9466091bb34e14ae">SetDisableMask</a>(strongestEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>());</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                    }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                    strongestApp = aurApp;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                    strongestEff = (*iter);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                    amount = <a class="code" href="../../d0/d45/_matrix_8h.html#aaf9f9f8a87c718439346b4e96107f5e9">abs</a>((*iter)-&gt;GetAmount());</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <span class="comment">// xinef: itered aura is weaker, deactivate if active</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (aurApp-&gt;<a class="code" href="../../d8/da3/class_aura_application.html#a051b0814a63b9398b523a6bfd23998d2">IsActive</a>((*iter)-&gt;GetEffIndex()))</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                    (*iter)-&gt;HandleEffect(aurApp, <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a82ebee9e3cf7eaf2ab892a6eb7796288a2b4b8f92986980a3905f0c2d299beaae">AURA_EFFECT_HANDLE_CHANGE_AMOUNT</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                    <span class="keywordflow">if</span> (!(*iter)-&gt;GetSpellInfo()-&gt;HasAreaAuraEffect())</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                        (*iter)-&gt;SetEnabled(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                    aurApp-&gt;<a class="code" href="../../d8/da3/class_aura_application.html#af9f3adb73dfe0cfa9466091bb34e14ae">SetDisableMask</a>((*iter)-&gt;GetEffIndex());</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="comment">// xinef: if we have new strongest aura, and it is not active</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="keywordflow">if</span> (strongestApp &amp;&amp; strongestEff &amp;&amp; !strongestApp-&gt;<a class="code" href="../../d8/da3/class_aura_application.html#a051b0814a63b9398b523a6bfd23998d2">IsActive</a>(strongestEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>()))</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                strongestApp-&gt;<a class="code" href="../../d8/da3/class_aura_application.html#a9025ca75394343521cf0a7c3d454adc5">RemoveDisableMask</a>(strongestEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>());</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                strongestEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a063903240b281f490908845ef93ec68a">SetEnabled</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                strongestEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a7710e32fe9dc267292c3b15333521560">HandleEffect</a>(strongestApp, <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a82ebee9e3cf7eaf2ab892a6eb7796288a2b4b8f92986980a3905f0c2d299beaae">AURA_EFFECT_HANDLE_CHANGE_AMOUNT</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="../../d8/da3/class_aura_application.html#ad15259f132b607f215d94e43ddd69009">SetNeedClientUpdate</a>();</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;}</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="../../d8/da3/class_aura_application.html#a4af52f837bff39572c28eea21ccb6b80">  243</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/da3/class_aura_application.html#a4af52f837bff39572c28eea21ccb6b80">AuraApplication::BuildUpdatePacket</a>(<a class="code" href="../../dd/d44/class_byte_buffer.html">ByteBuffer</a>&amp; <a class="code" href="../../df/dea/structdata.html">data</a>, <span class="keywordtype">bool</span> remove)<span class="keyword"> const</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="../../df/dea/structdata.html">data</a> &lt;&lt; <a class="code" href="../../df/de2/namespace_g3_d.html#aef6949de035da2287649c9db11ec3ba4">uint8</a>(<a class="code" href="../../d8/da3/class_aura_application.html#a233ba733e1634be3a745665de8925e25">_slot</a>);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> (remove)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(!<a class="code" href="../../d8/da3/class_aura_application.html#af9dc1969efa6eb3dbab368a3f09e0f9c">_target</a>-&gt;<a class="code" href="../../da/db7/class_unit.html#a142e7592a0de507230fc0c8868f9c49f">GetVisibleAura</a>(<a class="code" href="../../d8/da3/class_aura_application.html#a233ba733e1634be3a745665de8925e25">_slot</a>));</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <a class="code" href="../../df/dea/structdata.html">data</a> &lt;&lt; <a class="code" href="../../df/de2/namespace_g3_d.html#ae911b90657d7162d47997c702af655a8">uint32</a>(0);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(<a class="code" href="../../d8/da3/class_aura_application.html#af9dc1969efa6eb3dbab368a3f09e0f9c">_target</a>-&gt;<a class="code" href="../../da/db7/class_unit.html#a142e7592a0de507230fc0c8868f9c49f">GetVisibleAura</a>(<a class="code" href="../../d8/da3/class_aura_application.html#a233ba733e1634be3a745665de8925e25">_slot</a>));</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html">Aura</a> <span class="keyword">const</span>* aura = <a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>();</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="../../df/dea/structdata.html">data</a> &lt;&lt; <a class="code" href="../../df/de2/namespace_g3_d.html#ae911b90657d7162d47997c702af655a8">uint32</a>(aura-&gt;<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>());</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> flags = <a class="code" href="../../d8/da3/class_aura_application.html#abb45aa5fa55c1e566e16022a972d72d6">_flags</a>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">if</span> (aura-&gt;<a class="code" href="../../d2/dde/class_aura.html#a14457cfa6d589b8024bbeeb1d4aa03d3">GetMaxDuration</a>() &gt; 0 &amp;&amp; !aura-&gt;<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a975746d6b737abb063ea037327abfc5a">HasAttribute</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#a376aa62261a98289589839b821786adaa54ee0547b3e23ed80b12bf5a04573360">SPELL_ATTR5_DO_NOT_DISPLAY_DURATION</a>))</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        flags |= <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#ab37150561c6522271a12b3ea9778fe24af073599f1b898caf7f3b146e399040b4">AFLAG_DURATION</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="../../df/dea/structdata.html">data</a> &lt;&lt; <a class="code" href="../../df/de2/namespace_g3_d.html#aef6949de035da2287649c9db11ec3ba4">uint8</a>(flags);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="../../df/dea/structdata.html">data</a> &lt;&lt; <a class="code" href="../../df/de2/namespace_g3_d.html#aef6949de035da2287649c9db11ec3ba4">uint8</a>(aura-&gt;<a class="code" href="../../d2/dde/class_aura.html#a4ef16baec1bec4d7c5e1db67ce392035">GetCasterLevel</a>());</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// send stack amount for aura which could be stacked (never 0 - causes incorrect display) or charges</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// stack amount has priority over charges (checked on retail with spell 50262)</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="../../df/dea/structdata.html">data</a> &lt;&lt; <a class="code" href="../../df/de2/namespace_g3_d.html#aef6949de035da2287649c9db11ec3ba4">uint8</a>(aura-&gt;<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a46f51f384b1455b03000e98a08d11790">StackAmount</a> ? aura-&gt;<a class="code" href="../../d2/dde/class_aura.html#aae0b7e0da61a681e67a19b6d23c2cee6">GetStackAmount</a>() : aura-&gt;<a class="code" href="../../d2/dde/class_aura.html#ab07705be94c0c10fce558c80d7208e0b">GetCharges</a>());</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">if</span> (!(flags &amp; <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#ab37150561c6522271a12b3ea9778fe24aa45c6dd1c787f9a244b1da6a457992a6">AFLAG_CASTER</a>))</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <a class="code" href="../../df/dea/structdata.html">data</a> &lt;&lt; aura-&gt;<a class="code" href="../../d2/dde/class_aura.html#a3c4dfe75dad16fbf2afaf23ce77e4262">GetCasterGUID</a>().<a class="code" href="../../d8/d03/class_object_guid.html#a07e7802fc81a89510d4286ecf52ddb08">WriteAsPacked</a>();</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span> (flags &amp; <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#ab37150561c6522271a12b3ea9778fe24af073599f1b898caf7f3b146e399040b4">AFLAG_DURATION</a>)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <a class="code" href="../../df/dea/structdata.html">data</a> &lt;&lt; <a class="code" href="../../df/de2/namespace_g3_d.html#ae911b90657d7162d47997c702af655a8">uint32</a>(aura-&gt;<a class="code" href="../../d2/dde/class_aura.html#a14457cfa6d589b8024bbeeb1d4aa03d3">GetMaxDuration</a>());</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <a class="code" href="../../df/dea/structdata.html">data</a> &lt;&lt; <a class="code" href="../../df/de2/namespace_g3_d.html#ae911b90657d7162d47997c702af655a8">uint32</a>(aura-&gt;<a class="code" href="../../d2/dde/class_aura.html#a5e79eaa33b5f9ae5aaa44a62d096d6fe">GetDuration</a>());</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;}</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="../../d8/da3/class_aura_application.html#a45c36a5104886209be9fb1819924f106">  276</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d8/da3/class_aura_application.html#a45c36a5104886209be9fb1819924f106">AuraApplication::ClientUpdate</a>(<span class="keywordtype">bool</span> remove)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;{</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="../../d8/da3/class_aura_application.html#a5e3618ecbc81ed6d23dec9db84729126">_needClientUpdate</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="../../d6/d1a/class_world_packet.html">WorldPacket</a> <a class="code" href="../../df/dea/structdata.html">data</a>(<a class="code" href="../../d2/dec/group__u2w.html#gga1073b6abb3a749f18bf1633020879e9ba415333289b810185d3b617c43fdf5f4c">SMSG_AURA_UPDATE</a>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="../../df/dea/structdata.html">data</a> &lt;&lt; <a class="code" href="../../d8/da3/class_aura_application.html#a48f6d82daf06f6f2ced98484c2b56248">GetTarget</a>()-&gt;<a class="code" href="../../d8/d83/class_object.html#ad4b3f372b6700cd50e1eb7ef238cf3be">GetPackGUID</a>();</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="../../d8/da3/class_aura_application.html#a4af52f837bff39572c28eea21ccb6b80">BuildUpdatePacket</a>(<a class="code" href="../../df/dea/structdata.html">data</a>, remove);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/da3/class_aura_application.html#ab216ef41e9d7370cb5fcfce7d42f84cc">GetSlot</a>() &lt; <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a4c7deb1171a45d3528d20c5534828707">MAX_AURAS</a>)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="../../d8/d53/class_player.html">Player</a>* plr = <a class="code" href="../../d8/da3/class_aura_application.html#a48f6d82daf06f6f2ced98484c2b56248">GetTarget</a>()-&gt;ToPlayer())</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html">Aura</a>* aura = <a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>())</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                <span class="keywordflow">if</span> (plr-&gt;NeedSendSpectatorData() &amp;&amp; <a class="code" href="../../da/d60/namespace_arena_spectator.html#a29f78349223aca49d417c3f818b2dd4c">ArenaSpectator::ShouldSendAura</a>(aura, <a class="code" href="../../d8/da3/class_aura_application.html#a5f37e8e4c660272fa2e73721604b7e97">GetEffectMask</a>(), <a class="code" href="../../d8/da3/class_aura_application.html#a48f6d82daf06f6f2ced98484c2b56248">GetTarget</a>()-&gt;GetGUID(), remove))</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                    <a class="code" href="../../da/d60/namespace_arena_spectator.html#a918c7c3c9fd7d26b7a78f2e6d13e1e27">ArenaSpectator::SendCommand_Aura</a>(plr-&gt;FindMap(), plr-&gt;GetGUID(), <span class="stringliteral">&quot;AUR&quot;</span>, aura-&gt;GetCasterGUID(), aura-&gt;GetSpellInfo()-&gt;Id, aura-&gt;GetSpellInfo()-&gt;IsPositive(), aura-&gt;GetSpellInfo()-&gt;Dispel, aura-&gt;GetDuration(), aura-&gt;GetMaxDuration(), (aura-&gt;GetCharges() &gt; 1 ? aura-&gt;GetCharges() : aura-&gt;GetStackAmount()), remove);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="../../d8/da3/class_aura_application.html#af9dc1969efa6eb3dbab368a3f09e0f9c">_target</a>-&gt;<a class="code" href="../../db/df7/class_world_object.html#a244693d75c766f83ce5cba27ed08a064">SendMessageToSet</a>(&amp;<a class="code" href="../../df/dea/structdata.html">data</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#aca22c44b0c3179824f9951b0b3ce206c">  293</a></span>&#160;<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> <a class="code" href="../../d2/dde/class_aura.html#aca22c44b0c3179824f9951b0b3ce206c">Aura::BuildEffectMaskForOwner</a>(<a class="code" href="../../d4/d7d/class_spell_info.html">SpellInfo</a> <span class="keyword">const</span>* spellProto, <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> avalibleEffectMask, <a class="code" href="../../db/df7/class_world_object.html">WorldObject</a>* owner)</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;{</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(spellProto);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(owner);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> effMask = 0;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">switch</span> (owner-&gt;<a class="code" href="../../d8/d83/class_object.html#a621a345fc34deed6d3a4e1e498a652da">GetTypeId</a>())</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a>:</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>:</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                <span class="keywordflow">if</span> (spellProto-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#aa5bb0d7d6df03526d011d9cbfa3734e0">Effects</a>[i].IsUnitOwnedAuraEffect())</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    effMask |= 1 &lt;&lt; i;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2a86e2d54e816ea646c9cda372df01dc68">TYPEID_DYNAMICOBJECT</a>:</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                <span class="keywordflow">if</span> (spellProto-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#aa5bb0d7d6df03526d011d9cbfa3734e0">Effects</a>[i].Effect == <a class="code" href="../../df/d0b/_shared_defines_8h.html#a292c893150c454dd75628b719db1fe97aa3290e738b6cd09859039989143f9ac1">SPELL_EFFECT_PERSISTENT_AREA_AURA</a>)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    effMask |= 1 &lt;&lt; i;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">return</span> effMask &amp; avalibleEffectMask;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a9637e205c147457e50b47efe0f8f7904">  321</a></span>&#160;<a class="code" href="../../d2/dde/class_aura.html">Aura</a>* <a class="code" href="../../d2/dde/class_aura.html#a9637e205c147457e50b47efe0f8f7904">Aura::TryRefreshStackOrCreate</a>(<a class="code" href="../../d4/d7d/class_spell_info.html">SpellInfo</a> <span class="keyword">const</span>* spellproto, <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> tryEffMask, <a class="code" href="../../db/df7/class_world_object.html">WorldObject</a>* owner, <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster, <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>* baseAmount <span class="comment">/*= nullptr*/</span>, <a class="code" href="../../dc/d32/class_item.html">Item</a>* castItem <span class="comment">/*= nullptr*/</span>, <a class="code" href="../../d8/d03/class_object_guid.html">ObjectGuid</a> casterGUID <span class="comment">/*= ObjectGuid::Empty*/</span>, <span class="keywordtype">bool</span>* refresh <span class="comment">/*= nullptr*/</span>, <span class="keywordtype">bool</span> periodicReset <span class="comment">/*= false*/</span>)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;{</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(spellproto);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(owner);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(caster || casterGUID);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(tryEffMask &lt;= <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#a3ac65d8635b4379f0d5b75a0e2dfd9c8">MAX_EFFECT_MASK</a>);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">if</span> (refresh)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        *refresh = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> effMask = <a class="code" href="../../d2/dde/class_aura.html#aca22c44b0c3179824f9951b0b3ce206c">Aura::BuildEffectMaskForOwner</a>(spellproto, tryEffMask, owner);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">if</span> (!effMask)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html">Aura</a>* foundAura = owner-&gt;<a class="code" href="../../d8/d83/class_object.html#ac7d5ffa5c25d3951457c9b0a3c90ce76">ToUnit</a>()-&gt;<a class="code" href="../../da/db7/class_unit.html#a9f63d861cbd0113802b941275e90208c">_TryStackingOrRefreshingExistingAura</a>(spellproto, effMask, caster, baseAmount, castItem, casterGUID, periodicReset))</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="comment">// we&#39;ve here aura, which script triggered removal after modding stack amount</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="comment">// check the state here, so we won&#39;t create new Aura object</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordflow">if</span> (foundAura-&gt;IsRemoved())</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordflow">if</span> (refresh)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            *refresh = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">return</span> foundAura;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d2/dde/class_aura.html#ae44dc9394657b8fbc90bec95911cac03">Create</a>(spellproto, effMask, owner, caster, baseAmount, castItem, casterGUID);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;}</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a3bbcbc2c658a2d959b20837e1e2c31b7">  347</a></span>&#160;<a class="code" href="../../d2/dde/class_aura.html">Aura</a>* <a class="code" href="../../d2/dde/class_aura.html#a3bbcbc2c658a2d959b20837e1e2c31b7">Aura::TryCreate</a>(<a class="code" href="../../d4/d7d/class_spell_info.html">SpellInfo</a> <span class="keyword">const</span>* spellproto, <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> tryEffMask, <a class="code" href="../../db/df7/class_world_object.html">WorldObject</a>* owner, <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster, <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>* baseAmount <span class="comment">/*= nullptr*/</span>, <a class="code" href="../../dc/d32/class_item.html">Item</a>* castItem <span class="comment">/*= nullptr*/</span>, <a class="code" href="../../d8/d03/class_object_guid.html">ObjectGuid</a> casterGUID <span class="comment">/*= ObjectGuid::Empty*/</span>, <a class="code" href="../../d8/d03/class_object_guid.html">ObjectGuid</a> itemGUID <span class="comment">/*= ObjectGuid::Empty*/</span>)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;{</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(spellproto);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(owner);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(caster || casterGUID);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(tryEffMask &lt;= <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#a3ac65d8635b4379f0d5b75a0e2dfd9c8">MAX_EFFECT_MASK</a>);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> effMask = <a class="code" href="../../d2/dde/class_aura.html#aca22c44b0c3179824f9951b0b3ce206c">Aura::BuildEffectMaskForOwner</a>(spellproto, tryEffMask, owner);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">if</span> (!effMask)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/dde/class_aura.html#ae44dc9394657b8fbc90bec95911cac03">Create</a>(spellproto, effMask, owner, caster, baseAmount, castItem, casterGUID, itemGUID);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#ae44dc9394657b8fbc90bec95911cac03">  359</a></span>&#160;<a class="code" href="../../d2/dde/class_aura.html">Aura</a>* <a class="code" href="../../d2/dde/class_aura.html#ae44dc9394657b8fbc90bec95911cac03">Aura::Create</a>(<a class="code" href="../../d4/d7d/class_spell_info.html">SpellInfo</a> <span class="keyword">const</span>* spellproto, <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> effMask, <a class="code" href="../../db/df7/class_world_object.html">WorldObject</a>* owner, <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster, <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>* baseAmount, <a class="code" href="../../dc/d32/class_item.html">Item</a>* castItem, <a class="code" href="../../d8/d03/class_object_guid.html">ObjectGuid</a> casterGUID, <a class="code" href="../../d8/d03/class_object_guid.html">ObjectGuid</a> itemGUID <span class="comment">/*= ObjectGuid::Empty*/</span>)</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;{</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(effMask);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(spellproto);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(owner);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(caster || casterGUID);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(effMask &lt;= <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#a3ac65d8635b4379f0d5b75a0e2dfd9c8">MAX_EFFECT_MASK</a>);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">// try to get caster of aura</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">if</span> (casterGUID)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">if</span> (owner-&gt;<a class="code" href="../../d8/d83/class_object.html#ad23b997e2442fa6a6228ba73a7ecc138">GetGUID</a>() == casterGUID)</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            caster = owner-&gt;<a class="code" href="../../d8/d83/class_object.html#ac7d5ffa5c25d3951457c9b0a3c90ce76">ToUnit</a>();</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            caster = <a class="code" href="../../d4/d27/namespace_object_accessor.html#a02c2dfb59db7d7e2501dcc9a4f9baf07">ObjectAccessor::GetUnit</a>(*owner, casterGUID);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        casterGUID = caster-&gt;<a class="code" href="../../d8/d83/class_object.html#ad23b997e2442fa6a6228ba73a7ecc138">GetGUID</a>();</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">// check if aura can be owned by owner</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span> (owner-&gt;<a class="code" href="../../d8/d83/class_object.html#a7253dbcbed15f5f1190c5cc56d141610">isType</a>(<a class="code" href="../../d9/d83/_object_guid_8h.html#acfe503ba26d8a881f16958aaafd431e1a611a6f19a7f885d824ea5be71ffca2de">TYPEMASK_UNIT</a>))</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordflow">if</span> (!owner-&gt;<a class="code" href="../../d8/d83/class_object.html#a3aeab7def818ba6c50249f197ad2f9ca">IsInWorld</a>() || ((<a class="code" href="../../da/db7/class_unit.html">Unit</a>*)owner)-&gt;IsDuringRemoveFromWorld())</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="comment">// owner not in world so don&#39;t allow to own not self casted single target auras</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <span class="keywordflow">if</span> (casterGUID != owner-&gt;<a class="code" href="../../d8/d83/class_object.html#ad23b997e2442fa6a6228ba73a7ecc138">GetGUID</a>() &amp;&amp; spellproto-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#afc8742bc858cb12197c005168931cb2d">IsSingleTarget</a>())</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html">Aura</a>* aura = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">switch</span> (owner-&gt;<a class="code" href="../../d8/d83/class_object.html#a621a345fc34deed6d3a4e1e498a652da">GetTypeId</a>())</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a>:</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>:</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            aura = <span class="keyword">new</span> <a class="code" href="../../d1/dde/class_unit_aura.html">UnitAura</a>(spellproto, effMask, owner, caster, baseAmount, castItem, casterGUID, itemGUID);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2a86e2d54e816ea646c9cda372df01dc68">TYPEID_DYNAMICOBJECT</a>:</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            aura = <span class="keyword">new</span> <a class="code" href="../../d7/d48/class_dyn_obj_aura.html">DynObjAura</a>(spellproto, effMask, owner, caster, baseAmount, castItem, casterGUID, itemGUID);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <a class="code" href="../../db/d16/_errors_8h.html#a5376571bbf4cdc9782683635f366f89a">ABORT</a>();</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">// aura can be removed in Unit::_AddAura call</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">if</span> (aura-&gt;<a class="code" href="../../d2/dde/class_aura.html#a462457cadd52ba8a0edd5609c71ebbc0">IsRemoved</a>())</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">return</span> aura;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#aca7aa7ab17d4d24ddcef476c6c0c08b6">  404</a></span>&#160;<a class="code" href="../../d2/dde/class_aura.html#aca7aa7ab17d4d24ddcef476c6c0c08b6">Aura::Aura</a>(<a class="code" href="../../d4/d7d/class_spell_info.html">SpellInfo</a> <span class="keyword">const</span>* spellproto, <a class="code" href="../../db/df7/class_world_object.html">WorldObject</a>* owner, <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster, <a class="code" href="../../dc/d32/class_item.html">Item</a>* castItem, <a class="code" href="../../d8/d03/class_object_guid.html">ObjectGuid</a> casterGUID, <a class="code" href="../../d8/d03/class_object_guid.html">ObjectGuid</a> itemGUID <span class="comment">/*= ObjectGuid::Empty*/</span>) :</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    m_spellInfo(spellproto), m_casterGuid(casterGUID ? casterGUID : caster-&gt;GetGUID()),</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    m_castItemGuid(itemGUID ? itemGUID : castItem ? castItem-&gt;GetGUID() : <a class="code" href="../../d8/d03/class_object_guid.html">ObjectGuid</a>::Empty), m_castItemEntry(castItem ? castItem-&gt;GetEntry() : 0), m_applyTime(time(nullptr)),</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    m_owner(owner), m_timeCla(0), m_updateTargetMapInterval(0),</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    m_casterLevel(caster ? caster-&gt;getLevel() : m_spellInfo-&gt;SpellLevel), m_procCharges(0), m_stackAmount(1),</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    m_isRemoved(<a class="code" href="../../db/def/_c99_2stdbool_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>), m_isSingleTarget(<a class="code" href="../../db/def/_c99_2stdbool_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>), m_isUsingCharges(<a class="code" href="../../db/def/_c99_2stdbool_8h.html#a65e9886d74aaee76545e83dd09011727">false</a>), m_triggeredByAuraSpellInfo(nullptr)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;{</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a8fff47546b8052ac55963dd40e4ae394">ManaPerSecond</a> || <a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a40cefe82961ab58e8070546b2d1a1fc5">ManaPerSecondPerLevel</a>) &amp;&amp; !<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a975746d6b737abb063ea037327abfc5a">HasAttribute</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#a583cc1b9a8909370e4d51a890d897668a546d420c10fbdd64888c71cf01c821ec">SPELL_ATTR2_NO_TARGET_PER_SECOND_COST</a>))</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <a class="code" href="../../d2/dde/class_aura.html#a7af03c4091eed4aab81dd2d0613b4eca">m_timeCla</a> = 1 * <a class="code" href="../../d1/d8b/src_2common_2common_8h.html#a84190f79c8167211609f67284e066c58">IN_MILLISECONDS</a>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a24ab9b1f0a73ca4da9aa77e9ee0e3a55">m_maxDuration</a> = <a class="code" href="../../d2/dde/class_aura.html#a97f212bb7332fdf03fccafe5389c1e0a">CalcMaxDuration</a>(caster);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a406738b04948572a30626082ebe7a0e0">m_duration</a> = <a class="code" href="../../d2/dde/class_aura.html#a24ab9b1f0a73ca4da9aa77e9ee0e3a55">m_maxDuration</a>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#af32b9da81a73be723f660ae4e3363e74">m_procCharges</a> = <a class="code" href="../../d2/dde/class_aura.html#ad786924c8b4617ff4724065b6452b04f">CalcMaxCharges</a>(caster);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#ad8811634ba5d82b9581e94e8a0fd6097">m_isUsingCharges</a> = <a class="code" href="../../d2/dde/class_aura.html#af32b9da81a73be723f660ae4e3363e74">m_procCharges</a> != 0;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="../../d6/dda/m__string_8h.html#af1756e67d46227b3333bc21a1fadd361">memset</a>(<a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>));</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">// m_casterLevel = cast item level/caster level, caster level should be saved to db, confirmed with sniffs</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;}</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#ab048dcde17f19db0f48464f9cdea182b">  422</a></span>&#160;<a class="code" href="../../d4/d72/class_aura_script.html">AuraScript</a>* <a class="code" href="../../d2/dde/class_aura.html#ab048dcde17f19db0f48464f9cdea182b">Aura::GetScriptByName</a>(std::string <span class="keyword">const</span>&amp; scriptName)<span class="keyword"> const</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::const_iterator itr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); itr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++itr)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keywordflow">if</span> ((*itr)-&gt;_GetScriptName()-&gt;compare(scriptName) == 0)</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="keywordflow">return</span> *itr;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;}</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#ab477124f94af36e9be706451dce791f7">  430</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#ab477124f94af36e9be706451dce791f7">Aura::_InitEffects</a>(<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> effMask, <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster, <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>* baseAmount)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;{</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">// shouldn&#39;t be in constructor - functions in AuraEffect::AuraEffect use polymorphism</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordflow">if</span> (effMask &amp; (<a class="code" href="../../df/de2/namespace_g3_d.html#aef6949de035da2287649c9db11ec3ba4">uint8</a>(1) &lt;&lt; i))</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i] = <span class="keyword">new</span> <a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>(<span class="keyword">this</span>, i, baseAmount ? baseAmount + i : <span class="keyword">nullptr</span>, caster);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;}</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#ac7a35591f5b0d0429cf706984dbe4316">  442</a></span>&#160;<a class="code" href="../../d2/dde/class_aura.html#ac7a35591f5b0d0429cf706984dbe4316">Aura::~Aura</a>()</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;{</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">// unload scripts</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">while</span> (!<a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.empty())</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        std::list&lt;AuraScript*&gt;::iterator itr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin();</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        (*itr)-&gt;_Unload();</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keyword">delete</span> (*itr);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.erase(itr);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="comment">// free effects memory</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keyword">delete</span> <a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i];</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(<a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>.empty());</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#accc852560f7b56d60c77581365a3b17f">_DeleteRemovedApplications</a>();</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;}</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">  461</a></span>&#160;<a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">Aura::GetId</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a49bc14059c2bd3785231c52e0d54d382">Id</a>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;}</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a6fc52109b7711606f15d9880fda8f815">  466</a></span>&#160;<a class="code" href="../../da/db7/class_unit.html">Unit</a>* <a class="code" href="../../d2/dde/class_aura.html#a6fc52109b7711606f15d9880fda8f815">Aura::GetCaster</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>()-&gt;GetGUID() == <a class="code" href="../../d2/dde/class_aura.html#a3c4dfe75dad16fbf2afaf23ce77e4262">GetCasterGUID</a>())</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>();</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a> <span class="keyword">const</span>* aurApp = <a class="code" href="../../d2/dde/class_aura.html#a9fb02e4e6e4b16378e89d2126cc291e7">GetApplicationOfTarget</a>(<a class="code" href="../../d2/dde/class_aura.html#a3c4dfe75dad16fbf2afaf23ce77e4262">GetCasterGUID</a>()))</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">return</span> aurApp-&gt;GetTarget();</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d4/d27/namespace_object_accessor.html#a02c2dfb59db7d7e2501dcc9a4f9baf07">ObjectAccessor::GetUnit</a>(*<a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>(), <a class="code" href="../../d2/dde/class_aura.html#a3c4dfe75dad16fbf2afaf23ce77e4262">GetCasterGUID</a>());</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;}</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#aaddb94cd3bd95b145a8b8392e9feecca">  476</a></span>&#160;<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#ade4e7c2cbd17c45015f9f70c2a5400b2">AuraObjectType</a> <a class="code" href="../../d2/dde/class_aura.html#aaddb94cd3bd95b145a8b8392e9feecca">Aura::GetType</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d2/dde/class_aura.html#ab415594d025a57ab429a85ab70e598cb">m_owner</a>)</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <a class="code" href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a43832e3fa8508deb4ce43e520005fcd9">LOG_ERROR</a>(<span class="stringliteral">&quot;spells&quot;</span>, <span class="stringliteral">&quot;Aura::GetType m_owner is null!&quot;</span>);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#ade4e7c2cbd17c45015f9f70c2a5400b2a9db32fb1dd13d77afd835d5bb6f5d379">UNIT_AURA_TYPE</a>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="../../d2/dde/class_aura.html#ab415594d025a57ab429a85ab70e598cb">m_owner</a>-&gt;<a class="code" href="../../d8/d83/class_object.html#a621a345fc34deed6d3a4e1e498a652da">GetTypeId</a>() == <a class="code" href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2a86e2d54e816ea646c9cda372df01dc68">TYPEID_DYNAMICOBJECT</a>) ? <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#ade4e7c2cbd17c45015f9f70c2a5400b2a51cd79314936d46d8bc738a8c1207ab4">DYNOBJ_AURA_TYPE</a> : <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#ade4e7c2cbd17c45015f9f70c2a5400b2a9db32fb1dd13d77afd835d5bb6f5d379">UNIT_AURA_TYPE</a>;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;}</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#ad1c2269615a73318dc9438801d1ee087">  487</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#ad1c2269615a73318dc9438801d1ee087">Aura::_ApplyForTarget</a>(<a class="code" href="../../da/db7/class_unit.html">Unit</a>* target, <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster, <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a>* auraApp)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;{</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(target);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(auraApp);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">// aura mustn&#39;t be already applied on target</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a> (!<a class="code" href="../../d2/dde/class_aura.html#a5860e9094ea1ef6525b77c1957879486">IsAppliedOnTarget</a>(target-&gt;<a class="code" href="../../d8/d83/class_object.html#ad23b997e2442fa6a6228ba73a7ecc138">GetGUID</a>()) &amp;&amp; <span class="stringliteral">&quot;Aura::_ApplyForTarget: aura musn&#39;t be already applied on target&quot;</span>);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>[target-&gt;<a class="code" href="../../d8/d83/class_object.html#ad23b997e2442fa6a6228ba73a7ecc138">GetGUID</a>()] = auraApp;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">// set infinity cooldown state for spells</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">if</span> (caster &amp;&amp; caster-&gt;<a class="code" href="../../d8/d83/class_object.html#a621a345fc34deed6d3a4e1e498a652da">GetTypeId</a>() == <a class="code" href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a43566c3ed76d2e2a9eb6830061c772bd">IsCooldownStartedOnEvent</a>() &amp;&amp; !<a class="code" href="../../d2/dde/class_aura.html#a742caadbfa7658d6957bf73eda7c624a">m_castItemGuid</a>)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            caster-&gt;<a class="code" href="../../d8/d83/class_object.html#ae635434021784608b659501867538c87">ToPlayer</a>()-&gt;<a class="code" href="../../d8/d53/class_player.html#a7d8edd7357f54d719fbe47e021b9997e">AddSpellAndCategoryCooldowns</a>(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>, 0, <span class="keyword">nullptr</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        }</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;}</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a068cc46b636b35d317aea47a2de6253e">  506</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a068cc46b636b35d317aea47a2de6253e">Aura::_UnapplyForTarget</a>(<a class="code" href="../../da/db7/class_unit.html">Unit</a>* target, <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster, <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a>* auraApp)</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;{</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(target);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(auraApp-&gt;<a class="code" href="../../d8/da3/class_aura_application.html#ae6b921446fc7901f8f053e19c3fb3f4c">GetRemoveMode</a>());</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(auraApp);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    ApplicationMap::iterator itr = <a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>.find(target-&gt;<a class="code" href="../../d8/d83/class_object.html#ad23b997e2442fa6a6228ba73a7ecc138">GetGUID</a>());</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">// TODO: Figure out why this happens</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">if</span> (itr == <a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>.end())</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <a class="code" href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a43832e3fa8508deb4ce43e520005fcd9">LOG_ERROR</a>(<span class="stringliteral">&quot;spells.aura&quot;</span>, <span class="stringliteral">&quot;Aura::_UnapplyForTarget, target:%s, caster:%s, spell:%u was not found in owners application map!&quot;</span>,</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                       target-&gt;<a class="code" href="../../d8/d83/class_object.html#ad23b997e2442fa6a6228ba73a7ecc138">GetGUID</a>().<a class="code" href="../../d8/d03/class_object_guid.html#a78f5fb47e3b35addf8984000c175125b">ToString</a>().c_str(), caster ? caster-&gt;<a class="code" href="../../d8/d83/class_object.html#ad23b997e2442fa6a6228ba73a7ecc138">GetGUID</a>().<a class="code" href="../../d8/d03/class_object_guid.html#a78f5fb47e3b35addf8984000c175125b">ToString</a>().c_str() : <span class="stringliteral">&quot;&quot;</span>, auraApp-&gt;<a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>()-&gt;<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a49bc14059c2bd3785231c52e0d54d382">Id</a>);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <a class="code" href="../../db/d16/_errors_8h.html#a5376571bbf4cdc9782683635f366f89a">ABORT</a>();</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">// aura has to be already applied</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(itr-&gt;second == auraApp);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>.erase(itr);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a04a25715c9b268afa2025a47681df76c">m_removedApplications</a>.push_back(auraApp);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">// reset cooldown state for spells</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">if</span> (caster &amp;&amp; caster-&gt;<a class="code" href="../../d8/d83/class_object.html#a621a345fc34deed6d3a4e1e498a652da">GetTypeId</a>() == <a class="code" href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;IsCooldownStartedOnEvent() &amp;&amp; !<a class="code" href="../../d2/dde/class_aura.html#a742caadbfa7658d6957bf73eda7c624a">m_castItemGuid</a>)</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="comment">// note: item based cooldowns and cooldown spell mods with charges ignored (unknown existed cases)</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            caster-&gt;<a class="code" href="../../d8/d83/class_object.html#ae635434021784608b659501867538c87">ToPlayer</a>()-&gt;<a class="code" href="../../d8/d53/class_player.html#af30525fcf507cfc5f665e70eb6181318">SendCooldownEvent</a>(<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>());</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;}</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">// removes aura from all targets</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">// and marks aura as removed</span></div>
<div class="line"><a name="l00541"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#afb6874ab08b221b2f1f9d7582c1c93be">  541</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#afb6874ab08b221b2f1f9d7582c1c93be">Aura::_Remove</a>(<a class="code" href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94">AuraRemoveMode</a> removeMode)</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;{</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a> (!<a class="code" href="../../d2/dde/class_aura.html#ae63436802a402d26115d21f4a2073e1a">m_isRemoved</a>);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#ae63436802a402d26115d21f4a2073e1a">m_isRemoved</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    ApplicationMap::iterator appItr = <a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>.begin();</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordflow">for</span> (appItr = <a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>.begin(); appItr != <a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>.end();)</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a>* aurApp = appItr-&gt;second;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <a class="code" href="../../da/db7/class_unit.html">Unit</a>* target = aurApp-&gt;<a class="code" href="../../d8/da3/class_aura_application.html#a48f6d82daf06f6f2ced98484c2b56248">GetTarget</a>();</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        target-&gt;<a class="code" href="../../da/db7/class_unit.html#a2681906ad625eb9effbe367c7f53a930">_UnapplyAura</a>(aurApp, removeMode);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        appItr = <a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>.begin();</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;}</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a8b5668b0179cec254f21a0b6bdf83974">  555</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a8b5668b0179cec254f21a0b6bdf83974">Aura::UpdateTargetMap</a>(<a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster, <span class="keywordtype">bool</span> <a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a>)</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;{</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a462457cadd52ba8a0edd5609c71ebbc0">IsRemoved</a>())</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#aeb7fadeb3b25c9d5a2903e5c1ea06ff2">m_updateTargetMapInterval</a> = <a class="code" href="../../d7/db3/_spell_auras_8cpp.html#a49c1eff45f8eb67e523f8593923a5df0">UPDATE_TARGET_MAP_INTERVAL</a>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">// fill up to date target list</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">//       target, effMask</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    std::map&lt;Unit*, uint8&gt; targets;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a304404f284fba0b6d8dc046140e309ae">FillTargetMap</a>(targets, caster);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <a class="code" href="../../d5/d32/_unit_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a> targetsToRemove;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">// mark all auras as ready to remove</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">for</span> (ApplicationMap::iterator appIter = <a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>.begin(); appIter != <a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>.end(); ++appIter)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        std::map&lt;Unit*, uint8&gt;::iterator existing = targets.find(appIter-&gt;second-&gt;GetTarget());</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="comment">// not found in current area - remove the aura</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keywordflow">if</span> (existing == targets.end())</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            targetsToRemove.push_back(appIter-&gt;second-&gt;GetTarget());</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="comment">// xinef: check immunities here, so aura wont get removed on every tick and then reapplied</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a13f14942fd6394df8e5d8ae820fd3fc7">IsArea</a>())</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> effIndex = 0; effIndex &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++effIndex)</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                {</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                    <span class="keywordflow">if</span> ((existing-&gt;second &amp; (1 &lt;&lt; effIndex)) &amp;&amp; existing-&gt;first-&gt;IsImmunedToSpellEffect(<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>(), effIndex))</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                        existing-&gt;second &amp;= ~(1 &lt;&lt; effIndex);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="comment">// needs readding - remove now, will be applied in next update cycle</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <span class="comment">// (dbcs do not have auras which apply on same type of targets but have different radius, so this is not really needed)</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            <span class="keywordflow">if</span> (appIter-&gt;second-&gt;GetEffectMask() != existing-&gt;second || !<a class="code" href="../../d2/dde/class_aura.html#ac2ee53cb584c3528f2990d391393bc1d">CanBeAppliedOn</a>(existing-&gt;first))</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                targetsToRemove.push_back(appIter-&gt;second-&gt;GetTarget());</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="comment">// nothing todo - aura already applied</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            <span class="comment">// remove from auras to register list</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            targets.erase(existing);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="comment">// register auras for units</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordflow">for</span> (std::map&lt;Unit*, uint8&gt;::iterator itr = targets.begin(); itr != targets.end();)</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="comment">// aura mustn&#39;t be already applied on target</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a>* aurApp = <a class="code" href="../../d2/dde/class_aura.html#a9fb02e4e6e4b16378e89d2126cc291e7">GetApplicationOfTarget</a>(itr-&gt;first-&gt;GetGUID()))</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="comment">// the core created 2 different units with same guid</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <span class="comment">// this is a major failue, which i can&#39;t fix right now</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="comment">// let&#39;s remove one unit from aura list</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <span class="comment">// this may cause area aura &quot;bouncing&quot; between 2 units after each update</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="comment">// but because we know the reason of a crash we can remove the assertion for now</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <span class="keywordflow">if</span> (aurApp-&gt;GetTarget() != itr-&gt;first)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                <span class="comment">// remove from auras to register list</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                targets.erase(itr++);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            }</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            {</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                <span class="comment">// ok, we have one unit twice in target map (impossible, but...)</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                <a class="code" href="../../db/d16/_errors_8h.html#a5376571bbf4cdc9782683635f366f89a">ABORT</a>();</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordtype">bool</span> addUnit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="comment">// check target immunities</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> effIndex = 0; effIndex &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++effIndex)</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            <span class="keywordflow">if</span> ((itr-&gt;second &amp; (1 &lt;&lt; effIndex)) &amp;&amp; itr-&gt;first-&gt;IsImmunedToSpellEffect(<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>(), effIndex))</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                itr-&gt;second &amp;= ~(1 &lt;&lt; effIndex);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="keywordflow">if</span> (!itr-&gt;second</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                || itr-&gt;first-&gt;IsImmunedToSpell(<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>())</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                || !<a class="code" href="../../d2/dde/class_aura.html#ac2ee53cb584c3528f2990d391393bc1d">CanBeAppliedOn</a>(itr-&gt;first))</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            addUnit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="keywordflow">if</span> (addUnit)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="comment">// persistent area aura does not hit flying targets</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#aaddb94cd3bd95b145a8b8392e9feecca">GetType</a>() == <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#ade4e7c2cbd17c45015f9f70c2a5400b2a51cd79314936d46d8bc738a8c1207ab4">DYNOBJ_AURA_TYPE</a>)</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                <span class="keywordflow">if</span> (itr-&gt;first-&gt;IsInFlight())</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                    addUnit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                <span class="keywordflow">switch</span>( <a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>() )</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                    <span class="keywordflow">case</span> 62821: <span class="comment">// Ulduar, Hodir, Toasty Fire</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                    <span class="keywordflow">case</span> 62807: <span class="comment">// Ulduar, Hodir, Starlight</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                    <span class="keywordflow">case</span> 51103: <span class="comment">// Oculus, Mage-Lord Urom, Frostbomb</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                    <span class="keywordflow">case</span> 69146:</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    <span class="keywordflow">case</span> 70823:</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                    <span class="keywordflow">case</span> 70824:</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                    <span class="keywordflow">case</span> 70825: <span class="comment">// Icecrown Citadel, Lord Marrowgar, Coldflame</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                        {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                            <span class="keywordflow">if</span>( itr-&gt;first-&gt;HasAura(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>()) )</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                addUnit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                        }</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <span class="comment">// unit auras can not stack with each other</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            <span class="keywordflow">else</span> <span class="comment">// (GetType() == UNIT_AURA_TYPE)</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                <span class="comment">// Allow to remove by stack when aura is going to be applied on owner</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                <span class="keywordflow">if</span> (itr-&gt;first != <a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>())</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                    <span class="comment">// check if not stacking aura already on target</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                    <span class="comment">// this one prevents unwanted usefull buff loss because of stacking and prevents overriding auras periodicaly by 2 near area aura owners</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                    <span class="keywordflow">for</span> (Unit::AuraApplicationMap::iterator iter = itr-&gt;first-&gt;GetAppliedAuras().begin(); iter != itr-&gt;first-&gt;GetAppliedAuras().end(); ++iter)</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                    {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                        <a class="code" href="../../d2/dde/class_aura.html">Aura</a> <span class="keyword">const</span>* aura = iter-&gt;second-&gt;GetBase();</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                        <span class="keywordflow">if</span> (!<a class="code" href="../../d2/dde/class_aura.html#a40cd6707c45eead445b1f487991da9c1">CanStackWith</a>(aura, <span class="keyword">false</span>))</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                        {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                            addUnit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                        }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                    }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="keywordflow">if</span> (!addUnit)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            targets.erase(itr++);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            <span class="comment">// owner has to be in world, or effect has to be applied to self</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>()-&gt;<a class="code" href="../../db/df7/class_world_object.html#af150fb9ed281044f6dbaff6cb68522bc">IsSelfOrInSameMap</a>(itr-&gt;first))</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                <span class="comment">//TODO: There is a crash caused by shadowfiend load addon</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                <a class="code" href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a0e09b50c268dc6897a1c70aa46de936e">LOG_FATAL</a>(<span class="stringliteral">&quot;spells.aura&quot;</span>, <span class="stringliteral">&quot;Aura %u: Owner %s (map %u) is not in the same map as target %s (map %u).&quot;</span>, <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;Id,</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                               <a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>()-&gt;<a class="code" href="../../df/d1b/namespace_account_mgr.html#af911e3860ec519c541d6df35468ee41b">GetName</a>().c_str(), <a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>()-&gt;IsInWorld() ? <a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>()-&gt;GetMap()-&gt;<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>() : <a class="code" href="../../df/de2/namespace_g3_d.html#ae911b90657d7162d47997c702af655a8">uint32</a>(-1),</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                               itr-&gt;first-&gt;GetName().c_str(), itr-&gt;first-&gt;IsInWorld() ? itr-&gt;first-&gt;GetMap()-&gt;GetId() : <a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(-1));</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                <a class="code" href="../../db/d16/_errors_8h.html#a5376571bbf4cdc9782683635f366f89a">ABORT</a>();</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            itr-&gt;first-&gt;_CreateAuraApplication(<span class="keyword">this</span>, itr-&gt;second);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            ++itr;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    }</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="comment">// remove auras from units no longer needing them</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">for</span> (UnitList::iterator itr = targetsToRemove.begin(); itr != targetsToRemove.end(); ++itr)</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a>* aurApp = <a class="code" href="../../d2/dde/class_aura.html#a9fb02e4e6e4b16378e89d2126cc291e7">GetApplicationOfTarget</a>((*itr)-&gt;GetGUID()))</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            (*itr)-&gt;_UnapplyAura(aurApp, <a class="code" href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94a51dd2d6d8e90e4ea4113c02fb772b80c">AURA_REMOVE_BY_DEFAULT</a>);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a>)</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment">// apply aura effects for units</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">for</span> (std::map&lt;Unit*, uint8&gt;::iterator itr = targets.begin(); itr != targets.end(); ++itr)</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a>* aurApp = <a class="code" href="../../d2/dde/class_aura.html#a9fb02e4e6e4b16378e89d2126cc291e7">GetApplicationOfTarget</a>(itr-&gt;first-&gt;GetGUID()))</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <span class="comment">// owner has to be in world, or effect has to be applied to self</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>((!<a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>()-&gt;IsInWorld() &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>() == itr-&gt;first) || <a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>()-&gt;IsInMap(itr-&gt;first));</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            itr-&gt;first-&gt;_ApplyAura(aurApp, itr-&gt;second);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;}</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">// targets have to be registered and not have effect applied yet to use this function</span></div>
<div class="line"><a name="l00716"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#aaf49ca3ee98e09b072985755bcfb2d34">  716</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#aaf49ca3ee98e09b072985755bcfb2d34">Aura::_ApplyEffectForTargets</a>(<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> effIndex)</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;{</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="comment">// prepare list of aura targets</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <a class="code" href="../../d5/d32/_unit_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a> targetList;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="keywordflow">for</span> (ApplicationMap::iterator appIter = <a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>.begin(); appIter != <a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>.end(); ++appIter)</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="keywordflow">if</span> ((appIter-&gt;second-&gt;GetEffectsToApply() &amp; (1 &lt;&lt; effIndex)) &amp;&amp; !appIter-&gt;second-&gt;HasEffect(effIndex))</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            targetList.push_back(appIter-&gt;second-&gt;GetTarget());</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    }</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="comment">// apply effect to targets</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordflow">for</span> (UnitList::iterator itr = targetList.begin(); itr != targetList.end(); ++itr)</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a9fb02e4e6e4b16378e89d2126cc291e7">GetApplicationOfTarget</a>((*itr)-&gt;GetGUID()))</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            <span class="comment">// owner has to be in world, or effect has to be applied to self</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>((!<a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>()-&gt;IsInWorld() &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>() == *itr) || <a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>()-&gt;IsInMap(*itr));</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            (*itr)-&gt;_ApplyAuraEffect(<span class="keyword">this</span>, effIndex);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        }</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;}</div>
<div class="line"><a name="l00737"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a6349dd41e39827b8c55464982801d1b4">  737</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a6349dd41e39827b8c55464982801d1b4">Aura::UpdateOwner</a>(<a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <a class="code" href="../../d9/d39/dtoa_8c.html#a158860430cb5f139d88fdf19cf9ad511">diff</a>, <a class="code" href="../../db/df7/class_world_object.html">WorldObject</a>* owner)</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;{</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordflow">if</span> (owner != <a class="code" href="../../d2/dde/class_aura.html#ab415594d025a57ab429a85ab70e598cb">m_owner</a>)</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <a class="code" href="../../db/d16/_errors_8h.html#a5376571bbf4cdc9782683635f366f89a">ABORT</a>();</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster = <a class="code" href="../../d2/dde/class_aura.html#a6fc52109b7711606f15d9880fda8f815">GetCaster</a>();</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="comment">// Apply spellmods for channeled auras</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="comment">// used for example when triggered spell of spell:10 is modded</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <a class="code" href="../../d8/d0d/class_spell.html">Spell</a>* modSpell = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <a class="code" href="../../d8/d53/class_player.html">Player</a>* modOwner = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">if</span> (caster)</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        modOwner = caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a2e6a98844f96c211f47b911a2766ada8">GetSpellModOwner</a>();</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keywordflow">if</span> (modOwner)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            modSpell = modOwner-&gt;<a class="code" href="../../da/db7/class_unit.html#a2e9a4c70bb5a75e546c63acf5242b6f0">FindCurrentSpellBySpellId</a>(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>());</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="keywordflow">if</span> (modSpell)</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                modOwner-&gt;<a class="code" href="../../d8/d53/class_player.html#a0a8d74504a10a162c77d4a64d652a1b5">SetSpellModTakingSpell</a>(modSpell, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    }</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a4c573f5f8069c14c997c85c08bac3dd4">Update</a>(<a class="code" href="../../d9/d39/dtoa_8c.html#a158860430cb5f139d88fdf19cf9ad511">diff</a>, caster);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#aeb7fadeb3b25c9d5a2903e5c1ea06ff2">m_updateTargetMapInterval</a> &lt;= <a class="code" href="../../df/de2/namespace_g3_d.html#af80d9dbc6fa48c9ff714c7158adb60ae">int32</a>(<a class="code" href="../../d9/d39/dtoa_8c.html#a158860430cb5f139d88fdf19cf9ad511">diff</a>))</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <a class="code" href="../../d2/dde/class_aura.html#a8b5668b0179cec254f21a0b6bdf83974">UpdateTargetMap</a>(caster);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <a class="code" href="../../d2/dde/class_aura.html#aeb7fadeb3b25c9d5a2903e5c1ea06ff2">m_updateTargetMapInterval</a> -= <a class="code" href="../../d9/d39/dtoa_8c.html#a158860430cb5f139d88fdf19cf9ad511">diff</a>;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="comment">// update aura effects</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i])</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            <a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i]-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a1e57c07b017695d76137b0d81074df1e">Update</a>(<a class="code" href="../../d9/d39/dtoa_8c.html#a158860430cb5f139d88fdf19cf9ad511">diff</a>, caster);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="comment">// remove spellmods after effects update</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">if</span> (modSpell)</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        modOwner-&gt;<a class="code" href="../../d8/d53/class_player.html#a0a8d74504a10a162c77d4a64d652a1b5">SetSpellModTakingSpell</a>(modSpell, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#accc852560f7b56d60c77581365a3b17f">_DeleteRemovedApplications</a>();</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;}</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a4c573f5f8069c14c997c85c08bac3dd4">  779</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a4c573f5f8069c14c997c85c08bac3dd4">Aura::Update</a>(<a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <a class="code" href="../../d9/d39/dtoa_8c.html#a158860430cb5f139d88fdf19cf9ad511">diff</a>, <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster)</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;{</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a406738b04948572a30626082ebe7a0e0">m_duration</a> &gt; 0)</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <a class="code" href="../../d2/dde/class_aura.html#a406738b04948572a30626082ebe7a0e0">m_duration</a> -= <a class="code" href="../../d9/d39/dtoa_8c.html#a158860430cb5f139d88fdf19cf9ad511">diff</a>;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a406738b04948572a30626082ebe7a0e0">m_duration</a> &lt; 0)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <a class="code" href="../../d2/dde/class_aura.html#a406738b04948572a30626082ebe7a0e0">m_duration</a> = 0;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="comment">// handle ManaPerSecond/ManaPerSecondPerLevel</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7af03c4091eed4aab81dd2d0613b4eca">m_timeCla</a>)</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7af03c4091eed4aab81dd2d0613b4eca">m_timeCla</a> &gt; <a class="code" href="../../df/de2/namespace_g3_d.html#af80d9dbc6fa48c9ff714c7158adb60ae">int32</a>(<a class="code" href="../../d9/d39/dtoa_8c.html#a158860430cb5f139d88fdf19cf9ad511">diff</a>))</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                <a class="code" href="../../d2/dde/class_aura.html#a7af03c4091eed4aab81dd2d0613b4eca">m_timeCla</a> -= <a class="code" href="../../d9/d39/dtoa_8c.html#a158860430cb5f139d88fdf19cf9ad511">diff</a>;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (caster)</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> ManaPerSecond = <a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a8fff47546b8052ac55963dd40e4ae394">ManaPerSecond</a> + <a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a40cefe82961ab58e8070546b2d1a1fc5">ManaPerSecondPerLevel</a> * caster-&gt;<a class="code" href="../../da/db7/class_unit.html#adc6d98745d565970b4a89088ec5b5a42">getLevel</a>())</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                {</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                    <a class="code" href="../../d2/dde/class_aura.html#a7af03c4091eed4aab81dd2d0613b4eca">m_timeCla</a> += 1000 - <a class="code" href="../../d9/d39/dtoa_8c.html#a158860430cb5f139d88fdf19cf9ad511">diff</a>;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                    <a class="code" href="../../df/d0b/_shared_defines_8h.html#a17e15fab4b89f4840e745f31ca76a414">Powers</a> powertype = <a class="code" href="../../df/d0b/_shared_defines_8h.html#a17e15fab4b89f4840e745f31ca76a414">Powers</a>(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a517ef88a7d9ce773b7906bdd19a88e85">PowerType</a>);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                    <span class="keywordflow">if</span> (powertype == <a class="code" href="../../df/d0b/_shared_defines_8h.html#a17e15fab4b89f4840e745f31ca76a414a46379b081e66f0ab034f94a9f5dbad22">POWER_HEALTH</a>)</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                    {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../df/de2/namespace_g3_d.html#af80d9dbc6fa48c9ff714c7158adb60ae">int32</a>(caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a958172d6051b106e3b3c776e4f9f3952">GetHealth</a>()) &gt; ManaPerSecond)</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                            caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a009a87eeb9cc40ed7017610cbb914b9b">ModifyHealth</a>(-ManaPerSecond);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                        {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                            <a class="code" href="../../d2/dde/class_aura.html#af9799e5670c2bc3899e3430aa793ca20">Remove</a>();</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                        }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                    }</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                    {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../df/de2/namespace_g3_d.html#af80d9dbc6fa48c9ff714c7158adb60ae">int32</a>(caster-&gt;<a class="code" href="../../da/db7/class_unit.html#ad7e475d80b9af430cc076d7c01f967e9">GetPower</a>(powertype)) &gt;= ManaPerSecond)</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                            caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a71c66b7e4d8815d9ea68b838f4ff0f09">ModifyPower</a>(powertype, -ManaPerSecond);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                        {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                            <a class="code" href="../../d2/dde/class_aura.html#af9799e5670c2bc3899e3430aa793ca20">Remove</a>();</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                        }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                    }</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                }</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            }</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        }</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    }</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;}</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a507acdaa5041d3faa9a804e49c29264e">  825</a></span>&#160;<a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> <a class="code" href="../../d2/dde/class_aura.html#a97f212bb7332fdf03fccafe5389c1e0a">Aura::CalcMaxDuration</a>(<a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster)<span class="keyword"> const</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <a class="code" href="../../d8/d53/class_player.html">Player</a>* modOwner = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> maxDuration;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordflow">if</span> (caster)</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        modOwner = caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a2e6a98844f96c211f47b911a2766ada8">GetSpellModOwner</a>();</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        maxDuration = caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a490990b2ec18be95c613e6394e4f3f6a">CalcSpellDuration</a>(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        maxDuration = <a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#aa8de3a55617f9dbe8313e4d66907a0b7">GetDuration</a>();</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#ae24c050668e78ef9d8728e6b5bd77c12">IsPassive</a>() &amp;&amp; !<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a9904a9ebdd084815af5ef6d1653ffbbd">DurationEntry</a>)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        maxDuration = -1;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <a class="code" href="../../d0/d7d/_script_mgr_8h.html#ae8161e629869974bc49b1cbfc73c1087">sScriptMgr</a>-&gt;OnCalcMaxDuration(<span class="keyword">this</span>, maxDuration);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="comment">// IsPermanent() checks max duration (which we are supposed to calculate here)</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">if</span> (maxDuration != -1 &amp;&amp; modOwner)</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        modOwner-&gt;<a class="code" href="../../d8/d53/class_player.html#abe45751f505290dc65dbc0d0fd2e0370">ApplySpellMod</a>(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>(), <a class="code" href="../../d5/d32/_unit_8h.html#a39b60e1f12cca9b6873cb817e7717351abbf47ed0b69b726537ecd64649c0d73c">SPELLMOD_DURATION</a>, maxDuration);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">return</span> maxDuration;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;}</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a99930c42ad9f6e002ffe6de5e5fbe59b">  849</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a99930c42ad9f6e002ffe6de5e5fbe59b">Aura::SetDuration</a>(<a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> duration, <span class="keywordtype">bool</span> withMods)</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;{</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">if</span> (withMods)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster = <a class="code" href="../../d2/dde/class_aura.html#a6fc52109b7711606f15d9880fda8f815">GetCaster</a>())</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d8/d53/class_player.html">Player</a>* modOwner = caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a2e6a98844f96c211f47b911a2766ada8">GetSpellModOwner</a>())</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                modOwner-&gt;ApplySpellMod(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>(), <a class="code" href="../../d5/d32/_unit_8h.html#a39b60e1f12cca9b6873cb817e7717351abbf47ed0b69b726537ecd64649c0d73c">SPELLMOD_DURATION</a>, duration);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a406738b04948572a30626082ebe7a0e0">m_duration</a> = duration;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a8f9f4a57e87c86b384b637403fff06e7">SetNeedClientUpdateForTargets</a>();</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;}</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a2f108f33766c253a827d41c2f3fdc45e">  861</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a2f108f33766c253a827d41c2f3fdc45e">Aura::RefreshDuration</a>(<span class="keywordtype">bool</span> withMods)</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;{</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster = <a class="code" href="../../d2/dde/class_aura.html#a6fc52109b7711606f15d9880fda8f815">GetCaster</a>();</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordflow">if</span> (!caster)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordflow">if</span> (withMods &amp;&amp; caster)</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    {</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> duration = <a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a6cc135f2b87d1fecd6e7db475f9039dd">GetMaxDuration</a>();</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <span class="comment">// Calculate duration of periodics affected by haste.</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a000570a88dd253d3746e6ff5ac1c918b">HasAuraTypeWithAffectMask</a>(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a1191ab2524c100b0d91f8d63cee8e781">SPELL_AURA_PERIODIC_HASTE</a>, <a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>) || <a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a975746d6b737abb063ea037327abfc5a">HasAttribute</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#a376aa62261a98289589839b821786adaa884cc9555b9162ae33956c5ded8cb1d7">SPELL_ATTR5_SPELL_HASTE_AFFECTS_PERIODIC</a>))</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            duration = <a class="code" href="../../df/de2/namespace_g3_d.html#af80d9dbc6fa48c9ff714c7158adb60ae">int32</a>(duration * caster-&gt;<a class="code" href="../../d8/d83/class_object.html#a8797257c31223076c1b76b4b1a6f8007">GetFloatValue</a>(<a class="code" href="../../dd/d65/_update_fields_8h.html#a0e42dc606678c9df7884e1aad621e881a5662db4f743b497fc17de3f73e4e9235">UNIT_MOD_CAST_SPEED</a>));</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <a class="code" href="../../d2/dde/class_aura.html#abf0ff1d6e3be882ce7e8ddd7e935ab66">SetMaxDuration</a>(duration);</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        <a class="code" href="../../d2/dde/class_aura.html#a99930c42ad9f6e002ffe6de5e5fbe59b">SetDuration</a>(duration);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    }</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <a class="code" href="../../d2/dde/class_aura.html#a99930c42ad9f6e002ffe6de5e5fbe59b">SetDuration</a>(<a class="code" href="../../d2/dde/class_aura.html#a14457cfa6d589b8024bbeeb1d4aa03d3">GetMaxDuration</a>());</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a8fff47546b8052ac55963dd40e4ae394">ManaPerSecond</a> || <a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a40cefe82961ab58e8070546b2d1a1fc5">ManaPerSecondPerLevel</a>) &amp;&amp; !<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a975746d6b737abb063ea037327abfc5a">HasAttribute</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#a583cc1b9a8909370e4d51a890d897668a546d420c10fbdd64888c71cf01c821ec">SPELL_ATTR2_NO_TARGET_PER_SECOND_COST</a>))</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <a class="code" href="../../d2/dde/class_aura.html#a7af03c4091eed4aab81dd2d0613b4eca">m_timeCla</a> = 1 * <a class="code" href="../../d1/d8b/src_2common_2common_8h.html#a84190f79c8167211609f67284e066c58">IN_MILLISECONDS</a>;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160; </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="comment">// also reset periodic counters</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* aurEff = <a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i])</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            aurEff-&gt;ResetTicks();</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;}</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a2fa2b27d98d99af4f226c0156d47a628">  890</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a2fa2b27d98d99af4f226c0156d47a628">Aura::RefreshTimers</a>(<span class="keywordtype">bool</span> periodicReset <span class="comment">/*= false*/</span>)</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;{</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a24ab9b1f0a73ca4da9aa77e9ee0e3a55">m_maxDuration</a> = <a class="code" href="../../d2/dde/class_aura.html#a97f212bb7332fdf03fccafe5389c1e0a">CalcMaxDuration</a>();</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a2f108f33766c253a827d41c2f3fdc45e">RefreshDuration</a>();</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster = <a class="code" href="../../d2/dde/class_aura.html#a6fc52109b7711606f15d9880fda8f815">GetCaster</a>();</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160; </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">if</span> (!caster)</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* aurEff = <a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i])</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            aurEff-&gt;CalculatePeriodic(caster, periodicReset, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;}</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a7f7d613279717173c13708425f3a8083">  904</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a7f7d613279717173c13708425f3a8083">Aura::SetCharges</a>(<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> charges)</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;{</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#af32b9da81a73be723f660ae4e3363e74">m_procCharges</a> == charges)</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#af32b9da81a73be723f660ae4e3363e74">m_procCharges</a> = charges;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#ad8811634ba5d82b9581e94e8a0fd6097">m_isUsingCharges</a> = <a class="code" href="../../d2/dde/class_aura.html#af32b9da81a73be723f660ae4e3363e74">m_procCharges</a> != 0;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a8f9f4a57e87c86b384b637403fff06e7">SetNeedClientUpdateForTargets</a>();</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;}</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; </div>
<div class="line"><a name="l00913"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a744d6c3e73a644a84d5f49863c1bca53">  913</a></span>&#160;<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> <a class="code" href="../../d2/dde/class_aura.html#ad786924c8b4617ff4724065b6452b04f">Aura::CalcMaxCharges</a>(<a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster)<span class="keyword"> const</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> maxProcCharges = <a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a4b82e530c085010e7247ae0862301ac9">ProcCharges</a>;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d0/d79/struct_spell_proc_entry.html">SpellProcEntry</a> <span class="keyword">const</span>* procEntry = <a class="code" href="../../d3/d75/_spell_mgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>-&gt;GetSpellProcEntry(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>()))</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        maxProcCharges = procEntry-&gt;charges;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordflow">if</span> (caster)</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/d53/class_player.html">Player</a>* modOwner = caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a2e6a98844f96c211f47b911a2766ada8">GetSpellModOwner</a>())</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            modOwner-&gt;ApplySpellMod(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>(), <a class="code" href="../../d5/d32/_unit_8h.html#a39b60e1f12cca9b6873cb817e7717351ae8f4e49f8ba63fb75c0c151d851b5bae">SPELLMOD_CHARGES</a>, maxProcCharges);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">return</span> maxProcCharges;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;}</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a52fbcc7d7f48d46bed2873889640e6d3">  925</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a52fbcc7d7f48d46bed2873889640e6d3">Aura::ModCharges</a>(<a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> num, <a class="code" href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94">AuraRemoveMode</a> removeMode)</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;{</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a62c2b89c6a9269aba7870b36e5872330">IsUsingCharges</a>())</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> charges = <a class="code" href="../../d2/dde/class_aura.html#af32b9da81a73be723f660ae4e3363e74">m_procCharges</a> + num;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> maxCharges = <a class="code" href="../../d2/dde/class_aura.html#ad786924c8b4617ff4724065b6452b04f">CalcMaxCharges</a>();</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="comment">// limit charges (only on charges increase, charges may be changed manually)</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <span class="keywordflow">if</span> ((num &gt; 0) &amp;&amp; (charges &gt; <a class="code" href="../../df/de2/namespace_g3_d.html#af80d9dbc6fa48c9ff714c7158adb60ae">int32</a>(maxCharges)))</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            charges = maxCharges;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <span class="comment">// we&#39;re out of charges, remove</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (charges &lt;= 0)</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            <a class="code" href="../../d2/dde/class_aura.html#af9799e5670c2bc3899e3430aa793ca20">Remove</a>(removeMode);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        }</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <a class="code" href="../../d2/dde/class_aura.html#a7f7d613279717173c13708425f3a8083">SetCharges</a>(charges);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    }</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;}</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a1f6c2606d7dc499c1fc1ba0cee1f255b">  947</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a1f6c2606d7dc499c1fc1ba0cee1f255b">Aura::SetStackAmount</a>(<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> stackAmount)</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;{</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a3c01fd7df3476af276831667baa3a0ee">m_stackAmount</a> = stackAmount;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster = <a class="code" href="../../d2/dde/class_aura.html#a6fc52109b7711606f15d9880fda8f815">GetCaster</a>();</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keywordflow">if</span> (!caster)</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160; </div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    std::list&lt;AuraApplication*&gt; <a class="code" href="../../dc/dc5/recastnavigation_2_license_8txt.html#a0982397e348bfa91aa5cde96862ce11f">applications</a>;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a66f71f0ac319d34ae8cbe5bc4b4bcfb7">GetApplicationList</a>(<a class="code" href="../../dc/dc5/recastnavigation_2_license_8txt.html#a0982397e348bfa91aa5cde96862ce11f">applications</a>);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraApplication*&gt;::const_iterator apptItr = <a class="code" href="../../dc/dc5/recastnavigation_2_license_8txt.html#a0982397e348bfa91aa5cde96862ce11f">applications</a>.begin(); apptItr != <a class="code" href="../../dc/dc5/recastnavigation_2_license_8txt.html#a0982397e348bfa91aa5cde96862ce11f">applications</a>.end(); ++apptItr)</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <span class="keywordflow">if</span> (!(*apptItr)-&gt;GetRemoveMode())</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            <a class="code" href="../../d2/dde/class_aura.html#ac6a690bd3e87d00af4c6a562b250f6f1">HandleAuraSpecificMods</a>(*apptItr, caster, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a3d22c519ba658770e61a1616be667a09">HasEffect</a>(i))</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            <a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i]-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a07673908af178ffaee01353a6d11a703">ChangeAmount</a>(<a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i]-&gt;CalculateAmount(caster), <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraApplication*&gt;::const_iterator apptItr = <a class="code" href="../../dc/dc5/recastnavigation_2_license_8txt.html#a0982397e348bfa91aa5cde96862ce11f">applications</a>.begin(); apptItr != <a class="code" href="../../dc/dc5/recastnavigation_2_license_8txt.html#a0982397e348bfa91aa5cde96862ce11f">applications</a>.end(); ++apptItr)</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <span class="keywordflow">if</span> (!(*apptItr)-&gt;GetRemoveMode())</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            <a class="code" href="../../d2/dde/class_aura.html#ac6a690bd3e87d00af4c6a562b250f6f1">HandleAuraSpecificMods</a>(*apptItr, caster, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a8f9f4a57e87c86b384b637403fff06e7">SetNeedClientUpdateForTargets</a>();</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;}</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; </div>
<div class="line"><a name="l00973"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a69b589a7414d5d73ed75d12d5ba736ef">  973</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a69b589a7414d5d73ed75d12d5ba736ef">Aura::ModStackAmount</a>(<a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> num, <a class="code" href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94">AuraRemoveMode</a> removeMode, <span class="keywordtype">bool</span> periodicReset <span class="comment">/*= false*/</span>)</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;{</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> stackAmount = <a class="code" href="../../d2/dde/class_aura.html#a3c01fd7df3476af276831667baa3a0ee">m_stackAmount</a> + num;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160; </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="comment">// limit the stack amount (only on stack increase, stack amount may be changed manually)</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordflow">if</span> ((num &gt; 0) &amp;&amp; (stackAmount &gt; <a class="code" href="../../df/de2/namespace_g3_d.html#af80d9dbc6fa48c9ff714c7158adb60ae">int32</a>(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a46f51f384b1455b03000e98a08d11790">StackAmount</a>)))</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="comment">// not stackable aura - set stack amount to 1</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a46f51f384b1455b03000e98a08d11790">StackAmount</a>)</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            stackAmount = 1;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            stackAmount = <a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a46f51f384b1455b03000e98a08d11790">StackAmount</a>;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    }</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">// we&#39;re out of stacks, remove</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stackAmount &lt;= 0)</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <a class="code" href="../../d2/dde/class_aura.html#af9799e5670c2bc3899e3430aa793ca20">Remove</a>(removeMode);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    }</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordtype">bool</span> refresh = stackAmount &gt;= <a class="code" href="../../d2/dde/class_aura.html#aae0b7e0da61a681e67a19b6d23c2cee6">GetStackAmount</a>() &amp;&amp; (<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a46f51f384b1455b03000e98a08d11790">StackAmount</a> || !<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a975746d6b737abb063ea037327abfc5a">HasAttribute</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#a638f8f550e23b2e3180b481bb3f38076a804cce10f0767b3a9083e899217af6e3">SPELL_ATTR1_AURA_UNIQUE</a>));</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="comment">// Update stack amount</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordflow">if</span> (refresh)</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    {</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <a class="code" href="../../d2/dde/class_aura.html#ae2a6c05d26b1254d93038b666d1e46cd">RefreshSpellMods</a>();</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <a class="code" href="../../d2/dde/class_aura.html#a2fa2b27d98d99af4f226c0156d47a628">RefreshTimers</a>(periodicReset);</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <span class="comment">// reset charges</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <a class="code" href="../../d2/dde/class_aura.html#a7f7d613279717173c13708425f3a8083">SetCharges</a>(<a class="code" href="../../d2/dde/class_aura.html#ad786924c8b4617ff4724065b6452b04f">CalcMaxCharges</a>());</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="comment">// FIXME: not a best way to synchronize charges, but works</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* aurEff = <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(i))</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                <span class="keywordflow">if</span> (aurEff-&gt;GetAuraType() == <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a50563ee6555455f041b81ce199ad1a4f">SPELL_AURA_ADD_FLAT_MODIFIER</a> || aurEff-&gt;GetAuraType() == <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a2c530c4b7d2f3b77f65f62395bda9c4a">SPELL_AURA_ADD_PCT_MODIFIER</a>)</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d3/d39/struct_spell_modifier.html">SpellModifier</a>* <a class="code" href="../../dd/d90/chrono_8h.html#ade692a13be7c7dfac09a8ff2fd00d172">mod</a> = aurEff-&gt;GetSpellModifier())</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                        <a class="code" href="../../dd/d90/chrono_8h.html#ade692a13be7c7dfac09a8ff2fd00d172">mod</a>-&gt;charges = <a class="code" href="../../d2/dde/class_aura.html#ab07705be94c0c10fce558c80d7208e0b">GetCharges</a>();</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a1f6c2606d7dc499c1fc1ba0cee1f255b">SetStackAmount</a>(stackAmount);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160; </div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a8f9f4a57e87c86b384b637403fff06e7">SetNeedClientUpdateForTargets</a>();</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;}</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; </div>
<div class="line"><a name="l01017"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#ae2a6c05d26b1254d93038b666d1e46cd"> 1017</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#ae2a6c05d26b1254d93038b666d1e46cd">Aura::RefreshSpellMods</a>()</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;{</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">for</span> (Aura::ApplicationMap::const_iterator appIter = <a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>.begin(); appIter != <a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>.end(); ++appIter)</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/d53/class_player.html">Player</a>* player = appIter-&gt;second-&gt;<a class="code" href="../../da/db7/class_unit.html#af387d5e18806e37f65ebc3408c0b8712">GetTarget</a>()-&gt;ToPlayer())</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            player-&gt;RestoreAllSpellMods(0, <span class="keyword">this</span>);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;}</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a13f14942fd6394df8e5d8ae820fd3fc7"> 1024</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a13f14942fd6394df8e5d8ae820fd3fc7">Aura::IsArea</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a3d22c519ba658770e61a1616be667a09">HasEffect</a>(i) &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;Effects[i].IsAreaAuraEffect())</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    }</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;}</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; </div>
<div class="line"><a name="l01034"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#ae24c050668e78ef9d8728e6b5bd77c12"> 1034</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#ae24c050668e78ef9d8728e6b5bd77c12">Aura::IsPassive</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a44ac36a7f40b3c5b26a82a3bb0e8af30">IsPassive</a>();</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;}</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; </div>
<div class="line"><a name="l01039"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a64355d207f7177e6d35a568b93ec322f"> 1039</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a64355d207f7177e6d35a568b93ec322f">Aura::IsDeathPersistent</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a40f8c8d2e4fc70591e503113a4328f46">IsDeathPersistent</a>();</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;}</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#abbd4948d31a548af813815efb91ff311"> 1044</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#abbd4948d31a548af813815efb91ff311">Aura::IsRemovedOnShapeLost</a>(<a class="code" href="../../da/db7/class_unit.html">Unit</a>* target)<span class="keyword"> const</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="../../d2/dde/class_aura.html#a3c4dfe75dad16fbf2afaf23ce77e4262">GetCasterGUID</a>() == target-&gt;<a class="code" href="../../d8/d83/class_object.html#ad23b997e2442fa6a6228ba73a7ecc138">GetGUID</a>() &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a21cf48a7eb77db7f731ebe746d2d6878">Stances</a> &amp;&amp; !<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a975746d6b737abb063ea037327abfc5a">HasAttribute</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#a583cc1b9a8909370e4d51a890d897668a7d005cac4a5ae05e73630754eee639fc">SPELL_ATTR2_ALLOW_WHILE_NOT_SHAPESHIFTED</a>) &amp;&amp; !<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a975746d6b737abb063ea037327abfc5a">HasAttribute</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#a9dcd0ba8d94905ba214797c12e7c44ada181bc0f8031c0a2e477f0eb213ae3fc0">SPELL_ATTR0_NOT_SHAPESHIFTED</a>));</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;}</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160; </div>
<div class="line"><a name="l01049"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a0b7486aa10607794eaa6739f73b19741"> 1049</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a0b7486aa10607794eaa6739f73b19741">Aura::CanBeSaved</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <a class="code" href="../../d4/d7d/class_spell_info.html">SpellInfo</a> <span class="keyword">const</span>* spellInfo = <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>();</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="keywordflow">if</span> (spellInfo-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a975746d6b737abb063ea037327abfc5a">HasAttribute</a>(<a class="code" href="../../dc/d70/_spell_info_8h.html#a93795b2131c8cbe38a7b23768a5a146da4d7ba94d96c89ebddcef8c081fb14557">SPELL_ATTR0_CU_FORCE_AURA_SAVING</a>))</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    }</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keywordflow">if</span> (spellInfo-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a975746d6b737abb063ea037327abfc5a">HasAttribute</a>(<a class="code" href="../../dc/d70/_spell_info_8h.html#a93795b2131c8cbe38a7b23768a5a146da779378cdabb274a575287575fa8bc912">SPELL_ATTR0_CU_REJECT_AURA_SAVING</a>))</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    {</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    }</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160; </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#ae24c050668e78ef9d8728e6b5bd77c12">IsPassive</a>() || (spellInfo-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a975746d6b737abb063ea037327abfc5a">HasAttribute</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#a9dcd0ba8d94905ba214797c12e7c44ada9d53bd915f5409506cb045a0688a0a75">SPELL_ATTR0_DO_NOT_DISPLAY</a>) &amp;&amp; spellInfo-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a21cf48a7eb77db7f731ebe746d2d6878">Stances</a>))</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    }</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="comment">// Xinef: do not save channel auras</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;IsChanneled())</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    {</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="comment">// Xinef: Check if aura is single target, not only spell info</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a3c4dfe75dad16fbf2afaf23ce77e4262">GetCasterGUID</a>() != <a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>()-&gt;GetGUID() &amp;&amp; (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d2/dde/class_aura.html#afb782970ace7a9385038481911d388fc">IsSingleTarget</a>() || <a class="code" href="../../d2/dde/class_aura.html#afb782970ace7a9385038481911d388fc">IsSingleTarget</a>()))</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    {</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    }</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="comment">// Xinef: Dont save control vehicle auras - caster may not exist</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a6890e111fba863b7163fa5eb0b0870f5">HasEffectType</a>(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a583bf7e94825b7252010ad12dd50ed6f">SPELL_AURA_CONTROL_VEHICLE</a>))</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    }</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="comment">// Can&#39;t be saved - aura handler relies on calculated amount and changes it</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a6890e111fba863b7163fa5eb0b0870f5">HasEffectType</a>(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a3ea4c20e7d6e039f209ab904172d53e9">SPELL_AURA_CONVERT_RUNE</a>))</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    {</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    }</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160; </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="comment">// No point in saving this, since the stable dialog can&#39;t be open on aura load anyway.</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a6890e111fba863b7163fa5eb0b0870f5">HasEffectType</a>(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799ad75b18045110664869a6a4a86c4db16e">SPELL_AURA_OPEN_STABLE</a>))</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    {</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    }</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="comment">// xinef: do not save bind sight auras!</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a6890e111fba863b7163fa5eb0b0870f5">HasEffectType</a>(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799aff313dd31d66c100086b4d9b6a81d329">SPELL_AURA_BIND_SIGHT</a>))</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    }</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="comment">// xinef: no charming auras (taking direct control)</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a6890e111fba863b7163fa5eb0b0870f5">HasEffectType</a>(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799adc30e3257d95c2736a98331a53766eea">SPELL_AURA_MOD_POSSESS</a>) || <a class="code" href="../../d2/dde/class_aura.html#a6890e111fba863b7163fa5eb0b0870f5">HasEffectType</a>(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a30ae3c9499778cc5f920e81dc86cd020">SPELL_AURA_MOD_POSSESS_PET</a>))</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    }</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="comment">// xinef: no charming auras can be saved</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a6890e111fba863b7163fa5eb0b0870f5">HasEffectType</a>(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a7b5d0b48f9a7e84bf7a896602e8c66b9">SPELL_AURA_MOD_CHARM</a>) || <a class="code" href="../../d2/dde/class_aura.html#a6890e111fba863b7163fa5eb0b0870f5">HasEffectType</a>(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799aada4a291fd71b7b408ec0ac6543e79b1">SPELL_AURA_AOE_CHARM</a>))</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160; </div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="comment">// don&#39;t save auras removed by proc system</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a62c2b89c6a9269aba7870b36e5872330">IsUsingCharges</a>() &amp;&amp; !<a class="code" href="../../d2/dde/class_aura.html#ab07705be94c0c10fce558c80d7208e0b">GetCharges</a>())</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    {</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    }</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160; </div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;}</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; </div>
<div class="line"><a name="l01125"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a323b5e9af786e15e7e1bdac6a47ea359"> 1125</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a323b5e9af786e15e7e1bdac6a47ea359">Aura::CanBeSentToClient</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="keywordflow">return</span> !<a class="code" href="../../d2/dde/class_aura.html#ae24c050668e78ef9d8728e6b5bd77c12">IsPassive</a>() || <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#abdcbf79c1c255a5f7029a93a75e5cebf">HasAreaAuraEffect</a>() || <a class="code" href="../../d2/dde/class_aura.html#a6890e111fba863b7163fa5eb0b0870f5">HasEffectType</a>(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a1a0187ab21626c9032d7398c0b98941d">SPELL_AURA_ABILITY_IGNORE_AURASTATE</a>);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;}</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160; </div>
<div class="line"><a name="l01130"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a51d9e2f08034d14c95ab54045d6860a1"> 1130</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a51d9e2f08034d14c95ab54045d6860a1">Aura::IsSingleTargetWith</a>(<a class="code" href="../../d2/dde/class_aura.html">Aura</a> <span class="keyword">const</span>* aura)<span class="keyword"> const</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="comment">// Same spell?</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;IsRankOf(aura-&gt;<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()))</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; </div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <a class="code" href="../../dc/d70/_spell_info_8h.html#a967f80d0c19acebc2e322c73b7b16442">SpellSpecificType</a> spec = <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a5f7fd27528084c1e80f74896fac4ac53">GetSpellSpecific</a>();</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="comment">// spell with single target specific types</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keywordflow">switch</span> (spec)</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../dc/d70/_spell_info_8h.html#a967f80d0c19acebc2e322c73b7b16442a7fec7caa0a8ef5d84d2c896a2e06520f">SPELL_SPECIFIC_JUDGEMENT</a>:</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../dc/d70/_spell_info_8h.html#a967f80d0c19acebc2e322c73b7b16442ab739709876cc712a09e288c112b7d128">SPELL_SPECIFIC_MAGE_POLYMORPH</a>:</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            <span class="keywordflow">if</span> (aura-&gt;<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a5f7fd27528084c1e80f74896fac4ac53">GetSpellSpecific</a>() == spec)</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; </div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a6890e111fba863b7163fa5eb0b0870f5">HasEffectType</a>(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a583bf7e94825b7252010ad12dd50ed6f">SPELL_AURA_CONTROL_VEHICLE</a>) &amp;&amp; aura-&gt;<a class="code" href="../../d2/dde/class_aura.html#a6890e111fba863b7163fa5eb0b0870f5">HasEffectType</a>(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a583bf7e94825b7252010ad12dd50ed6f">SPELL_AURA_CONTROL_VEHICLE</a>))</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160; </div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;}</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; </div>
<div class="line"><a name="l01155"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a640ec9d7dd98eaf508209a8e3991ea4c"> 1155</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a640ec9d7dd98eaf508209a8e3991ea4c">Aura::UnregisterSingleTarget</a>()</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;{</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(<a class="code" href="../../d2/dde/class_aura.html#af22450afa8bf33c979c0a0f7d801ab4c">m_isSingleTarget</a>);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster = <a class="code" href="../../d2/dde/class_aura.html#a6fc52109b7711606f15d9880fda8f815">GetCaster</a>();</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keywordflow">if</span> (!caster)</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    {</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        <a class="code" href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a271e427d8e8481efd5cd5f537ec9e419">LOG_INFO</a>(<span class="stringliteral">&quot;spells&quot;</span>, <span class="stringliteral">&quot;Aura::UnregisterSingleTarget: (A1) - %u, %u, %u, %s&quot;</span>, <a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>(), <a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>()-&gt;GetTypeId(), <a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>()-&gt;GetEntry(), <a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>()-&gt;<a class="code" href="../../df/d1b/namespace_account_mgr.html#af911e3860ec519c541d6df35468ee41b">GetName</a>().c_str());</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <a class="code" href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a43832e3fa8508deb4ce43e520005fcd9">LOG_ERROR</a>(<span class="stringliteral">&quot;spells&quot;</span>, <span class="stringliteral">&quot;Aura::UnregisterSingleTarget: No caster was found.&quot;</span>); <span class="comment">//ASSERT(caster);</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    }</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a84c1f5910cb098f81a290fba938ad4c7">GetSingleCastAuras</a>().remove(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160; </div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#acb34c6f61b861a35398f1d8b7947312e">SetIsSingleTarget</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;}</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160; </div>
<div class="line"><a name="l01170"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a7e2bf3f6ccfcf6531a3cb146f1eb5405"> 1170</a></span>&#160;<a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> <a class="code" href="../../d2/dde/class_aura.html#a7e2bf3f6ccfcf6531a3cb146f1eb5405">Aura::CalcDispelChance</a>(<a class="code" href="../../da/db7/class_unit.html">Unit</a>* auraTarget, <span class="keywordtype">bool</span> offensive)<span class="keyword"> const</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="comment">// we assume that aura dispel chance is 100% on start</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="comment">// need formula for level difference based chance</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> resistChance = 0;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160; </div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="comment">// Apply dispel mod from aura caster</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster = <a class="code" href="../../d2/dde/class_aura.html#a6fc52109b7711606f15d9880fda8f815">GetCaster</a>())</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/d53/class_player.html">Player</a>* modOwner = caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a2e6a98844f96c211f47b911a2766ada8">GetSpellModOwner</a>())</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            modOwner-&gt;ApplySpellMod(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>(), <a class="code" href="../../d5/d32/_unit_8h.html#a39b60e1f12cca9b6873cb817e7717351afeabfe64507fbc8262484ccb76f4bf49">SPELLMOD_RESIST_DISPEL_CHANCE</a>, resistChance);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="comment">// Dispel resistance from target SPELL_AURA_MOD_DISPEL_RESIST</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="comment">// Only affects offensive dispels</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keywordflow">if</span> (offensive &amp;&amp; auraTarget)</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        resistChance += auraTarget-&gt;<a class="code" href="../../da/db7/class_unit.html#ad8ea13960b62a966b516a1929585ea7b">GetTotalAuraModifier</a>(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799afba710f82abb2c1c8a2c9a267a68a340">SPELL_AURA_MOD_DISPEL_RESIST</a>);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160; </div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    resistChance = resistChance &lt; 0 ? 0 : resistChance;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    resistChance = resistChance &gt; 100 ? 100 : resistChance;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="keywordflow">return</span> 100 - resistChance;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;}</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160; </div>
<div class="line"><a name="l01191"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a585e23fd7b42fa974a2d014fe366ede9"> 1191</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a585e23fd7b42fa974a2d014fe366ede9">Aura::SetLoadedState</a>(<a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> maxduration, <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> duration, <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> charges, <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> stackamount, <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> recalculateMask, <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>* amount)</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;{</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a24ab9b1f0a73ca4da9aa77e9ee0e3a55">m_maxDuration</a> = maxduration;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a406738b04948572a30626082ebe7a0e0">m_duration</a> = duration;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#af32b9da81a73be723f660ae4e3363e74">m_procCharges</a> = charges;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#ad8811634ba5d82b9581e94e8a0fd6097">m_isUsingCharges</a> = <a class="code" href="../../d2/dde/class_aura.html#af32b9da81a73be723f660ae4e3363e74">m_procCharges</a> != 0;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a3c01fd7df3476af276831667baa3a0ee">m_stackAmount</a> = stackamount;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster = <a class="code" href="../../d2/dde/class_aura.html#a6fc52109b7711606f15d9880fda8f815">GetCaster</a>();</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i])</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        {</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            <a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i]-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a9790b9f33c52c6d3b830dc6f56f08bf0">SetAmount</a>(amount[i]);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;            <a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i]-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#af93cf68cd8854d93010663353043e4a2">SetCanBeRecalculated</a>(recalculateMask &amp; (1 &lt;&lt; i));</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;            <a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i]-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a5b0a6694f62bf72c41a1f461f9894581">CalculatePeriodic</a>(caster, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;            <a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i]-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a5d248ef37c73049cf4df98b6fc1008fe">CalculateSpellMod</a>();</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            <a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i]-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#adc38a016285e442a485c9b9bc17a6105">RecalculateAmount</a>(caster);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        }</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;}</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160; </div>
<div class="line"><a name="l01210"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a6890e111fba863b7163fa5eb0b0870f5"> 1210</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a6890e111fba863b7163fa5eb0b0870f5">Aura::HasEffectType</a>(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799">AuraType</a> <a class="code" href="../../d5/d71/fmt_2include_2fmt_2core_8h.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    {</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a3d22c519ba658770e61a1616be667a09">HasEffect</a>(i) &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i]-&gt;GetAuraType() == <a class="code" href="../../d5/d71/fmt_2include_2fmt_2core_8h.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a>)</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;}</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; </div>
<div class="line"><a name="l01220"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#adbd7f397bbd36e4273d430032ddcd073"> 1220</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#adbd7f397bbd36e4273d430032ddcd073">Aura::RecalculateAmountOfEffects</a>()</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;{</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a> (!<a class="code" href="../../d2/dde/class_aura.html#a462457cadd52ba8a0edd5609c71ebbc0">IsRemoved</a>());</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster = <a class="code" href="../../d2/dde/class_aura.html#a6fc52109b7711606f15d9880fda8f815">GetCaster</a>();</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a3d22c519ba658770e61a1616be667a09">HasEffect</a>(i))</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;            <a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i]-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#adc38a016285e442a485c9b9bc17a6105">RecalculateAmount</a>(caster);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;}</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a03c8f1e4156ac6526e401f2a95ad08e7"> 1229</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a03c8f1e4156ac6526e401f2a95ad08e7">Aura::HandleAllEffects</a>(<a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a>* aurApp, <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> mode, <span class="keywordtype">bool</span> <a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a>)</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;{</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a> (!<a class="code" href="../../d2/dde/class_aura.html#a462457cadd52ba8a0edd5609c71ebbc0">IsRemoved</a>());</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i] &amp;&amp; !<a class="code" href="../../d2/dde/class_aura.html#a462457cadd52ba8a0edd5609c71ebbc0">IsRemoved</a>())</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            <a class="code" href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">m_effects</a>[i]-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a7710e32fe9dc267292c3b15333521560">HandleEffect</a>(aurApp, mode, <a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a>);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;}</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160; </div>
<div class="line"><a name="l01237"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a66f71f0ac319d34ae8cbe5bc4b4bcfb7"> 1237</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a66f71f0ac319d34ae8cbe5bc4b4bcfb7">Aura::GetApplicationList</a>(std::list&lt;AuraApplication*&gt;&amp; applicationList)<span class="keyword"> const</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keywordflow">for</span> (Aura::ApplicationMap::const_iterator appIter = <a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>.begin(); appIter != <a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>.end(); ++appIter)</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    {</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <span class="keywordflow">if</span> (appIter-&gt;second-&gt;GetEffectMask())</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;            applicationList.push_back(appIter-&gt;second);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    }</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;}</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160; </div>
<div class="line"><a name="l01246"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a8f9f4a57e87c86b384b637403fff06e7"> 1246</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a8f9f4a57e87c86b384b637403fff06e7">Aura::SetNeedClientUpdateForTargets</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="keywordflow">for</span> (ApplicationMap::const_iterator appIter = <a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>.begin(); appIter != <a class="code" href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">m_applications</a>.end(); ++appIter)</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        appIter-&gt;second-&gt;SetNeedClientUpdate();</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;}</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160; </div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment">// trigger effects on real aura apply/remove</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#ac6a690bd3e87d00af4c6a562b250f6f1"> 1253</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#ac6a690bd3e87d00af4c6a562b250f6f1">Aura::HandleAuraSpecificMods</a>(<a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a> <span class="keyword">const</span>* aurApp, <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster, <span class="keywordtype">bool</span> <a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a>, <span class="keywordtype">bool</span> onReapply)</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;{</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <a class="code" href="../../da/db7/class_unit.html">Unit</a>* target = aurApp-&gt;<a class="code" href="../../d8/da3/class_aura_application.html#a48f6d82daf06f6f2ced98484c2b56248">GetTarget</a>();</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <a class="code" href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94">AuraRemoveMode</a> removeMode = aurApp-&gt;<a class="code" href="../../d8/da3/class_aura_application.html#ae6b921446fc7901f8f053e19c3fb3f4c">GetRemoveMode</a>();</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="comment">// handle spell_area table</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <a class="code" href="../../d3/d75/_spell_mgr_8h.html#a69bbd3906e9d334176d6a0ffde617490">SpellAreaForAreaMapBounds</a> saBounds = <a class="code" href="../../d3/d75/_spell_mgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>-&gt;GetSpellAreaForAuraMapBounds(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>());</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">if</span> (saBounds.first != saBounds.second)</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    {</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        <a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> zone, area;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        target-&gt;<a class="code" href="../../db/df7/class_world_object.html#ae1a8efe701e885f0ed1eaeb93bbece8e">GetZoneAndAreaId</a>(zone, area);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160; </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        <span class="keywordflow">for</span> (SpellAreaForAreaMap::const_iterator itr = saBounds.first; itr != saBounds.second; ++itr)</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            <span class="comment">// some auras remove at aura remove</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;            <span class="keywordflow">if</span> (!itr-&gt;second-&gt;IsFitToRequirements(target-&gt;<a class="code" href="../../d8/d83/class_object.html#ae635434021784608b659501867538c87">ToPlayer</a>(), zone, area))</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                target-&gt;<a class="code" href="../../da/db7/class_unit.html#aac612f06e84142d92dcfc432b5feb4ac">RemoveAurasDueToSpell</a>(itr-&gt;second-&gt;spellId);</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            <span class="comment">// some auras applied at aura apply</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (itr-&gt;second-&gt;autocast)</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;            {</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">HasAura</a>(itr-&gt;second-&gt;spellId))</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                    target-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, itr-&gt;second-&gt;spellId, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            }</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        }</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    }</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160; </div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="comment">// handle spell_linked_spell table</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordflow">if</span> (!onReapply)</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        <span class="comment">// apply linked auras</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a>)</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        {</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;            <span class="keywordflow">if</span> (std::vector&lt;int32&gt; <span class="keyword">const</span>* spellTriggered = <a class="code" href="../../d3/d75/_spell_mgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>-&gt;GetSpellLinked(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>() + <a class="code" href="../../d3/d75/_spell_mgr_8h.html#ab05dedebdd8cfd6f2028ccc48bd240ddaa3391be8356e56c204b6a35987068fb0">SPELL_LINK_AURA</a>))</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;            {</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                <span class="keywordflow">for</span> (std::vector&lt;int32&gt;::const_iterator itr = spellTriggered-&gt;begin(); itr != spellTriggered-&gt;end(); ++itr)</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                {</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                    <span class="keywordflow">if</span> (*itr &lt; 0)</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                        target-&gt;<a class="code" href="../../da/db7/class_unit.html#a1afc1e413f12c5bd7bc00c926fa05833">ApplySpellImmune</a>(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>(), <a class="code" href="../../df/d0b/_shared_defines_8h.html#a91d505a1e789c6ea6a338f3a3c85b6b9a981326220afec59126417e02e0b882de">IMMUNITY_ID</a>, -(*itr), <span class="keyword">true</span>);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (caster)</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                        caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a51d433dde350cd94d7c3c43e30ca997f">AddAura</a>(*itr, target);</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                }</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;            }</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        }</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        {</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;            <span class="comment">// remove linked auras</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;            <span class="keywordflow">if</span> (std::vector&lt;int32&gt; <span class="keyword">const</span>* spellTriggered = <a class="code" href="../../d3/d75/_spell_mgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>-&gt;GetSpellLinked(-(<a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>)<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>()))</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;            {</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                <span class="keywordflow">for</span> (std::vector&lt;int32&gt;::const_iterator itr = spellTriggered-&gt;begin(); itr != spellTriggered-&gt;end(); ++itr)</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                {</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                    <span class="keywordflow">if</span> (*itr &lt; 0)</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                        target-&gt;<a class="code" href="../../da/db7/class_unit.html#aac612f06e84142d92dcfc432b5feb4ac">RemoveAurasDueToSpell</a>(-(*itr));</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (removeMode != <a class="code" href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94a8b8b753a1458a21a162528088acee913">AURA_REMOVE_BY_DEATH</a>)</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                        target-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, *itr, <span class="keyword">true</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <a class="code" href="../../d2/dde/class_aura.html#a3c4dfe75dad16fbf2afaf23ce77e4262">GetCasterGUID</a>());</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                }</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            }</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;            <span class="keywordflow">if</span> (std::vector&lt;int32&gt; <span class="keyword">const</span>* spellTriggered = <a class="code" href="../../d3/d75/_spell_mgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>-&gt;GetSpellLinked(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>() + <a class="code" href="../../d3/d75/_spell_mgr_8h.html#ab05dedebdd8cfd6f2028ccc48bd240ddaa3391be8356e56c204b6a35987068fb0">SPELL_LINK_AURA</a>))</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;            {</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                <span class="keywordflow">for</span> (std::vector&lt;int32&gt;::const_iterator itr = spellTriggered-&gt;begin(); itr != spellTriggered-&gt;end(); ++itr)</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                {</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                    <span class="keywordflow">if</span> (*itr &lt; 0)</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                        target-&gt;<a class="code" href="../../da/db7/class_unit.html#a1afc1e413f12c5bd7bc00c926fa05833">ApplySpellImmune</a>(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>(), <a class="code" href="../../df/d0b/_shared_defines_8h.html#a91d505a1e789c6ea6a338f3a3c85b6b9a981326220afec59126417e02e0b882de">IMMUNITY_ID</a>, -(*itr), <span class="keyword">false</span>);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                        target-&gt;<a class="code" href="../../da/db7/class_unit.html#a1be09c524dfdd2c3538f2ae977c58399">RemoveAura</a>(*itr, <a class="code" href="../../d2/dde/class_aura.html#a3c4dfe75dad16fbf2afaf23ce77e4262">GetCasterGUID</a>(), 0, removeMode);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                }</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;            }</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        }</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    }</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a>)</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    {</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        <span class="comment">// modify stack amount of linked auras</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        <span class="keywordflow">if</span> (std::vector&lt;int32&gt; <span class="keyword">const</span>* spellTriggered = <a class="code" href="../../d3/d75/_spell_mgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>-&gt;GetSpellLinked(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>() + <a class="code" href="../../d3/d75/_spell_mgr_8h.html#ab05dedebdd8cfd6f2028ccc48bd240ddaa3391be8356e56c204b6a35987068fb0">SPELL_LINK_AURA</a>))</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        {</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            <span class="keywordflow">for</span> (std::vector&lt;int32&gt;::const_iterator itr = spellTriggered-&gt;begin(); itr != spellTriggered-&gt;end(); ++itr)</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                <span class="keywordflow">if</span> (*itr &gt; 0)</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html">Aura</a>* triggeredAura = target-&gt;<a class="code" href="../../da/db7/class_unit.html#a135e4d345c338da83450a60528f71222">GetAura</a>(*itr, <a class="code" href="../../d2/dde/class_aura.html#a3c4dfe75dad16fbf2afaf23ce77e4262">GetCasterGUID</a>()))</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                        triggeredAura-&gt;ModStackAmount(<a class="code" href="../../d2/dde/class_aura.html#aae0b7e0da61a681e67a19b6d23c2cee6">GetStackAmount</a>() - triggeredAura-&gt;GetStackAmount());</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        }</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    }</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160; </div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="comment">// mods at aura apply</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a>)</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    {</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellFamilyName)</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        {</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba0ebbb6206eb92cdc484b416eb6f41743">SPELLFAMILY_GENERIC</a>:</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                <span class="keywordflow">switch</span> (<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>())</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                {</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                    <span class="keywordflow">case</span> 32474: <span class="comment">// Buffeting Winds of Susurrus</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                        <span class="keywordflow">if</span> (target-&gt;<a class="code" href="../../d8/d83/class_object.html#a621a345fc34deed6d3a4e1e498a652da">GetTypeId</a>() == <a class="code" href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                            target-&gt;<a class="code" href="../../d8/d83/class_object.html#ae635434021784608b659501867538c87">ToPlayer</a>()-&gt;<a class="code" href="../../d8/d53/class_player.html#a582a0cd15b37f0b0302e6f758e299e2c">ActivateTaxiPathTo</a>(506, <a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>());</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                    <span class="keywordflow">case</span> 33572: <span class="comment">// Gronn Lord&#39;s Grasp, becomes stoned</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#aae0b7e0da61a681e67a19b6d23c2cee6">GetStackAmount</a>() &gt;= 5 &amp;&amp; !target-&gt;<a class="code" href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">HasAura</a>(33652))</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                            target-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, 33652, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                    <span class="keywordflow">case</span> 50836: <span class="comment">//Petrifying Grip, becomes stoned</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#aae0b7e0da61a681e67a19b6d23c2cee6">GetStackAmount</a>() &gt;= 5 &amp;&amp; !target-&gt;<a class="code" href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">HasAura</a>(50812))</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                            target-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, 50812, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                    <span class="keywordflow">case</span> 60970: <span class="comment">// Heroic Fury (remove Intercept cooldown)</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                        <span class="keywordflow">if</span> (target-&gt;<a class="code" href="../../d8/d83/class_object.html#a621a345fc34deed6d3a4e1e498a652da">GetTypeId</a>() == <a class="code" href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                            target-&gt;<a class="code" href="../../d8/d83/class_object.html#ae635434021784608b659501867538c87">ToPlayer</a>()-&gt;<a class="code" href="../../d8/d53/class_player.html#ad52044947ef0aa2325b2688075bac34d">RemoveSpellCooldown</a>(20252, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                }</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba0e4b88db8be01ea5d62cc08d07b28aae">SPELLFAMILY_MAGE</a>:</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                <span class="keywordflow">if</span> (!caster)</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellFamilyFlags[0] &amp; 0x00000001 &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellFamilyFlags[2] &amp; 0x00000008)</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                {</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                    <span class="comment">// Glyph of Fireball</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                    <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">HasAura</a>(56368))</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                        <a class="code" href="../../d2/dde/class_aura.html#a99930c42ad9f6e002ffe6de5e5fbe59b">SetDuration</a>(0);</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                }</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellFamilyFlags[0] &amp; 0x00000020 &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellVisual[0] == 13)</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                {</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                    <span class="comment">// Glyph of Frostbolt</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                    <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">HasAura</a>(56370))</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                        <a class="code" href="../../d2/dde/class_aura.html#a99930c42ad9f6e002ffe6de5e5fbe59b">SetDuration</a>(0);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                }</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                <span class="comment">// Todo: This should be moved to similar function in spell::hit</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellFamilyFlags[0] &amp; 0x01000000)</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                {</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                    <span class="comment">// Polymorph Sound - Sheep &amp;&amp; Penguin</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellIconID == 82 &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellVisual[0] == 12978)</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                    {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                        <span class="comment">// Glyph of the Penguin</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                        <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">HasAura</a>(52648))</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                            caster-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, 61635, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                            caster-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, 61634, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                    }</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160; </div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d1/dac/class_creature.html">Creature</a>* creatureTarget = target-&gt;<a class="code" href="../../d8/d83/class_object.html#a4a4bdac0d151f9193aa3581bda31193c">ToCreature</a>())</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                    {</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                        creatureTarget-&gt;CallAssistance(caster);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                    }</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                }</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                <span class="keywordflow">switch</span> (<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>())</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                {</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                    <span class="keywordflow">case</span> 12536: <span class="comment">// Clearcasting</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                    <span class="keywordflow">case</span> 12043: <span class="comment">// Presence of Mind</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                        <span class="comment">// Arcane Potency</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a> <span class="keyword">const</span>* aurEff = caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a520e229dc1a93ea4a53d0ba81e586d11">GetAuraEffect</a>(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a66cca11731d68512cb0bb652cb1e7caf">SPELL_AURA_DUMMY</a>, <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba0e4b88db8be01ea5d62cc08d07b28aae">SPELLFAMILY_MAGE</a>, 2120, 0))</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                        {</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                            <a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> spellId = 0;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160; </div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                            <span class="keywordflow">switch</span> (aurEff-&gt;GetId())</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                            {</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                                <span class="keywordflow">case</span> 31571:</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                                    spellId = 57529;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                                <span class="keywordflow">case</span> 31572:</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                                    spellId = 57531;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                                    <a class="code" href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a43832e3fa8508deb4ce43e520005fcd9">LOG_ERROR</a>(<span class="stringliteral">&quot;spells.aura&quot;</span>, <span class="stringliteral">&quot;Aura::HandleAuraSpecificMods: Unknown rank of Arcane Potency (%d) found&quot;</span>, aurEff-&gt;GetId());</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                            }</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                            <span class="keywordflow">if</span> (spellId)</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                                caster-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(caster, spellId, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                        }</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                    <span class="keywordflow">case</span> 44544: <span class="comment">// Fingers of Frost</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                        {</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                            <span class="comment">// See if we already have the indicator aura. If not, create one.</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html">Aura</a>* aur = target-&gt;<a class="code" href="../../da/db7/class_unit.html#a135e4d345c338da83450a60528f71222">GetAura</a>(74396))</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                            {</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                                <span class="comment">// Aura already there. Refresh duration and set original charges</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                                aur-&gt;SetCharges(2);</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                                aur-&gt;RefreshDuration();</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                            }</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                                target-&gt;<a class="code" href="../../da/db7/class_unit.html#a51d433dde350cd94d7c3c43e30ca997f">AddAura</a>(74396, target);</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                        }</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                }</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1bac3788ce010075b8bd4e6083638d8cd40">SPELLFAMILY_DRUID</a>:</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                <span class="keywordflow">if</span> (!caster)</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                <span class="comment">// Rejuvenation</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellFamilyFlags[0] &amp; 0x10 &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0))</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                {</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                    <span class="comment">// Druid T8 Restoration 4P Bonus</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                    <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a73f40bd61fe24bcead25d6ab3b9efc25">GetAuraEffectDummy</a>(64760))</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                    {</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                        <a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> damage = <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0)-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#afcf272bebf373ad3aebc03cce644cbee">GetAmount</a>();</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                        damage = target-&gt;<a class="code" href="../../da/db7/class_unit.html#aeac23e55488fc69a1b90f0e92eaf1626">SpellHealingBonusTaken</a>(caster, <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>(), damage, <a class="code" href="../../d5/d32/_unit_8h.html#aff59f402d05917ab1de0c5f6bf148ea4a87fdcd2ffa8f71b49da9e0cfd4fb893f">DOT</a>);</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160; </div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                        <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> basepoints0 = damage;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                        caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a51ec81e114bf82a2485ba9f66200afd2">CastCustomSpell</a>(target, 64801, &amp;basepoints0, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">true</span>, <span class="keyword">nullptr</span>, <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0));</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                    }</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                }</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba04f59ec569a753b4e47a0a230782f207">SPELLFAMILY_PRIEST</a>:</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                <span class="keywordflow">if</span> (!caster)</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                <span class="comment">// Devouring Plague</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellFamilyFlags[0] &amp; 0x02000000 &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0))</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                {</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                    <span class="comment">// Improved Devouring Plague</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a> <span class="keyword">const</span>* aurEff = caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a8ef92f1d3a61f9fb2c8c24323d5d24af">GetDummyAuraEffect</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba04f59ec569a753b4e47a0a230782f207">SPELLFAMILY_PRIEST</a>, 3790, 1))</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                    {</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                        <a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> damage = <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0)-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#afcf272bebf373ad3aebc03cce644cbee">GetAmount</a>();</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                        damage = target-&gt;<a class="code" href="../../da/db7/class_unit.html#a8e8d13276a1ebef454bd4fc27fedc3f1">SpellDamageBonusTaken</a>(caster, <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>(), damage, <a class="code" href="../../d5/d32/_unit_8h.html#aff59f402d05917ab1de0c5f6bf148ea4a87fdcd2ffa8f71b49da9e0cfd4fb893f">DOT</a>);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                        <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> basepoints0 = aurEff-&gt;GetAmount() * <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0)-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a67ca18798f448847e77665752fa4a32c">GetTotalTicks</a>() * <a class="code" href="../../df/de2/namespace_g3_d.html#af80d9dbc6fa48c9ff714c7158adb60ae">int32</a>(damage) / 100;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                        <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> heal = <a class="code" href="../../df/de2/namespace_g3_d.html#af80d9dbc6fa48c9ff714c7158adb60ae">int32</a>(<a class="code" href="../../d9/de9/src_2common_2_utilities_2util_8h.html#ae00607f8188c59ffcea5a3997c0120b0">CalculatePct</a>(basepoints0, 15));</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160; </div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                        caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a51ec81e114bf82a2485ba9f66200afd2">CastCustomSpell</a>(target, 63675, &amp;basepoints0, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">true</span>, <span class="keyword">nullptr</span>, <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0));</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                        caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a51ec81e114bf82a2485ba9f66200afd2">CastCustomSpell</a>(caster, 75999, &amp;heal, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">true</span>, <span class="keyword">nullptr</span>, <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0));</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                    }</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                }</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                <span class="comment">// Power Word: Shield</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a30452de2bd62607418f3962d00124144">SpellFamilyFlags</a>[0] &amp; 0x1 &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a30452de2bd62607418f3962d00124144">SpellFamilyFlags</a>[2] &amp; 0x400 &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0))</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                {</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                    <span class="comment">// Glyph of Power Word: Shield</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* glyph = caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a520e229dc1a93ea4a53d0ba81e586d11">GetAuraEffect</a>(55672, 0))</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                    {</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                        <span class="comment">// instantly heal m_amount% of the absorb-value</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                        <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> heal = glyph-&gt;GetAmount() * <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0)-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#afcf272bebf373ad3aebc03cce644cbee">GetAmount</a>() / 100;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                        caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a51ec81e114bf82a2485ba9f66200afd2">CastCustomSpell</a>(<a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>(), 56160, &amp;heal, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">true</span>, 0, <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0));</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                    }</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                }</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba9160b2e3a87a908af25c9a594295c0c1">SPELLFAMILY_ROGUE</a>:</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                <span class="comment">// Sprint (skip non player casted spells by category)</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellFamilyFlags[0] &amp; 0x40 &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;GetCategory() == 44)</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                    <span class="comment">// in official maybe there is only one icon?</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">HasAura</a>(58039)) <span class="comment">// Glyph of Blurred Speed</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                        target-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, 61922, <span class="keyword">true</span>); <span class="comment">// Sprint (waterwalk)</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1badc34b27f2cd523716d80c51d4e1d6f02">SPELLFAMILY_DEATHKNIGHT</a>:</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                <span class="keywordflow">if</span> (!caster)</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                <span class="comment">// Frost Fever and Blood Plague</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellFamilyFlags[2] &amp; 0x2)</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                {</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                    <span class="comment">// Can&#39;t proc on self</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a3c4dfe75dad16fbf2afaf23ce77e4262">GetCasterGUID</a>() == target-&gt;<a class="code" href="../../d8/d83/class_object.html#ad23b997e2442fa6a6228ba73a7ecc138">GetGUID</a>())</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160; </div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                    <a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* aurEff = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                    <span class="comment">// Ebon Plaguebringer / Crypt Fever</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                    <a class="code" href="../../da/db7/class_unit.html#adcdd87d0c137619dfc869536c1315dd7">Unit::AuraEffectList</a> <span class="keyword">const</span>&amp; TalentAuras = caster-&gt;<a class="code" href="../../da/db7/class_unit.html#af00ac6c4dc7e639ac646fdafef336e85">GetAuraEffectsByType</a>(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799aee9829857fab1a5438db7a7fdf8806fa">SPELL_AURA_OVERRIDE_CLASS_SCRIPTS</a>);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                    <span class="keywordflow">for</span> (Unit::AuraEffectList::const_iterator itr = TalentAuras.begin(); itr != TalentAuras.end(); ++itr)</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                    {</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                        <span class="keywordflow">if</span> ((*itr)-&gt;GetMiscValue() == 7282)</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                        {</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                            aurEff = *itr;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                            <span class="comment">// Ebon Plaguebringer - end search if found</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                            <span class="keywordflow">if</span> ((*itr)-&gt;GetSpellInfo()-&gt;SpellIconID == 1766)</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                        }</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                    }</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                    <span class="keywordflow">if</span> (aurEff)</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                    {</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                        <a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> spellId = 0;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                        <span class="keywordflow">switch</span> (aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a63863fb01a8cf08251c0b4482be6a20f">GetId</a>())</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                        {</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                            <span class="comment">// Ebon Plague</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                            <span class="keywordflow">case</span> 51161:</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                                spellId = 51735;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                            <span class="keywordflow">case</span> 51160:</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                                spellId = 51734;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                            <span class="keywordflow">case</span> 51099:</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                                spellId = 51726;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                            <span class="comment">// Crypt Fever</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                            <span class="keywordflow">case</span> 49632:</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                                spellId = 50510;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                            <span class="keywordflow">case</span> 49631:</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                                spellId = 50509;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                            <span class="keywordflow">case</span> 49032:</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                                spellId = 50508;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                                <a class="code" href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a43832e3fa8508deb4ce43e520005fcd9">LOG_ERROR</a>(<span class="stringliteral">&quot;spells.aura&quot;</span>, <span class="stringliteral">&quot;Aura::HandleAuraSpecificMods: Unknown rank of Crypt Fever/Ebon Plague (%d) found&quot;</span>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a63863fb01a8cf08251c0b4482be6a20f">GetId</a>());</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                        }</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                        caster-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, spellId, <span class="keyword">true</span>, 0, <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0));</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                    }</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                }</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                <span class="comment">// Unholy blight</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>() == 50536)</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                {</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                    <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="../../da/db7/class_unit.html#abdfe022523c40277d917754f75edb722">IsFriendlyTo</a>(target))</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                        <a class="code" href="../../d2/dde/class_aura.html#a99930c42ad9f6e002ffe6de5e5fbe59b">SetDuration</a>(0);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                }</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba84336097f9e363a9b6a4d7d4839c1b54">SPELLFAMILY_POTION</a>:</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                <span class="comment">// Alchemy: Mixology</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                <span class="keywordflow">if</span> (caster &amp;&amp; caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">HasAura</a>(53042) &amp;&amp; caster-&gt;<a class="code" href="../../d8/d83/class_object.html#a621a345fc34deed6d3a4e1e498a652da">GetTypeId</a>() == <a class="code" href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp; !caster-&gt;<a class="code" href="../../d8/d83/class_object.html#ae635434021784608b659501867538c87">ToPlayer</a>()-&gt;<a class="code" href="../../d8/d53/class_player.html#a1c212b8f9ae8b1a38a41f9c7db005dca">GetSession</a>()-&gt;<a class="code" href="../../d1/d47/class_world_session.html#a6518fa6d76b730689eb44f2256af3726">PlayerLoading</a>())</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                {</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d3/d75/_spell_mgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>-&gt;GetSpellGroup(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>()) == 1) <span class="comment">/*Elixirs*/</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                    {</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                        <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a745ede574ea561dcfdd7f32f2f2a6c7e">HasSpell</a>(<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;Effects[<a class="code" href="../../df/d0b/_shared_defines_8h.html#a0b4a3c2c7210e88f82b3dc3abb6e6f77ae36fda04a2c1fff26525d0c57f79a36d">EFFECT_0</a>].TriggerSpell))</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                        {</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(i))</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                                    <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(i)-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a9790b9f33c52c6d3b830dc6f56f08bf0">SetAmount</a>(<a class="code" href="../../d9/de9/src_2common_2_utilities_2util_8h.html#ae00607f8188c59ffcea5a3997c0120b0">CalculatePct</a>(<a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(i)-&gt;GetAmount(), 100 + <a class="code" href="../../d3/d75/_spell_mgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>-&gt;GetSpellMixologyBonus(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>())));</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160; </div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                            <a class="code" href="../../d2/dde/class_aura.html#abf0ff1d6e3be882ce7e8ddd7e935ab66">SetMaxDuration</a>(caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a490990b2ec18be95c613e6394e4f3f6a">CalcSpellDuration</a>(<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()) * 2);</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                            <a class="code" href="../../d2/dde/class_aura.html#a99930c42ad9f6e002ffe6de5e5fbe59b">SetDuration</a>(<a class="code" href="../../d2/dde/class_aura.html#a14457cfa6d589b8024bbeeb1d4aa03d3">GetMaxDuration</a>());</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                        }</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                    }</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                }</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;        }</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    }</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <span class="comment">// mods at aura remove</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    {</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellFamilyName)</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        {</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba0ebbb6206eb92cdc484b416eb6f41743">SPELLFAMILY_GENERIC</a>:</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                <span class="keywordflow">if</span> (!caster)</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                <span class="keywordflow">switch</span>(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>())</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                {</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                    <span class="keywordflow">case</span> 61987: <span class="comment">// Avenging Wrath</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                        <span class="comment">// Remove the immunity shield marker on Avenging Wrath removal if Forbearance is not present</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                        <span class="keywordflow">if</span> (target-&gt;<a class="code" href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">HasAura</a>(61988) &amp;&amp; !target-&gt;<a class="code" href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">HasAura</a>(25771))</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                            target-&gt;<a class="code" href="../../da/db7/class_unit.html#a1be09c524dfdd2c3538f2ae977c58399">RemoveAura</a>(61988);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                    <span class="keywordflow">case</span> 72368: <span class="comment">// Shared Suffering</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                    <span class="keywordflow">case</span> 72369:</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* aurEff = <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0))</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                        {</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                            <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> remainingDamage = aurEff-&gt;GetAmount() * (aurEff-&gt;GetTotalTicks() - aurEff-&gt;GetTickNumber());</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                            <span class="keywordflow">if</span> (remainingDamage &gt; 0)</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                                caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a51ec81e114bf82a2485ba9f66200afd2">CastCustomSpell</a>(caster, 72373, <span class="keyword">nullptr</span>, &amp;remainingDamage, <span class="keyword">nullptr</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                        }</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                }</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba0e4b88db8be01ea5d62cc08d07b28aae">SPELLFAMILY_MAGE</a>:</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;            {</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                <span class="comment">// Polymorph</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a30452de2bd62607418f3962d00124144">SpellFamilyFlags</a>[0] &amp; 0x01000000)</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                {</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d1/dac/class_creature.html">Creature</a>* creatureTarget = target-&gt;<a class="code" href="../../d8/d83/class_object.html#a4a4bdac0d151f9193aa3581bda31193c">ToCreature</a>())</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                    {</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                        creatureTarget-&gt;SetNoCallAssistance(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                    }</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                }</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                <span class="keywordflow">switch</span> (<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>())</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;                {</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                    <span class="keywordflow">case</span> 66: <span class="comment">// Invisibility</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                        <span class="keywordflow">if</span> (removeMode != <a class="code" href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94a9ca05b22853d12d44ac7e80a9e864a10">AURA_REMOVE_BY_EXPIRE</a>)</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                        target-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, 32612, <span class="keyword">true</span>, <span class="keyword">nullptr</span>, <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(1));</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                        target-&gt;<a class="code" href="../../da/db7/class_unit.html#a18f77484ed2acc7be7fa29d1df7a0c12">CombatStop</a>();</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                    <span class="keywordflow">case</span> 74396: <span class="comment">// Fingers of Frost</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                        <span class="comment">// Remove the IGNORE_AURASTATE aura</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                        target-&gt;<a class="code" href="../../da/db7/class_unit.html#aac612f06e84142d92dcfc432b5feb4ac">RemoveAurasDueToSpell</a>(44544);</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                    <span class="keywordflow">case</span> 44401: <span class="comment">// Missile Barrage</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                    <span class="keywordflow">case</span> 48108: <span class="comment">// Hot Streak</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                    <span class="keywordflow">case</span> 57761: <span class="comment">// Fireball!</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                        <span class="keywordflow">if</span> (removeMode != <a class="code" href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94a9ca05b22853d12d44ac7e80a9e864a10">AURA_REMOVE_BY_EXPIRE</a> || aurApp-&gt;<a class="code" href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">GetBase</a>()-&gt;<a class="code" href="../../d2/dde/class_aura.html#ace74284832d9713a175bb3905449f954">IsExpired</a>())</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                        <span class="keywordflow">if</span> (target-&gt;<a class="code" href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">HasAura</a>(70752)) <span class="comment">// Item - Mage T10 2P Bonus</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                            target-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, 70753, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                }</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                <span class="keywordflow">if</span> (!caster)</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                <span class="comment">// Ice barrier - dispel/absorb remove</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                <span class="keywordflow">if</span> (removeMode == <a class="code" href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94aa40c81252e354a16d6f036827c872e12">AURA_REMOVE_BY_ENEMY_SPELL</a> &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a30452de2bd62607418f3962d00124144">SpellFamilyFlags</a>[1] &amp; 0x1)</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                    <span class="comment">// Shattered Barrier</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* absorb = <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#a0b4a3c2c7210e88f82b3dc3abb6e6f77ae36fda04a2c1fff26525d0c57f79a36d">EFFECT_0</a>))</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                        <span class="keywordflow">if</span> (absorb-&gt;GetAmount() &lt;= 0) <span class="comment">// removed by damage, not dispel</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* dummy = caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a8ef92f1d3a61f9fb2c8c24323d5d24af">GetDummyAuraEffect</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba0e4b88db8be01ea5d62cc08d07b28aae">SPELLFAMILY_MAGE</a>, 2945, 0))</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="../../d1/d65/src_2common_2_utilities_2_random_8h.html#a50320d4edff86db31b25138ae72161ad">roll_chance_i</a>(dummy-&gt;GetSpellInfo()-&gt;ProcChance))</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                                    caster-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, 55080, <span class="keyword">true</span>, <span class="keyword">nullptr</span>, <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0));</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                }</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;            }</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba52acbcf14a96b5ed01b8a43052a26a11">SPELLFAMILY_WARRIOR</a>:</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                <span class="keywordflow">if</span> (!caster)</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                [[fallthrough]]; <span class="comment">// TODO: Not sure whether the fallthrough was a mistake (forgetting a break) or intended. This should be double-checked.</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba0a134bc75d430da10f6c1df4977c29cf">SPELLFAMILY_WARLOCK</a>:</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                <span class="keywordflow">if</span> (!caster)</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a30452de2bd62607418f3962d00124144">SpellFamilyFlags</a>[1] &amp; 0x00000400)</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                {</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* aurEff = caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a520e229dc1a93ea4a53d0ba81e586d11">GetAuraEffect</a>(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a66cca11731d68512cb0bb652cb1e7caf">SPELL_AURA_DUMMY</a>, <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba0a134bc75d430da10f6c1df4977c29cf">SPELLFAMILY_WARLOCK</a>, 98, 0))</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                    {</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                        <a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> spellId = 0;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                        <span class="keywordflow">switch</span> (aurEff-&gt;GetId())</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                        {</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                            <span class="keywordflow">case</span> 53759:</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                                spellId = 60947;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                            <span class="keywordflow">case</span> 53754:</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                                spellId = 60946;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                                <a class="code" href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a43832e3fa8508deb4ce43e520005fcd9">LOG_ERROR</a>(<span class="stringliteral">&quot;spells.aura&quot;</span>, <span class="stringliteral">&quot;Aura::HandleAuraSpecificMods: Unknown rank of Improved Fear (%d) found&quot;</span>, aurEff-&gt;GetId());</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                        }</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                        <span class="keywordflow">if</span> (spellId)</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;                            caster-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, spellId, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                    }</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                }</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba04f59ec569a753b4e47a0a230782f207">SPELLFAMILY_PRIEST</a>:</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                <span class="keywordflow">if</span> (!caster)</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                <span class="comment">// Shadow word: Pain // Vampiric Touch</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                <span class="keywordflow">if</span> (removeMode == <a class="code" href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94aa40c81252e354a16d6f036827c872e12">AURA_REMOVE_BY_ENEMY_SPELL</a> &amp;&amp; (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellFamilyFlags[0] &amp; 0x00008000 || <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellFamilyFlags[1] &amp; 0x00000400))</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                {</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;                    <span class="comment">// Shadow Affinity</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a> <span class="keyword">const</span>* aurEff = caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a8ef92f1d3a61f9fb2c8c24323d5d24af">GetDummyAuraEffect</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba04f59ec569a753b4e47a0a230782f207">SPELLFAMILY_PRIEST</a>, 178, 1))</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;                    {</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                        <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> basepoints0 = aurEff-&gt;GetAmount() * caster-&gt;<a class="code" href="../../da/db7/class_unit.html#ae0ca62842bea9e94497c0200b37891d8">GetCreateMana</a>() / 100;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                        caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a51ec81e114bf82a2485ba9f66200afd2">CastCustomSpell</a>(caster, 64103, &amp;basepoints0, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">true</span>, <span class="keyword">nullptr</span>, <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0));</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                    }</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                }</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                <span class="comment">// Power word: shield</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (removeMode == <a class="code" href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94aa40c81252e354a16d6f036827c872e12">AURA_REMOVE_BY_ENEMY_SPELL</a> &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellFamilyFlags[0] &amp; 0x00000001)</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                {</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                    <span class="comment">// Rapture</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html">Aura</a> <span class="keyword">const</span>* aura = caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a1b5426ed0a821b78377faac8113796b1">GetAuraOfRankedSpell</a>(47535))</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                    {</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                        <span class="comment">// check cooldown</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                        <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="../../d8/d83/class_object.html#a621a345fc34deed6d3a4e1e498a652da">GetTypeId</a>() == <a class="code" href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                        {</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                            <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="../../d8/d83/class_object.html#ae635434021784608b659501867538c87">ToPlayer</a>()-&gt;<a class="code" href="../../d8/d53/class_player.html#a6b5d9a18a5a03f4e55b7ff90479acee9">HasSpellCooldown</a>(aura-&gt;GetId()))</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                            {</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                                <span class="comment">// This additional check is needed to add a minimal delay before cooldown in in effect</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                                <span class="comment">// to allow all bubbles broken by a single damage source proc mana return</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;                                <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="../../d8/d83/class_object.html#ae635434021784608b659501867538c87">ToPlayer</a>()-&gt;<a class="code" href="../../d8/d53/class_player.html#ac1da2650933e6311dc3c26416ae70c9c">GetSpellCooldownDelay</a>(aura-&gt;GetId()) &lt;= 11500)</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                            }</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;                            <span class="keywordflow">else</span>    <span class="comment">// and add if needed</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                                caster-&gt;<a class="code" href="../../d8/d83/class_object.html#ae635434021784608b659501867538c87">ToPlayer</a>()-&gt;<a class="code" href="../../d8/d53/class_player.html#a8b94883b20744d45b498bb1ae292083d">AddSpellCooldown</a>(aura-&gt;GetId(), 0, 12 * <a class="code" href="../../d1/d8b/src_2common_2common_8h.html#a84190f79c8167211609f67284e066c58">IN_MILLISECONDS</a>);</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                        }</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160; </div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                        <span class="comment">// effect on caster</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a> <span class="keyword">const</span>* aurEff = aura-&gt;GetEffect(0))</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                        {</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                            <span class="keywordtype">float</span> multiplier = (float)aurEff-&gt;GetAmount();</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                            <span class="keywordflow">if</span> (aurEff-&gt;GetId() == 47535)</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                                multiplier -= 0.5f;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (aurEff-&gt;GetId() == 47537)</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                                multiplier += 0.5f;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160; </div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                            <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> basepoints0 = <a class="code" href="../../df/de2/namespace_g3_d.html#af80d9dbc6fa48c9ff714c7158adb60ae">int32</a>(<a class="code" href="../../d9/de9/src_2common_2_utilities_2util_8h.html#ae00607f8188c59ffcea5a3997c0120b0">CalculatePct</a>(caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a93f83fd909310de2c76382d00d7dbbf1">GetMaxPower</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#a17e15fab4b89f4840e745f31ca76a414ab3e4f73d6494c917b99431bae75a4d5f">POWER_MANA</a>), multiplier));</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                            caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a51ec81e114bf82a2485ba9f66200afd2">CastCustomSpell</a>(caster, 47755, &amp;basepoints0, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                        }</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                        <span class="comment">// effect on aura target</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a> <span class="keyword">const</span>* aurEff = aura-&gt;GetEffect(1))</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                        {</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                            <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d65/src_2common_2_utilities_2_random_8h.html#a50320d4edff86db31b25138ae72161ad">roll_chance_i</a>(aurEff-&gt;GetAmount()))</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160; </div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                            <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> triggeredSpellId = 0;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                            <span class="keywordflow">switch</span> (target-&gt;<a class="code" href="../../da/db7/class_unit.html#ad44d31430fab9282a79e8682822ccd9c">getPowerType</a>())</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                            {</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                                <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a17e15fab4b89f4840e745f31ca76a414ab3e4f73d6494c917b99431bae75a4d5f">POWER_MANA</a>:</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                                    {</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                                        <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> basepoints0 = <a class="code" href="../../df/de2/namespace_g3_d.html#af80d9dbc6fa48c9ff714c7158adb60ae">int32</a>(<a class="code" href="../../d9/de9/src_2common_2_utilities_2util_8h.html#ae00607f8188c59ffcea5a3997c0120b0">CalculatePct</a>(target-&gt;<a class="code" href="../../da/db7/class_unit.html#a93f83fd909310de2c76382d00d7dbbf1">GetMaxPower</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#a17e15fab4b89f4840e745f31ca76a414ab3e4f73d6494c917b99431bae75a4d5f">POWER_MANA</a>), 2));</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                                        caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a51ec81e114bf82a2485ba9f66200afd2">CastCustomSpell</a>(target, 63654, &amp;basepoints0, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                                    }</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                                <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a17e15fab4b89f4840e745f31ca76a414a1b514bf3a42e9a5dc4271bd25b7dce7e">POWER_RAGE</a>:</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                                    triggeredSpellId = 63653;</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                                <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a17e15fab4b89f4840e745f31ca76a414a535f3e3322566811e43bef82808b5288">POWER_ENERGY</a>:</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                                    triggeredSpellId = (!target-&gt;<a class="code" href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">HasAura</a>(70405) ? 63655 : 0);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                                <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a17e15fab4b89f4840e745f31ca76a414a4c504424e60c95f01e0ec1468a52d221">POWER_RUNIC_POWER</a>:</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                                    triggeredSpellId = 63652;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                            }</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;                            <span class="keywordflow">if</span> (triggeredSpellId)</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                                caster-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, triggeredSpellId, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                        }</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                    }</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                }</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;                <span class="keywordflow">switch</span> (<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>())</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                {</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                    <span class="keywordflow">case</span> 47788: <span class="comment">// Guardian Spirit</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                        <span class="keywordflow">if</span> (removeMode != <a class="code" href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94a9ca05b22853d12d44ac7e80a9e864a10">AURA_REMOVE_BY_EXPIRE</a>)</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                        <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="../../d8/d83/class_object.html#a621a345fc34deed6d3a4e1e498a652da">GetTypeId</a>() != <a class="code" href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160; </div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                        <a class="code" href="../../d8/d53/class_player.html">Player</a>* player = caster-&gt;<a class="code" href="../../d8/d83/class_object.html#ae635434021784608b659501867538c87">ToPlayer</a>();</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                        <span class="comment">// Glyph of Guardian Spirit</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* aurEff = player-&gt;<a class="code" href="../../da/db7/class_unit.html#a520e229dc1a93ea4a53d0ba81e586d11">GetAuraEffect</a>(63231, 0))</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                        {</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                            <span class="keywordflow">if</span> (!player-&gt;<a class="code" href="../../d8/d53/class_player.html#a6b5d9a18a5a03f4e55b7ff90479acee9">HasSpellCooldown</a>(47788))</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160; </div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                            player-&gt;<a class="code" href="../../d8/d53/class_player.html#a8b94883b20744d45b498bb1ae292083d">AddSpellCooldown</a>(<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a49bc14059c2bd3785231c52e0d54d382">Id</a>, 0, aurEff-&gt;GetAmount()*<a class="code" href="../../d1/d8b/src_2common_2common_8h.html#a84190f79c8167211609f67284e066c58">IN_MILLISECONDS</a>);</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160; </div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;                            <a class="code" href="../../d6/d1a/class_world_packet.html">WorldPacket</a> <a class="code" href="../../df/dea/structdata.html">data</a>(<a class="code" href="../../d2/dec/group__u2w.html#gga1073b6abb3a749f18bf1633020879e9ba5fec169c1f6ef708fd7217f7dcba3a31">SMSG_MODIFY_COOLDOWN</a>, 4 + 8 + 4);</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                            <a class="code" href="../../df/dea/structdata.html">data</a> &lt;&lt; <a class="code" href="../../df/de2/namespace_g3_d.html#ae911b90657d7162d47997c702af655a8">uint32</a>(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>());                  <span class="comment">// Spell ID</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                            <a class="code" href="../../df/dea/structdata.html">data</a> &lt;&lt; player-&gt;<a class="code" href="../../d8/d83/class_object.html#ad23b997e2442fa6a6228ba73a7ecc138">GetGUID</a>();                <span class="comment">// Player GUID</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                            <a class="code" href="../../df/dea/structdata.html">data</a> &lt;&lt; <a class="code" href="../../df/de2/namespace_g3_d.html#af80d9dbc6fa48c9ff714c7158adb60ae">int32</a>(-110000);                   <span class="comment">// Cooldown mod in milliseconds</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                            player-&gt;<a class="code" href="../../d8/d53/class_player.html#a37cb2ab58a7a8481ff23a57e7730e066">SendDirectMessage</a>(&amp;<a class="code" href="../../df/dea/structdata.html">data</a>);</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                        }</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                }</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba9160b2e3a87a908af25c9a594295c0c1">SPELLFAMILY_ROGUE</a>:</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;                {</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                    <span class="comment">// Overkill, Master of Subtlety</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;                    <span class="keywordflow">if</span> (caster &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellIconID == 250)</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                    {</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                        <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a8ef92f1d3a61f9fb2c8c24323d5d24af">GetDummyAuraEffect</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba9160b2e3a87a908af25c9a594295c0c1">SPELLFAMILY_ROGUE</a>, 2114, 0))</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                            caster-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(caster, 31666, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160; </div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                        <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a73f40bd61fe24bcead25d6ab3b9efc25">GetAuraEffectDummy</a>(58426))</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                            caster-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(caster, 58428, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                    }</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                    <span class="comment">// Remove Vanish on stealth remove</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>() == 1784)</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                        target-&gt;<a class="code" href="../../da/db7/class_unit.html#a1560f8912954788c900cab1bfa57ea76">RemoveAurasWithFamily</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba9160b2e3a87a908af25c9a594295c0c1">SPELLFAMILY_ROGUE</a>, 0x800, 0, 0, <a class="code" href="../../d8/d03/class_object_guid.html#a14039d3f3df79203693f713495503165">ObjectGuid::Empty</a>);</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                }</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160; </div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1badc34b27f2cd523716d80c51d4e1d6f02">SPELLFAMILY_DEATHKNIGHT</a>:</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                <span class="comment">// Blood of the North</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                <span class="comment">// Reaping</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                <span class="comment">// Death Rune Mastery</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellIconID == 3041 || <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellIconID == 22 || <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellIconID == 2622)</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                {</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0) || <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0)-&gt;GetAuraType() != <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799add498157825d0faca2c013bbcdfbae56">SPELL_AURA_PERIODIC_DUMMY</a>)</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="../../d8/d83/class_object.html#a621a345fc34deed6d3a4e1e498a652da">GetTypeId</a>() != <a class="code" href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="../../d8/d83/class_object.html#ae635434021784608b659501867538c87">ToPlayer</a>()-&gt;<a class="code" href="../../da/db7/class_unit.html#a58a507ebe628930b8a506144b364d84b">getClass</a>() != <a class="code" href="../../df/d0b/_shared_defines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa7f7b30426fd386c181799196c1739058">CLASS_DEATH_KNIGHT</a>)</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160; </div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                    <span class="comment">// aura removed - remove death runes</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                    target-&gt;<a class="code" href="../../d8/d83/class_object.html#ae635434021784608b659501867538c87">ToPlayer</a>()-&gt;<a class="code" href="../../d8/d53/class_player.html#a0d99907a41953dfe2e4589a785503fc1">RemoveRunesByAuraEffect</a>(<a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0));</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                }</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba573f9ad8924e7632156291378448e742">SPELLFAMILY_PALADIN</a>:</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                <span class="comment">// Remove the immunity shield marker on Forbearance removal if AW marker is not present</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>() == 25771 &amp;&amp; target-&gt;<a class="code" href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">HasAura</a>(61988) &amp;&amp; !target-&gt;<a class="code" href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">HasAura</a>(61987))</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;                    target-&gt;<a class="code" href="../../da/db7/class_unit.html#a1be09c524dfdd2c3538f2ae977c58399">RemoveAura</a>(61988);</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba66df9b34a3b922a8242d3dfb74494026">SPELLFAMILY_HUNTER</a>:</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                <span class="comment">// Glyph of Freezing Trap</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellFamilyFlags[0] &amp; 0x00000008) &amp;&amp; caster &amp;&amp; caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">HasAura</a>(56845))</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;                {</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                    target-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, 61394, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;                }</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;        }</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    }</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160; </div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="comment">// mods at aura apply or remove</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;SpellFamilyName)</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    {</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba66df9b34a3b922a8242d3dfb74494026">SPELLFAMILY_HUNTER</a>:</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;            <span class="keywordflow">switch</span> (<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>())</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;            {</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                <span class="keywordflow">case</span> 19574: <span class="comment">// Bestial Wrath</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                    <span class="comment">// The Beast Within cast on owner if talent present</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../da/db7/class_unit.html">Unit</a>* owner = target-&gt;<a class="code" href="../../da/db7/class_unit.html#a16a73fea59a6ef3595093aa29225b37b">GetOwner</a>())</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                    {</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                        <span class="comment">// Search talent</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                        <span class="keywordflow">if</span> (owner-&gt;HasAura(34692))</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                        {</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a>)</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                                owner-&gt;CastSpell(owner, 34471, <span class="keyword">true</span>, 0, <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(0));</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                                owner-&gt;RemoveAurasDueToSpell(34471);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                        }</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                    }</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;            }</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba573f9ad8924e7632156291378448e742">SPELLFAMILY_PALADIN</a>:</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;            <span class="keywordflow">switch</span> (<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>())</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;            {</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                <span class="keywordflow">case</span> 19746:</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                <span class="keywordflow">case</span> 31821:</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                    <span class="comment">// Aura Mastery Triggered Spell Handler</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                    <span class="comment">// If apply Concentration Aura -&gt; trigger -&gt; apply Aura Mastery Immunity</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                    <span class="comment">// If remove Concentration Aura -&gt; trigger -&gt; remove Aura Mastery Immunity</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                    <span class="comment">// If remove Aura Mastery -&gt; trigger -&gt; remove Aura Mastery Immunity</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                    <span class="comment">// Do effects only on aura owner</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a3c4dfe75dad16fbf2afaf23ce77e4262">GetCasterGUID</a>() != target-&gt;<a class="code" href="../../d8/d83/class_object.html#ad23b997e2442fa6a6228ba73a7ecc138">GetGUID</a>())</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a>)</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                    {</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                        <span class="keywordflow">if</span> ((<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;Id == 31821 &amp;&amp; target-&gt;<a class="code" href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">HasAura</a>(19746, <a class="code" href="../../d2/dde/class_aura.html#a3c4dfe75dad16fbf2afaf23ce77e4262">GetCasterGUID</a>())) || (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;Id == 19746 &amp;&amp; target-&gt;<a class="code" href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">HasAura</a>(31821)))</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                            target-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, 64364, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                    }</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;                        target-&gt;<a class="code" href="../../da/db7/class_unit.html#aac612f06e84142d92dcfc432b5feb4ac">RemoveAurasDueToSpell</a>(64364, <a class="code" href="../../d2/dde/class_aura.html#a3c4dfe75dad16fbf2afaf23ce77e4262">GetCasterGUID</a>());</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                <span class="keywordflow">case</span> 31842:</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                    <span class="keywordflow">if</span> (caster &amp;&amp; caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">HasAura</a>(70755))</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                    {</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a>)</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                            target-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, 71166, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                            target-&gt;<a class="code" href="../../da/db7/class_unit.html#aac612f06e84142d92dcfc432b5feb4ac">RemoveAurasDueToSpell</a>(71166);</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                    }</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;            }</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160; </div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;            <span class="comment">// Sanctified Retribution, Improved Devotion Aura, Swift Retribution, Improved Concentration Aura</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;            <span class="keywordflow">if</span> (caster == target &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;GetSpellSpecific() == <a class="code" href="../../dc/d70/_spell_info_8h.html#a967f80d0c19acebc2e322c73b7b16442a8b31c1d8a369ac3bfa30c9e5b9b10ffa">SPELL_SPECIFIC_AURA</a>)</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;            {</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">apply</a>)</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;                {</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;                    target-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, 63510, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;                    target-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, 63514, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                    target-&gt;<a class="code" href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">CastSpell</a>(target, 63531, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;                }</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;                {</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;                    target-&gt;<a class="code" href="../../da/db7/class_unit.html#a1be09c524dfdd2c3538f2ae977c58399">RemoveAura</a>(63510);</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;                    target-&gt;<a class="code" href="../../da/db7/class_unit.html#a1be09c524dfdd2c3538f2ae977c58399">RemoveAura</a>(63514);</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;                    target-&gt;<a class="code" href="../../da/db7/class_unit.html#a1be09c524dfdd2c3538f2ae977c58399">RemoveAura</a>(63531);</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                }</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;            }</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    }</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;}</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160; </div>
<div class="line"><a name="l01892"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#ac2ee53cb584c3528f2990d391393bc1d"> 1892</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#ac2ee53cb584c3528f2990d391393bc1d">Aura::CanBeAppliedOn</a>(<a class="code" href="../../da/db7/class_unit.html">Unit</a>* target)</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;{</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="comment">// unit not in world or during remove from world</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="../../d8/d83/class_object.html#a3aeab7def818ba6c50249f197ad2f9ca">IsInWorld</a>() || target-&gt;<a class="code" href="../../da/db7/class_unit.html#a7b8654ccb16f3b1e7be4d93d74a304ba">IsDuringRemoveFromWorld</a>())</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    {</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;        <span class="comment">// area auras mustn&#39;t be applied</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>() != target)</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        <span class="comment">// not selfcasted single target auras mustn&#39;t be applied</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a3c4dfe75dad16fbf2afaf23ce77e4262">GetCasterGUID</a>() != <a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>()-&gt;GetGUID() &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d2/dde/class_aura.html#afb782970ace7a9385038481911d388fc">IsSingleTarget</a>())</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    }</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d2/dde/class_aura.html#a139193e2e2688d6ea9c6a817c0a00318">CheckAreaTarget</a>(target);</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;}</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160; </div>
<div class="line"><a name="l01909"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a139193e2e2688d6ea9c6a817c0a00318"> 1909</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a139193e2e2688d6ea9c6a817c0a00318">Aura::CheckAreaTarget</a>(<a class="code" href="../../da/db7/class_unit.html">Unit</a>* target)</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;{</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/dde/class_aura.html#a3666518caf5cf301c27857b2e909cf16">CallScriptCheckAreaTargetHandlers</a>(target);</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;}</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160; </div>
<div class="line"><a name="l01914"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#ac4544d5fa6bb4171de4fccdad5e96918"> 1914</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#ac4544d5fa6bb4171de4fccdad5e96918">Aura::IsAuraStronger</a>(<a class="code" href="../../d2/dde/class_aura.html">Aura</a> <span class="keyword">const</span>* newAura)<span class="keyword"> const</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = <a class="code" href="../../df/d0b/_shared_defines_8h.html#a0b4a3c2c7210e88f82b3dc3abb6e6f77ae36fda04a2c1fff26525d0c57f79a36d">EFFECT_0</a>; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    {</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;        <a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* thisEffect = <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(i);</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;        <span class="keywordflow">if</span> (!thisEffect)</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160; </div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;        <a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* newEffect = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> j = <a class="code" href="../../df/d0b/_shared_defines_8h.html#a0b4a3c2c7210e88f82b3dc3abb6e6f77ae36fda04a2c1fff26525d0c57f79a36d">EFFECT_0</a>; j &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++j)</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        {</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;            newEffect = newAura-&gt;<a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(j);</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;            <span class="keywordflow">if</span> (!newEffect || thisEffect-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a120cf8a45a3c816e4ef588733fa812e5">GetAuraType</a>() != newEffect-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#a120cf8a45a3c816e4ef588733fa812e5">GetAuraType</a>() || thisEffect-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#aa183791665930afb43bbac2163b1d8d4">GetMiscValue</a>() != newEffect-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#aa183791665930afb43bbac2163b1d8d4">GetMiscValue</a>())</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160; </div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;            <span class="comment">// xinef: assume that all spells are either positive or negative, otherwise they should not be in one group</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;            <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> curValue = <a class="code" href="../../d0/d45/_matrix_8h.html#aaf9f9f8a87c718439346b4e96107f5e9">abs</a>(thisEffect-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#afcf272bebf373ad3aebc03cce644cbee">GetAmount</a>());</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;            <span class="keywordflow">if</span> (curValue &lt; <a class="code" href="../../d0/d45/_matrix_8h.html#aaf9f9f8a87c718439346b4e96107f5e9">abs</a>(newEffect-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#afcf272bebf373ad3aebc03cce644cbee">GetAmount</a>()))</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160; </div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            <span class="keywordflow">if</span> (curValue == <a class="code" href="../../d0/d45/_matrix_8h.html#aaf9f9f8a87c718439346b4e96107f5e9">abs</a>(newEffect-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#afcf272bebf373ad3aebc03cce644cbee">GetAmount</a>()))</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                <span class="keywordflow">if</span>(!<a class="code" href="../../d2/dde/class_aura.html#ae24c050668e78ef9d8728e6b5bd77c12">IsPassive</a>() &amp;&amp; !<a class="code" href="../../d2/dde/class_aura.html#af70f37c9e40b7038cf952c2969ae9ab2">IsPermanent</a>() &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a5e79eaa33b5f9ae5aaa44a62d096d6fe">GetDuration</a>() &lt; newAura-&gt;<a class="code" href="../../d2/dde/class_aura.html#a5e79eaa33b5f9ae5aaa44a62d096d6fe">GetDuration</a>())</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        }</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    }</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160; </div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;}</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160; </div>
<div class="line"><a name="l01943"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a40cd6707c45eead445b1f487991da9c1"> 1943</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a40cd6707c45eead445b1f487991da9c1">Aura::CanStackWith</a>(<a class="code" href="../../d2/dde/class_aura.html">Aura</a> <span class="keyword">const</span>* existingAura, <span class="keywordtype">bool</span> remove)<span class="keyword"> const</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <span class="comment">// Can stack with self</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">this</span> == existingAura)</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160; </div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <a class="code" href="../../d4/d7d/class_spell_info.html">SpellInfo</a> <span class="keyword">const</span>* existingSpellInfo = existingAura-&gt;<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>();</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <span class="keywordtype">bool</span> sameCaster = <a class="code" href="../../d2/dde/class_aura.html#a3c4dfe75dad16fbf2afaf23ce77e4262">GetCasterGUID</a>() == existingAura-&gt;<a class="code" href="../../d2/dde/class_aura.html#a3c4dfe75dad16fbf2afaf23ce77e4262">GetCasterGUID</a>();</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160; </div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="comment">// Dynobj auras always stack</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="comment">// xinef: dont allow different ranks (or the same rank) of same spell to stack (many flamestrikes for example)</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <span class="keywordflow">if</span> (existingAura-&gt;<a class="code" href="../../d2/dde/class_aura.html#aaddb94cd3bd95b145a8b8392e9feecca">GetType</a>() == <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#ade4e7c2cbd17c45015f9f70c2a5400b2a51cd79314936d46d8bc738a8c1207ab4">DYNOBJ_AURA_TYPE</a>)</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    {</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;        <span class="comment">// xinef: desecration lag fix - bound this condition to periodics</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;        <span class="keywordflow">if</span> (sameCaster &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;Id == existingSpellInfo-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a49bc14059c2bd3785231c52e0d54d382">Id</a> &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;HasAura(<a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a11166673929d2fda5967add284832fad">SPELL_AURA_PERIODIC_DAMAGE</a>))</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    }</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160; </div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="comment">// passive auras don&#39;t stack with another rank of the spell cast by same caster</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#ae24c050668e78ef9d8728e6b5bd77c12">IsPassive</a>() &amp;&amp; sameCaster &amp;&amp; (<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#ac8da2514a9cabed9631f91779dcd623c">IsDifferentRankOf</a>(existingSpellInfo) || (<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a49bc14059c2bd3785231c52e0d54d382">Id</a> == existingSpellInfo-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a49bc14059c2bd3785231c52e0d54d382">Id</a> &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a742caadbfa7658d6957bf73eda7c624a">m_castItemGuid</a>.<a class="code" href="../../d8/d03/class_object_guid.html#a32695a11f47a244236e7bce277fcf3a8">IsEmpty</a>())))</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160; </div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    {</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        <span class="comment">// prevent remove triggering aura by triggered aura</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        <span class="keywordflow">if</span> (existingSpellInfo-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#aa5bb0d7d6df03526d011d9cbfa3734e0">Effects</a>[i].TriggerSpell == <a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>()</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;                <span class="comment">// prevent remove triggered aura by triggering aura refresh</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;                || <a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#aa5bb0d7d6df03526d011d9cbfa3734e0">Effects</a>[i].TriggerSpell == existingAura-&gt;<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>())</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    }</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160; </div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <span class="comment">// check spell specific stack rules</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a49b3ca759c4a7aaa0f97c01c9273e39b">IsAuraExclusiveBySpecificWith</a>(existingSpellInfo)</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;            || (sameCaster &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a3f193840a6704ec13ba08bbe39824737">IsAuraExclusiveBySpecificPerCasterWith</a>(existingSpellInfo)))</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160; </div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="comment">// check spell group stack rules</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    <span class="comment">// xinef: this assures us that both spells are in same group!</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <a class="code" href="../../d3/d75/_spell_mgr_8h.html#a3384f828e7f362dbdaecb22673641c88">SpellGroupStackFlags</a> stackFlags = <a class="code" href="../../d3/d75/_spell_mgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>-&gt;CheckSpellGroupStackRules(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>, existingSpellInfo, remove, <a class="code" href="../../d2/dde/class_aura.html#a13f14942fd6394df8e5d8ae820fd3fc7">IsArea</a>());</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    <span class="keywordflow">if</span> (stackFlags)</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    {</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        <span class="comment">// xinef: same caster rule is bounded by spellfamily</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        <span class="keywordflow">if</span> (sameCaster &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#af6ec577353f7d3cc59badd7d332153b0">SpellFamilyName</a> == existingSpellInfo-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#af6ec577353f7d3cc59badd7d332153b0">SpellFamilyName</a> &amp;&amp;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                (stackFlags &amp; <a class="code" href="../../d3/d75/_spell_mgr_8h.html#a3384f828e7f362dbdaecb22673641c88ab87195d8c88d548d93dc11460e7ebf6a">SPELL_GROUP_STACK_FLAG_NOT_SAME_CASTER</a>))</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160; </div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        <span class="comment">// xinef: normal exclusive stacking, remove if auras are equal by effects</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        <span class="keywordflow">if</span> (stackFlags &amp; <a class="code" href="../../d3/d75/_spell_mgr_8h.html#a3384f828e7f362dbdaecb22673641c88a3556b4b6eac1a9cc343a58851626cc35">SPELL_GROUP_STACK_FLAG_EXCLUSIVE</a>)</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;        {</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;IsAuraEffectEqual(existingSpellInfo) || <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;IsRankOf(existingSpellInfo))</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;            {</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;                <span class="keywordflow">if</span> (remove)</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="../../d2/dde/class_aura.html#ac4544d5fa6bb4171de4fccdad5e96918">IsAuraStronger</a>(existingAura);</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;                    <span class="keywordflow">return</span> existingAura-&gt;<a class="code" href="../../d2/dde/class_aura.html#ac4544d5fa6bb4171de4fccdad5e96918">IsAuraStronger</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;            }</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;        }</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160; </div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        <span class="comment">// xinef: check priority before effect mask</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        <a class="code" href="../../d3/d75/_spell_mgr_8h.html#ab9f8654c03ec40ac9bdc5214da99e1eb">SpellGroupSpecialFlags</a> thisAuraFlag = <a class="code" href="../../d3/d75/_spell_mgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>-&gt;GetSpellGroupSpecialFlags(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>());</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;        <a class="code" href="../../d3/d75/_spell_mgr_8h.html#ab9f8654c03ec40ac9bdc5214da99e1eb">SpellGroupSpecialFlags</a> existingAuraFlag = <a class="code" href="../../d3/d75/_spell_mgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>-&gt;GetSpellGroupSpecialFlags(existingSpellInfo-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a49bc14059c2bd3785231c52e0d54d382">Id</a>);</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        <span class="keywordflow">if</span> (thisAuraFlag &gt;= <a class="code" href="../../d3/d75/_spell_mgr_8h.html#ab9f8654c03ec40ac9bdc5214da99e1eba1241df11023c863e2de7d3371c703d76">SPELL_GROUP_SPECIAL_FLAG_PRIORITY1</a> &amp;&amp; existingAuraFlag &gt;= <a class="code" href="../../d3/d75/_spell_mgr_8h.html#ab9f8654c03ec40ac9bdc5214da99e1eba1241df11023c863e2de7d3371c703d76">SPELL_GROUP_SPECIAL_FLAG_PRIORITY1</a>)</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;            <span class="keywordflow">if</span> (thisAuraFlag &lt; existingAuraFlag)</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160; </div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        <span class="comment">// xinef: forced strongest aura in group by flag</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        <span class="keywordflow">if</span> (stackFlags &amp; <a class="code" href="../../d3/d75/_spell_mgr_8h.html#a3384f828e7f362dbdaecb22673641c88a657ce08869043f0b71ee8815c6fb869e">SPELL_GROUP_STACK_FLAG_FORCED_STRONGEST</a>)</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;            <span class="keywordflow">return</span> !remove;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        <span class="keywordflow">if</span> (stackFlags &amp; <a class="code" href="../../d3/d75/_spell_mgr_8h.html#a3384f828e7f362dbdaecb22673641c88a4cfbddea486e9940cbeb5ebdab267b3e">SPELL_GROUP_STACK_FLAG_FORCED_WEAKEST</a>)</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;            <span class="keywordflow">return</span> remove;</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160; </div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        <span class="comment">// xinef: forced return, handle all cases using available flags!</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;        <span class="keywordflow">return</span> !(stackFlags &amp; <a class="code" href="../../d3/d75/_spell_mgr_8h.html#a3384f828e7f362dbdaecb22673641c88adf0c38d0364b5e9c36aa3bf4f68da680">SPELL_GROUP_STACK_FLAG_NEVER_STACK</a>);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    }</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160; </div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#af6ec577353f7d3cc59badd7d332153b0">SpellFamilyName</a> != existingSpellInfo-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#af6ec577353f7d3cc59badd7d332153b0">SpellFamilyName</a>)</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160; </div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <span class="keywordflow">if</span> (!sameCaster)</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    {</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;        <span class="comment">// Channeled auras can stack if not forbidden by db or aura type</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;        <span class="keywordflow">if</span> (existingAura-&gt;<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a93b51808183b35049d7e5847acee0390">IsChanneled</a>())</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160; </div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a975746d6b737abb063ea037327abfc5a">HasAttribute</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#a6f95d0d447e8085b1097ac9965af2a81a47666e0aca649bbf39649d0214f4bc67">SPELL_ATTR3_DOT_STACKING_RULE</a>))</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160; </div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        <span class="comment">// check same periodic auras</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        {</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;            <span class="keywordflow">switch</span> (<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#aa5bb0d7d6df03526d011d9cbfa3734e0">Effects</a>[i].ApplyAuraName)</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;            {</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;                <span class="comment">// DOT or HOT from different casters will stack</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a11166673929d2fda5967add284832fad">SPELL_AURA_PERIODIC_DAMAGE</a>:</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799add498157825d0faca2c013bbcdfbae56">SPELL_AURA_PERIODIC_DUMMY</a>:</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a6442a4a379f82e2f08734296e1e21c9f">SPELL_AURA_PERIODIC_HEAL</a>:</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799af51e1877e096bbfd69505e5ab4fc69ad">SPELL_AURA_PERIODIC_TRIGGER_SPELL</a>:</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799ab9f377f6e107ad1633d32a22da2ec7d2">SPELL_AURA_PERIODIC_ENERGIZE</a>:</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a2eb3f6e6a49bc0b70fa9726b1fa12bb3">SPELL_AURA_PERIODIC_MANA_LEECH</a>:</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799ac84a600c9fc81cbda953c9f64074ab9f">SPELL_AURA_PERIODIC_LEECH</a>:</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799ad06611922c0cf903c24b220140daacab">SPELL_AURA_POWER_BURN</a>:</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a4f1feb3950d2776a74c938c366adbbdf">SPELL_AURA_OBS_MOD_POWER</a>:</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a2616d80ed4951b4ff860a0e0e2a98da0">SPELL_AURA_OBS_MOD_HEALTH</a>:</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799ab6c4d806c60e94fec189c27a7a205576">SPELL_AURA_PERIODIC_TRIGGER_SPELL_WITH_VALUE</a>:</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                    <span class="comment">// periodic auras which target areas are not allowed to stack this way (replenishment for example)</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#aa5bb0d7d6df03526d011d9cbfa3734e0">Effects</a>[i].IsTargetingArea() || existingSpellInfo-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#aa5bb0d7d6df03526d011d9cbfa3734e0">Effects</a>[i].IsTargetingArea())</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;            }</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;        }</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    }</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160; </div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> VehicleAura1 = 0;</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> VehicleAura2 = 0;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0;</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    <span class="keywordflow">while</span> (i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a> &amp;&amp; !(VehicleAura1 &amp;&amp; VehicleAura2))</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    {</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#aa5bb0d7d6df03526d011d9cbfa3734e0">Effects</a>[i].ApplyAuraName == <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a583bf7e94825b7252010ad12dd50ed6f">SPELL_AURA_CONTROL_VEHICLE</a>)</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;            VehicleAura1 = i + 1;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;        <span class="keywordflow">if</span> (existingSpellInfo-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#aa5bb0d7d6df03526d011d9cbfa3734e0">Effects</a>[i].ApplyAuraName == <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a583bf7e94825b7252010ad12dd50ed6f">SPELL_AURA_CONTROL_VEHICLE</a>)</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;            VehicleAura2 = i + 1;</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160; </div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;        ++i;</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    }</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160; </div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    <span class="keywordflow">if</span> (VehicleAura1 &amp;&amp; VehicleAura2)</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    {</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;        <a class="code" href="../../dd/df6/class_vehicle.html">Vehicle</a>* veh = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>()-&gt;<a class="code" href="../../d8/d83/class_object.html#ac7d5ffa5c25d3951457c9b0a3c90ce76">ToUnit</a>())</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;            veh = <a class="code" href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">GetOwner</a>()-&gt;<a class="code" href="../../d8/d83/class_object.html#ac7d5ffa5c25d3951457c9b0a3c90ce76">ToUnit</a>()-&gt;<a class="code" href="../../da/db7/class_unit.html#ab5bd7480bb38a756459b9626c50576b7">GetVehicleKit</a>();</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160; </div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;        <span class="keywordflow">if</span> (!veh)           <span class="comment">// We should probably just let it stack. Vehicle system will prevent undefined behaviour later</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; </div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;        <span class="comment">// xinef: allow direct auras to stack if there is no passenger in this slot</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* aurEff = <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(VehicleAura1 - 1))</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;            <span class="keywordflow">if</span> (aurEff-&gt;GetAmount() &gt; 0)</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                <span class="keywordflow">if</span> (!veh-&gt;<a class="code" href="../../dd/df6/class_vehicle.html#a250a3ae75407ecbf79d3235a9c56679f">GetPassenger</a>(aurEff-&gt;GetAmount() - 1))</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160; </div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        <span class="keywordflow">if</span> (!veh-&gt;<a class="code" href="../../dd/df6/class_vehicle.html#a1b4a880c866af98a9eccc944786e3393">GetAvailableSeatCount</a>())</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;   <span class="comment">// No empty seat available</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160; </div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;        <span class="comment">// Empty seat available (skip rest)</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    }</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160; </div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    <span class="comment">// spell of same spell rank chain</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a0a651a1cf655c9d5619f6b78e471656a">IsRankOf</a>(existingSpellInfo))</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    {</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;        <span class="comment">// don&#39;t allow passive area auras to stack</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a6c038b16dbe3eacfcdd424c6075b8f78">IsMultiSlotAura</a>() &amp;&amp; !<a class="code" href="../../d2/dde/class_aura.html#a13f14942fd6394df8e5d8ae820fd3fc7">IsArea</a>())</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#ab5641e8e175470f121e2c6eda7dfb253">GetCastItemGUID</a>() &amp;&amp; existingAura-&gt;<a class="code" href="../../d2/dde/class_aura.html#ab5641e8e175470f121e2c6eda7dfb253">GetCastItemGUID</a>())</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#ab5641e8e175470f121e2c6eda7dfb253">GetCastItemGUID</a>() != existingAura-&gt;<a class="code" href="../../d2/dde/class_aura.html#ab5641e8e175470f121e2c6eda7dfb253">GetCastItemGUID</a>() &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a975746d6b737abb063ea037327abfc5a">HasAttribute</a>(<a class="code" href="../../dc/d70/_spell_info_8h.html#a93795b2131c8cbe38a7b23768a5a146da23162f829e73ed8653b153a3e5212a39">SPELL_ATTR0_CU_ENCHANT_PROC</a>))</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;        <span class="comment">// same spell with same caster should not stack</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    }</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160; </div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;}</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160; </div>
<div class="line"><a name="l02108"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a9b82ca1499317e9a44b1315e16472d44"> 2108</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a9b82ca1499317e9a44b1315e16472d44">Aura::IsProcOnCooldown</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    <span class="comment">/*if (m_procCooldown)</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="comment">    {</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;<span class="comment">        if (m_procCooldown &gt; time(nullptr))</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="comment">            return true;</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;<span class="comment">    }*/</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;}</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160; </div>
<div class="line"><a name="l02118"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a1124c642995a40561d7fe23347f0dcdb"> 2118</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a1124c642995a40561d7fe23347f0dcdb">Aura::AddProcCooldown</a>(<a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <span class="comment">/*msec*/</span>)</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;{</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    <span class="comment">//m_procCooldown = time(nullptr) + msec;</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;}</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160; </div>
<div class="line"><a name="l02123"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#ace1f81adb69a07eddbdeee16bfe2ed33"> 2123</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#ace1f81adb69a07eddbdeee16bfe2ed33">Aura::PrepareProcToTrigger</a>(<a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a>* aurApp, <a class="code" href="../../df/def/class_proc_event_info.html">ProcEventInfo</a>&amp; eventInfo)</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;{</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    <span class="keywordtype">bool</span> prepare = <a class="code" href="../../d2/dde/class_aura.html#a6577a1543d871da43ab8b015f67d4150">CallScriptPrepareProcHandlers</a>(aurApp, eventInfo);</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    <span class="keywordflow">if</span> (!prepare)</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160; </div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="comment">// take one charge, aura expiration will be handled in Aura::TriggerProcOnEvent (if needed)</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a62c2b89c6a9269aba7870b36e5872330">IsUsingCharges</a>() &amp;&amp; (!eventInfo.<a class="code" href="../../df/def/class_proc_event_info.html#a759add2c89e786125196eb6bd3b20c6d">GetSpellInfo</a>() || !eventInfo.<a class="code" href="../../df/def/class_proc_event_info.html#a759add2c89e786125196eb6bd3b20c6d">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a975746d6b737abb063ea037327abfc5a">HasAttribute</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#afc0226d0611e178e6edb4d2776e03094a7e3a5efaeb82064d20232846d5e4437d">SPELL_ATTR6_DO_NOT_CONSUME_RESOURCES</a>)))</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    {</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        --<a class="code" href="../../d2/dde/class_aura.html#af32b9da81a73be723f660ae4e3363e74">m_procCharges</a>;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;        <a class="code" href="../../d2/dde/class_aura.html#a8f9f4a57e87c86b384b637403fff06e7">SetNeedClientUpdateForTargets</a>();</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    }</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160; </div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    <a class="code" href="../../d0/d79/struct_spell_proc_entry.html">SpellProcEntry</a> <span class="keyword">const</span>* procEntry = <a class="code" href="../../d3/d75/_spell_mgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>-&gt;GetSpellProcEntry(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>());</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160; </div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(procEntry);</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160; </div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    <span class="comment">// cooldowns should be added to the whole aura (see 51698 area aura)</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a1124c642995a40561d7fe23347f0dcdb">AddProcCooldown</a>(procEntry-&gt;<a class="code" href="../../d0/d79/struct_spell_proc_entry.html#a027db1efff77802e06a96f7464fc50d3">cooldown</a>);</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;}</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160; </div>
<div class="line"><a name="l02144"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#ac514e08ac3f8733a650d243239dada58"> 2144</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#ac514e08ac3f8733a650d243239dada58">Aura::IsProcTriggeredOnEvent</a>(<a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a>* aurApp, <a class="code" href="../../df/def/class_proc_event_info.html">ProcEventInfo</a>&amp; eventInfo)<span class="keyword"> const</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    <a class="code" href="../../d0/d79/struct_spell_proc_entry.html">SpellProcEntry</a> <span class="keyword">const</span>* procEntry = <a class="code" href="../../d3/d75/_spell_mgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>-&gt;GetSpellProcEntry(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>());</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    <span class="comment">// only auras with spell proc entry can trigger proc</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="keywordflow">if</span> (!procEntry)</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160; </div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    <span class="comment">// check if we have charges to proc with</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a62c2b89c6a9269aba7870b36e5872330">IsUsingCharges</a>() &amp;&amp; !<a class="code" href="../../d2/dde/class_aura.html#ab07705be94c0c10fce558c80d7208e0b">GetCharges</a>())</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160; </div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    <span class="comment">// check proc cooldown</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a9b82ca1499317e9a44b1315e16472d44">IsProcOnCooldown</a>())</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160; </div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    <span class="comment">// TODO:</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <span class="comment">// something about triggered spells triggering, and add extra attack effect</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160; </div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="comment">// do checks against db data</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d75/_spell_mgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>-&gt;CanSpellTriggerProcOnEvent(*procEntry, eventInfo))</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160; </div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    <span class="comment">// do checks using conditions table</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    <a class="code" href="../../d0/d62/_condition_mgr_8h.html#ae942a8e25dc24ce42e62625bb583c0dd">ConditionList</a> conditions = <a class="code" href="../../d0/d62/_condition_mgr_8h.html#a5ab0412c3dc24dbd690ba6d7f01657f8">sConditionMgr</a>-&gt;GetConditionsForNotGroupedEntry(<a class="code" href="../../d0/d62/_condition_mgr_8h.html#a5ba040e3c1f6efbefb512efb9bd69a7faf346b42db2a33729fa82322e5b422843">CONDITION_SOURCE_TYPE_SPELL_PROC</a>, <a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>());</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    <a class="code" href="../../df/dab/struct_condition_source_info.html">ConditionSourceInfo</a> condInfo = <a class="code" href="../../df/dab/struct_condition_source_info.html">ConditionSourceInfo</a>(eventInfo.<a class="code" href="../../df/def/class_proc_event_info.html#a958e2f1cabb9e39bc575504f9ca568df">GetActor</a>(), eventInfo.<a class="code" href="../../df/def/class_proc_event_info.html#ad63bc4856be234d9968568b04cdf636a">GetActionTarget</a>());</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d62/_condition_mgr_8h.html#a5ab0412c3dc24dbd690ba6d7f01657f8">sConditionMgr</a>-&gt;IsObjectMeetToConditions(condInfo, conditions))</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160; </div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <span class="comment">// AuraScript Hook</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <span class="keywordtype">bool</span> check = <span class="keyword">const_cast&lt;</span><a class="code" href="../../d2/dde/class_aura.html">Aura</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<a class="code" href="../../d2/dde/class_aura.html#a87be004e2c34b6652cd5350689b24dc3">CallScriptCheckProcHandlers</a>(aurApp, eventInfo);</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <span class="keywordflow">if</span> (!check)</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160; </div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    <span class="comment">// TODO:</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <span class="comment">// do allow additional requirements for procs</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    <span class="comment">// this is needed because this is the last moment in which you can prevent aura charge drop on proc</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    <span class="comment">// and possibly a way to prevent default checks (if there&#39;re going to be any)</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160; </div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <span class="comment">// Check if current equipment meets aura requirements</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <span class="comment">// do that only for passive spells</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <span class="comment">// TODO: this needs to be unified for all kinds of auras</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <a class="code" href="../../da/db7/class_unit.html">Unit</a>* target = aurApp-&gt;<a class="code" href="../../d8/da3/class_aura_application.html#a48f6d82daf06f6f2ced98484c2b56248">GetTarget</a>();</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#ae24c050668e78ef9d8728e6b5bd77c12">IsPassive</a>() &amp;&amp; target-&gt;<a class="code" href="../../d8/d83/class_object.html#a621a345fc34deed6d3a4e1e498a652da">GetTypeId</a>() == <a class="code" href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp; <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a6dc0b0fd741c87fae3faccea295b0616">EquippedItemClass</a> != -1)</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    {</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a975746d6b737abb063ea037327abfc5a">HasAttribute</a>(<a class="code" href="../../df/d0b/_shared_defines_8h.html#a6f95d0d447e8085b1097ac9965af2a81a4edf48bdff5870bc31c248bd4a299a17">SPELL_ATTR3_NO_PROC_EQUIP_REQUIREMENT</a>))</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        {</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;            <a class="code" href="../../dc/d32/class_item.html">Item</a>* item = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a6dc0b0fd741c87fae3faccea295b0616">EquippedItemClass</a> == <a class="code" href="../../d1/d9e/_item_template_8h.html#ab76605e05d3b13f61472b9a89cd22a68aeaefdfc527a31c7c733104c01368ac2a">ITEM_CLASS_WEAPON</a>)</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;            {</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                <span class="keywordflow">if</span> (target-&gt;<a class="code" href="../../d8/d83/class_object.html#ae635434021784608b659501867538c87">ToPlayer</a>()-&gt;<a class="code" href="../../da/db7/class_unit.html#abbc1994b31e8c2706a99c0d35269b89c">IsInFeralForm</a>())</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160; </div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d6/d2a/class_damage_info.html">DamageInfo</a> <span class="keyword">const</span>* damageInfo = eventInfo.<a class="code" href="../../df/def/class_proc_event_info.html#afb7b81b16f80f5a5dfea9b43347b4410">GetDamageInfo</a>())</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                {</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                    <span class="keywordflow">switch</span> (damageInfo-&gt;GetAttackType())</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                    {</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="../../d5/d32/_unit_8h.html#a2a35652af7129b6f139b0f7a2af1876aa5145c1138a6f21d47061e9015e07a3ae">BASE_ATTACK</a>:</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                            item = target-&gt;<a class="code" href="../../d8/d83/class_object.html#ae635434021784608b659501867538c87">ToPlayer</a>()-&gt;<a class="code" href="../../d8/d53/class_player.html#a51561ce856656946ba127e4f0b049a35">GetUseableItemByPos</a>(<a class="code" href="../../d1/d39/_player_8h.html#ad3dd8ed856e16139eaa67147d40cf24e">INVENTORY_SLOT_BAG_0</a>, <a class="code" href="../../d1/d39/_player_8h.html#a93b8041f948d575ef2d23746324a37afa559e9d51b0cff8ac6448c07e005a13bd">EQUIPMENT_SLOT_MAINHAND</a>);</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="../../d5/d32/_unit_8h.html#a2a35652af7129b6f139b0f7a2af1876aa052681ec165e5b5e3edcf2089607ae67">OFF_ATTACK</a>:</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;                            item = target-&gt;<a class="code" href="../../d8/d83/class_object.html#ae635434021784608b659501867538c87">ToPlayer</a>()-&gt;<a class="code" href="../../d8/d53/class_player.html#a51561ce856656946ba127e4f0b049a35">GetUseableItemByPos</a>(<a class="code" href="../../d1/d39/_player_8h.html#ad3dd8ed856e16139eaa67147d40cf24e">INVENTORY_SLOT_BAG_0</a>, <a class="code" href="../../d1/d39/_player_8h.html#a93b8041f948d575ef2d23746324a37afab44cb19f2d7a24d14ef74748716cd731">EQUIPMENT_SLOT_OFFHAND</a>);</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;                        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;                            item = target-&gt;<a class="code" href="../../d8/d83/class_object.html#ae635434021784608b659501867538c87">ToPlayer</a>()-&gt;<a class="code" href="../../d8/d53/class_player.html#a51561ce856656946ba127e4f0b049a35">GetUseableItemByPos</a>(<a class="code" href="../../d1/d39/_player_8h.html#ad3dd8ed856e16139eaa67147d40cf24e">INVENTORY_SLOT_BAG_0</a>, <a class="code" href="../../d1/d39/_player_8h.html#a93b8041f948d575ef2d23746324a37afafc73f33a54a6e48f474648a2ad5bd72a">EQUIPMENT_SLOT_RANGED</a>);</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                    }</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                }</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;            }</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a6dc0b0fd741c87fae3faccea295b0616">EquippedItemClass</a> == <a class="code" href="../../d1/d9e/_item_template_8h.html#ab76605e05d3b13f61472b9a89cd22a68acd2b804e85add83cfd65339c4a084f48">ITEM_CLASS_ARMOR</a>)</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            {</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                <span class="comment">// Check if player is wearing shield</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                item = target-&gt;<a class="code" href="../../d8/d83/class_object.html#ae635434021784608b659501867538c87">ToPlayer</a>()-&gt;<a class="code" href="../../d8/d53/class_player.html#a51561ce856656946ba127e4f0b049a35">GetUseableItemByPos</a>(<a class="code" href="../../d1/d39/_player_8h.html#ad3dd8ed856e16139eaa67147d40cf24e">INVENTORY_SLOT_BAG_0</a>, <a class="code" href="../../d1/d39/_player_8h.html#a93b8041f948d575ef2d23746324a37afab44cb19f2d7a24d14ef74748716cd731">EQUIPMENT_SLOT_OFFHAND</a>);</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;            }</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160; </div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;            <span class="keywordflow">if</span> (!item || item-&gt;<a class="code" href="../../dc/d32/class_item.html#a65aafded62a4c193fc631a1ed5c72f71">IsBroken</a>() || !item-&gt;<a class="code" href="../../dc/d32/class_item.html#af64f6b0baa8ab4ce263b60058af19196">IsFitToSpellRequirements</a>(<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()))</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;            {</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;            }</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        }</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    }</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160; </div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d1/d65/src_2common_2_utilities_2_random_8h.html#a4b15099bc81731469c5078a778673c94">roll_chance_f</a>(<a class="code" href="../../d2/dde/class_aura.html#aa515b9daf648d268f02ef974b3573550">CalcProcChance</a>(*procEntry, eventInfo));</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;}</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160; </div>
<div class="line"><a name="l02228"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#aa515b9daf648d268f02ef974b3573550"> 2228</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="../../d2/dde/class_aura.html#aa515b9daf648d268f02ef974b3573550">Aura::CalcProcChance</a>(<a class="code" href="../../d0/d79/struct_spell_proc_entry.html">SpellProcEntry</a> <span class="keyword">const</span>&amp; procEntry, <a class="code" href="../../df/def/class_proc_event_info.html">ProcEventInfo</a>&amp; eventInfo)<span class="keyword"> const</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    <span class="keywordtype">float</span> chance = procEntry.<a class="code" href="../../d0/d79/struct_spell_proc_entry.html#a267045b5891b545a1edd3d321f251d1c">chance</a>;</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    <span class="comment">// calculate chances depending on unit with caster&#39;s data</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;    <span class="comment">// so talents modifying chances and judgements will have properly calculated proc chance</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster = <a class="code" href="../../d2/dde/class_aura.html#a6fc52109b7711606f15d9880fda8f815">GetCaster</a>())</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    {</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;        <span class="comment">// calculate ppm chance if present and we&#39;re using weapon</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;        <span class="keywordflow">if</span> (eventInfo.<a class="code" href="../../df/def/class_proc_event_info.html#afb7b81b16f80f5a5dfea9b43347b4410">GetDamageInfo</a>() &amp;&amp; procEntry.<a class="code" href="../../d0/d79/struct_spell_proc_entry.html#a69f23fe7134391526d6f98ad32e6628a">ratePerMinute</a> != 0)</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;        {</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;            <a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> WeaponSpeed = caster-&gt;GetAttackTime(eventInfo.<a class="code" href="../../df/def/class_proc_event_info.html#afb7b81b16f80f5a5dfea9b43347b4410">GetDamageInfo</a>()-&gt;<a class="code" href="../../d6/d2a/class_damage_info.html#a8bf9edb2df92b0164ffc21a00c8925d6">GetAttackType</a>());</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;            chance = caster-&gt;GetPPMProcChance(WeaponSpeed, procEntry.<a class="code" href="../../d0/d79/struct_spell_proc_entry.html#a69f23fe7134391526d6f98ad32e6628a">ratePerMinute</a>, <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>());</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;        }</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;        <span class="comment">// apply chance modifer aura, applies also to ppm chance (see improved judgement of light spell)</span></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/d53/class_player.html">Player</a>* modOwner = caster-&gt;<a class="code" href="../../da/db7/class_unit.html#a2e6a98844f96c211f47b911a2766ada8">GetSpellModOwner</a>())</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;            modOwner-&gt;ApplySpellMod(<a class="code" href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">GetId</a>(), <a class="code" href="../../d5/d32/_unit_8h.html#a39b60e1f12cca9b6873cb817e7717351a0ed7ea54baf4ab31426eac33358a734b">SPELLMOD_CHANCE_OF_SUCCESS</a>, chance);</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    }</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    <span class="keywordflow">return</span> chance;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;}</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160; </div>
<div class="line"><a name="l02248"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#ab0d4d20bb3fac4108ba3dbc891d8dec9"> 2248</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#ab0d4d20bb3fac4108ba3dbc891d8dec9">Aura::TriggerProcOnEvent</a>(<a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a>* aurApp, <a class="code" href="../../df/def/class_proc_event_info.html">ProcEventInfo</a>&amp; eventInfo)</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;{</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a99d38e9baa13b6683db43d67757ec982">CallScriptProcHandlers</a>(aurApp, eventInfo);</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160; </div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> i = 0; i &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++i)</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;        <span class="keywordflow">if</span> (aurApp-&gt;<a class="code" href="../../d8/da3/class_aura_application.html#af3e44cda4fe299e5bf2ba8ca37142cba">HasEffect</a>(i))</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;            <span class="comment">// OnEffectProc / AfterEffectProc hooks handled in AuraEffect::HandleProc()</span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;            <a class="code" href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">GetEffect</a>(i)-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ad2a6d0a6fcbf6f5d53633e0d1ab10dd3">HandleProc</a>(aurApp, eventInfo);</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160; </div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a3bac8c34612850e65cd2411f2c7b6baa">CallScriptAfterProcHandlers</a>(aurApp, eventInfo);</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160; </div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <span class="comment">// Remove aura if we&#39;ve used last charge to proc</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a62c2b89c6a9269aba7870b36e5872330">IsUsingCharges</a>() &amp;&amp; !<a class="code" href="../../d2/dde/class_aura.html#ab07705be94c0c10fce558c80d7208e0b">GetCharges</a>())</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;        <a class="code" href="../../d2/dde/class_aura.html#af9799e5670c2bc3899e3430aa793ca20">Remove</a>();</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;}</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160; </div>
<div class="line"><a name="l02264"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#accc852560f7b56d60c77581365a3b17f"> 2264</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#accc852560f7b56d60c77581365a3b17f">Aura::_DeleteRemovedApplications</a>()</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;{</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    <span class="keywordflow">while</span> (!<a class="code" href="../../d2/dde/class_aura.html#a04a25715c9b268afa2025a47681df76c">m_removedApplications</a>.empty())</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    {</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;        <span class="keyword">delete</span> <a class="code" href="../../d2/dde/class_aura.html#a04a25715c9b268afa2025a47681df76c">m_removedApplications</a>.front();</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;        <a class="code" href="../../d2/dde/class_aura.html#a04a25715c9b268afa2025a47681df76c">m_removedApplications</a>.pop_front();</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    }</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;}</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160; </div>
<div class="line"><a name="l02273"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a9ed84a2b95a1cb898a682c809dd25d2b"> 2273</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a9ed84a2b95a1cb898a682c809dd25d2b">Aura::LoadScripts</a>()</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;{</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    <a class="code" href="../../d0/d7d/_script_mgr_8h.html#ae8161e629869974bc49b1cbfc73c1087">sScriptMgr</a>-&gt;CreateAuraScripts(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a49bc14059c2bd3785231c52e0d54d382">Id</a>, <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>);</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator itr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); itr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end();)</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;    {</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;        <span class="keywordflow">if</span> (!(*itr)-&gt;_Load(<span class="keyword">this</span>))</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;        {</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;            std::list&lt;AuraScript*&gt;::iterator bitr = itr;</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;            ++itr;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;            <span class="keyword">delete</span> (*bitr);</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;            <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.erase(bitr);</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;        }</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        <a class="code" href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a47ac782b14a7531c6232777165a1a161">LOG_DEBUG</a>(<span class="stringliteral">&quot;spells.aura&quot;</span>, <span class="stringliteral">&quot;Aura::LoadScripts: Script `%s` for aura `%u` is loaded now&quot;</span>, (*itr)-&gt;_GetScriptName()-&gt;c_str(), <a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#a49bc14059c2bd3785231c52e0d54d382">Id</a>);</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;        (*itr)-&gt;Register();</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        ++itr;</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    }</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;}</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160; </div>
<div class="line"><a name="l02292"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a3666518caf5cf301c27857b2e909cf16"> 2292</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a3666518caf5cf301c27857b2e909cf16">Aura::CallScriptCheckAreaTargetHandlers</a>(<a class="code" href="../../da/db7/class_unit.html">Unit</a>* target)</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;{</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../df/d60/namespacedetail_1_1digits.html#aad69d2373aa047bdd9e81494bf3da5ae">result</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    {</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a59cf037b8b521ba0958c29e7a8a4c262">AURA_SCRIPT_HOOK_CHECK_AREA_TARGET</a>);</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;        std::list&lt;AuraScript::CheckAreaTargetHandler&gt;::iterator hookItrEnd = (*scritr)-&gt;DoCheckAreaTarget.end(), hookItr = (*scritr)-&gt;DoCheckAreaTarget.begin();</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        <span class="keywordflow">for</span> (; hookItr != hookItrEnd; ++hookItr)</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;            <a class="code" href="../../df/d60/namespacedetail_1_1digits.html#aad69d2373aa047bdd9e81494bf3da5ae">result</a> &amp;= hookItr-&gt;Call(*scritr, target);</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160; </div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    }</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../df/d60/namespacedetail_1_1digits.html#aad69d2373aa047bdd9e81494bf3da5ae">result</a>;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;}</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160; </div>
<div class="line"><a name="l02307"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a1cb0ef5c31c0ebb5e274a99c186e83ab"> 2307</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a1cb0ef5c31c0ebb5e274a99c186e83ab">Aura::CallScriptDispel</a>(<a class="code" href="../../dc/de3/class_dispel_info.html">DispelInfo</a>* dispelInfo)</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;{</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    {</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a9c2d093615242927901d1c4c256212b2">AURA_SCRIPT_HOOK_DISPEL</a>);</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;        std::list&lt;AuraScript::AuraDispelHandler&gt;::iterator hookItrEnd = (*scritr)-&gt;OnDispel.end(), hookItr = (*scritr)-&gt;OnDispel.begin();</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;        <span class="keywordflow">for</span> (; hookItr != hookItrEnd; ++hookItr)</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;            hookItr-&gt;Call(*scritr, dispelInfo);</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160; </div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    }</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;}</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160; </div>
<div class="line"><a name="l02320"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#afa8b3462e2d68da5a9972c6cbd637022"> 2320</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#afa8b3462e2d68da5a9972c6cbd637022">Aura::CallScriptAfterDispel</a>(<a class="code" href="../../dc/de3/class_dispel_info.html">DispelInfo</a>* dispelInfo)</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;{</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    {</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236adc21054212f2fda577059533337ff63a">AURA_SCRIPT_HOOK_AFTER_DISPEL</a>);</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;        std::list&lt;AuraScript::AuraDispelHandler&gt;::iterator hookItrEnd = (*scritr)-&gt;AfterDispel.end(), hookItr = (*scritr)-&gt;AfterDispel.begin();</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;        <span class="keywordflow">for</span> (; hookItr != hookItrEnd; ++hookItr)</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;            hookItr-&gt;Call(*scritr, dispelInfo);</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160; </div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    }</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;}</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160; </div>
<div class="line"><a name="l02333"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a882f4ec3b0f104d3c18c718dc71ec668"> 2333</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a882f4ec3b0f104d3c18c718dc71ec668">Aura::CallScriptEffectApplyHandlers</a>(<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a> <span class="keyword">const</span>* aurEff, <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a> <span class="keyword">const</span>* aurApp, <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a82ebee9e3cf7eaf2ab892a6eb7796288">AuraEffectHandleModes</a> mode)</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;{</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    <span class="keywordtype">bool</span> preventDefault = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    {</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236aa70d783c590006f1a8cbf2b3d144e94c">AURA_SCRIPT_HOOK_EFFECT_APPLY</a>, aurApp);</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        std::list&lt;AuraScript::EffectApplyHandler&gt;::iterator effEndItr = (*scritr)-&gt;OnEffectApply.end(), effItr = (*scritr)-&gt;OnEffectApply.begin();</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        <span class="keywordflow">for</span> (; effItr != effEndItr; ++effItr)</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;            <span class="keywordflow">if</span> (effItr-&gt;IsEffectAffected(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>()))</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;                effItr-&gt;Call(*scritr, aurEff, mode);</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160; </div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;        <span class="keywordflow">if</span> (!preventDefault)</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;            preventDefault = (*scritr)-&gt;_IsDefaultActionPrevented();</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160; </div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    }</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160; </div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;    <span class="keywordflow">return</span> preventDefault;</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;}</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160; </div>
<div class="line"><a name="l02353"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a37a192c8e0119a8bc304c1711b15376e"> 2353</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a37a192c8e0119a8bc304c1711b15376e">Aura::CallScriptEffectRemoveHandlers</a>(<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a> <span class="keyword">const</span>* aurEff, <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a> <span class="keyword">const</span>* aurApp, <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a82ebee9e3cf7eaf2ab892a6eb7796288">AuraEffectHandleModes</a> mode)</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;{</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    <span class="keywordtype">bool</span> preventDefault = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    {</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a1794d2594c7b6dfe59a79a48aba6f142">AURA_SCRIPT_HOOK_EFFECT_REMOVE</a>, aurApp);</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;        std::list&lt;AuraScript::EffectApplyHandler&gt;::iterator effEndItr = (*scritr)-&gt;OnEffectRemove.end(), effItr = (*scritr)-&gt;OnEffectRemove.begin();</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;        <span class="keywordflow">for</span> (; effItr != effEndItr; ++effItr)</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;            <span class="keywordflow">if</span> (effItr-&gt;IsEffectAffected(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>()))</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;                effItr-&gt;Call(*scritr, aurEff, mode);</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160; </div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;        <span class="keywordflow">if</span> (!preventDefault)</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;            preventDefault = (*scritr)-&gt;_IsDefaultActionPrevented();</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160; </div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    }</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    <span class="keywordflow">return</span> preventDefault;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;}</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160; </div>
<div class="line"><a name="l02372"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a76282958056070ecbf58c7a864ea7494"> 2372</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a76282958056070ecbf58c7a864ea7494">Aura::CallScriptAfterEffectApplyHandlers</a>(<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a> <span class="keyword">const</span>* aurEff, <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a> <span class="keyword">const</span>* aurApp, <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a82ebee9e3cf7eaf2ab892a6eb7796288">AuraEffectHandleModes</a> mode)</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;{</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    {</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a3d296fe0adb2f6f3c0ae690ef48e0626">AURA_SCRIPT_HOOK_EFFECT_AFTER_APPLY</a>, aurApp);</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;        std::list&lt;AuraScript::EffectApplyHandler&gt;::iterator effEndItr = (*scritr)-&gt;AfterEffectApply.end(), effItr = (*scritr)-&gt;AfterEffectApply.begin();</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;        <span class="keywordflow">for</span> (; effItr != effEndItr; ++effItr)</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;            <span class="keywordflow">if</span> (effItr-&gt;IsEffectAffected(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>()))</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;                effItr-&gt;Call(*scritr, aurEff, mode);</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160; </div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;    }</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;}</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160; </div>
<div class="line"><a name="l02386"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a893e1bed86677e695a28d8eb4fab763d"> 2386</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a893e1bed86677e695a28d8eb4fab763d">Aura::CallScriptAfterEffectRemoveHandlers</a>(<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a> <span class="keyword">const</span>* aurEff, <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a> <span class="keyword">const</span>* aurApp, <a class="code" href="../../d7/d5a/_spell_aura_defines_8h.html#a82ebee9e3cf7eaf2ab892a6eb7796288">AuraEffectHandleModes</a> mode)</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;{</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    {</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a419d135d3d232ceabcb89fba6b5cc2b1">AURA_SCRIPT_HOOK_EFFECT_AFTER_REMOVE</a>, aurApp);</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;        std::list&lt;AuraScript::EffectApplyHandler&gt;::iterator effEndItr = (*scritr)-&gt;AfterEffectRemove.end(), effItr = (*scritr)-&gt;AfterEffectRemove.begin();</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;        <span class="keywordflow">for</span> (; effItr != effEndItr; ++effItr)</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;            <span class="keywordflow">if</span> (effItr-&gt;IsEffectAffected(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>()))</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;                effItr-&gt;Call(*scritr, aurEff, mode);</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160; </div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;    }</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;}</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160; </div>
<div class="line"><a name="l02400"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a3b0854e2019338fd16c9ca46e3997931"> 2400</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a3b0854e2019338fd16c9ca46e3997931">Aura::CallScriptEffectPeriodicHandlers</a>(<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a> <span class="keyword">const</span>* aurEff, <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a> <span class="keyword">const</span>* aurApp)</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;{</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    <span class="keywordtype">bool</span> preventDefault = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    {</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236aaf214dbb6995dfa6ae911fa471484b01">AURA_SCRIPT_HOOK_EFFECT_PERIODIC</a>, aurApp);</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;        std::list&lt;AuraScript::EffectPeriodicHandler&gt;::iterator effEndItr = (*scritr)-&gt;OnEffectPeriodic.end(), effItr = (*scritr)-&gt;OnEffectPeriodic.begin();</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;        <span class="keywordflow">for</span> (; effItr != effEndItr; ++effItr)</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;            <span class="keywordflow">if</span> (effItr-&gt;IsEffectAffected(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>()))</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;                effItr-&gt;Call(*scritr, aurEff);</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160; </div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;        <span class="keywordflow">if</span> (!preventDefault)</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;            preventDefault = (*scritr)-&gt;_IsDefaultActionPrevented();</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160; </div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    }</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160; </div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    <span class="keywordflow">return</span> preventDefault;</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;}</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160; </div>
<div class="line"><a name="l02420"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#adac81f948f034942046b45a94fea365f"> 2420</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#adac81f948f034942046b45a94fea365f">Aura::CallScriptEffectUpdatePeriodicHandlers</a>(<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* aurEff)</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;{</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    {</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236aef9114d2ad5df80081d2e5fce725a352">AURA_SCRIPT_HOOK_EFFECT_UPDATE_PERIODIC</a>);</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;        std::list&lt;AuraScript::EffectUpdatePeriodicHandler&gt;::iterator effEndItr = (*scritr)-&gt;OnEffectUpdatePeriodic.end(), effItr = (*scritr)-&gt;OnEffectUpdatePeriodic.begin();</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;        <span class="keywordflow">for</span> (; effItr != effEndItr; ++effItr)</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;            <span class="keywordflow">if</span> (effItr-&gt;IsEffectAffected(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>()))</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;                effItr-&gt;Call(*scritr, aurEff);</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160; </div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    }</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;}</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160; </div>
<div class="line"><a name="l02434"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a38c31b87dea32024c55f15d37faa93da"> 2434</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a38c31b87dea32024c55f15d37faa93da">Aura::CallScriptEffectCalcAmountHandlers</a>(<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a> <span class="keyword">const</span>* aurEff, <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>&amp; amount, <span class="keywordtype">bool</span>&amp; canBeRecalculated)</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;{</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    {</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a12c382920aa6890efbc36805fc32e25a">AURA_SCRIPT_HOOK_EFFECT_CALC_AMOUNT</a>);</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;        std::list&lt;AuraScript::EffectCalcAmountHandler&gt;::iterator effEndItr = (*scritr)-&gt;DoEffectCalcAmount.end(), effItr = (*scritr)-&gt;DoEffectCalcAmount.begin();</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;        <span class="keywordflow">for</span> (; effItr != effEndItr; ++effItr)</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;            <span class="keywordflow">if</span> (effItr-&gt;IsEffectAffected(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>()))</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;                effItr-&gt;Call(*scritr, aurEff, amount, canBeRecalculated);</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160; </div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    }</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;}</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160; </div>
<div class="line"><a name="l02448"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#abd4f379de7ed0890f28df1209aad70c7"> 2448</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#abd4f379de7ed0890f28df1209aad70c7">Aura::CallScriptEffectCalcPeriodicHandlers</a>(<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a> <span class="keyword">const</span>* aurEff, <span class="keywordtype">bool</span>&amp; isPeriodic, <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>&amp; amplitude)</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;{</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;    {</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a01bccb65044d0e5ccab470539e8a71a3">AURA_SCRIPT_HOOK_EFFECT_CALC_PERIODIC</a>);</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;        std::list&lt;AuraScript::EffectCalcPeriodicHandler&gt;::iterator effEndItr = (*scritr)-&gt;DoEffectCalcPeriodic.end(), effItr = (*scritr)-&gt;DoEffectCalcPeriodic.begin();</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;        <span class="keywordflow">for</span> (; effItr != effEndItr; ++effItr)</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;            <span class="keywordflow">if</span> (effItr-&gt;IsEffectAffected(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>()))</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;                effItr-&gt;Call(*scritr, aurEff, isPeriodic, amplitude);</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160; </div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    }</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;}</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160; </div>
<div class="line"><a name="l02462"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a205938814ca394a9a229f4b4e80e54a6"> 2462</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a205938814ca394a9a229f4b4e80e54a6">Aura::CallScriptEffectCalcSpellModHandlers</a>(<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a> <span class="keyword">const</span>* aurEff, <a class="code" href="../../d3/d39/struct_spell_modifier.html">SpellModifier</a>*&amp; spellMod)</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;{</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    {</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236ad09bca933a358610ff271989afdc2f9a">AURA_SCRIPT_HOOK_EFFECT_CALC_SPELLMOD</a>);</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;        std::list&lt;AuraScript::EffectCalcSpellModHandler&gt;::iterator effEndItr = (*scritr)-&gt;DoEffectCalcSpellMod.end(), effItr = (*scritr)-&gt;DoEffectCalcSpellMod.begin();</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;        <span class="keywordflow">for</span> (; effItr != effEndItr; ++effItr)</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;            <span class="keywordflow">if</span> (effItr-&gt;IsEffectAffected(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>()))</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;                effItr-&gt;Call(*scritr, aurEff, spellMod);</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160; </div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    }</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;}</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160; </div>
<div class="line"><a name="l02476"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a1734994c88d98ccd513b4f8d2f090d70"> 2476</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a1734994c88d98ccd513b4f8d2f090d70">Aura::CallScriptEffectAbsorbHandlers</a>(<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* aurEff, <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a> <span class="keyword">const</span>* aurApp, <a class="code" href="../../d6/d2a/class_damage_info.html">DamageInfo</a>&amp; dmgInfo, <a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&amp; absorbAmount, <span class="keywordtype">bool</span>&amp; defaultPrevented)</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;{</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    {</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236ac1dc8a3040268f42f5fbce32d51c71e3">AURA_SCRIPT_HOOK_EFFECT_ABSORB</a>, aurApp);</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;        std::list&lt;AuraScript::EffectAbsorbHandler&gt;::iterator effEndItr = (*scritr)-&gt;OnEffectAbsorb.end(), effItr = (*scritr)-&gt;OnEffectAbsorb.begin();</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;        <span class="keywordflow">for</span> (; effItr != effEndItr; ++effItr)</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160; </div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;            <span class="keywordflow">if</span> (effItr-&gt;IsEffectAffected(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>()))</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                effItr-&gt;Call(*scritr, aurEff, dmgInfo, absorbAmount);</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160; </div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;        <span class="keywordflow">if</span> (!defaultPrevented)</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;            defaultPrevented = (*scritr)-&gt;_IsDefaultActionPrevented();</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160; </div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    }</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;}</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160; </div>
<div class="line"><a name="l02494"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#aa5ebe6aa240ef26f1bfe4ac77240dd35"> 2494</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#aa5ebe6aa240ef26f1bfe4ac77240dd35">Aura::CallScriptEffectAfterAbsorbHandlers</a>(<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* aurEff, <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a> <span class="keyword">const</span>* aurApp, <a class="code" href="../../d6/d2a/class_damage_info.html">DamageInfo</a>&amp; dmgInfo, <a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&amp; absorbAmount)</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;{</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    {</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a9bab1f8dcc1dccde2a98e7f492c9d5a9">AURA_SCRIPT_HOOK_EFFECT_AFTER_ABSORB</a>, aurApp);</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;        std::list&lt;AuraScript::EffectAbsorbHandler&gt;::iterator effEndItr = (*scritr)-&gt;AfterEffectAbsorb.end(), effItr = (*scritr)-&gt;AfterEffectAbsorb.begin();</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;        <span class="keywordflow">for</span> (; effItr != effEndItr; ++effItr)</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;            <span class="keywordflow">if</span> (effItr-&gt;IsEffectAffected(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>()))</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                effItr-&gt;Call(*scritr, aurEff, dmgInfo, absorbAmount);</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160; </div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;    }</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;}</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160; </div>
<div class="line"><a name="l02508"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#aa75669dbdf619c939c3dc7fff9fe8736"> 2508</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#aa75669dbdf619c939c3dc7fff9fe8736">Aura::CallScriptEffectManaShieldHandlers</a>(<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* aurEff, <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a> <span class="keyword">const</span>* aurApp, <a class="code" href="../../d6/d2a/class_damage_info.html">DamageInfo</a>&amp; dmgInfo, <a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&amp; absorbAmount, <span class="keywordtype">bool</span>&amp; <span class="comment">/*defaultPrevented*/</span>)</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;{</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    {</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a67050daee69746f58a49b0f131a4a4de">AURA_SCRIPT_HOOK_EFFECT_MANASHIELD</a>, aurApp);</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;        std::list&lt;AuraScript::EffectManaShieldHandler&gt;::iterator effEndItr = (*scritr)-&gt;OnEffectManaShield.end(), effItr = (*scritr)-&gt;OnEffectManaShield.begin();</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;        <span class="keywordflow">for</span> (; effItr != effEndItr; ++effItr)</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;            <span class="keywordflow">if</span> (effItr-&gt;IsEffectAffected(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>()))</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;                effItr-&gt;Call(*scritr, aurEff, dmgInfo, absorbAmount);</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160; </div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    }</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;}</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160; </div>
<div class="line"><a name="l02522"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#af0236680754f81e374b015640e4b6eff"> 2522</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#af0236680754f81e374b015640e4b6eff">Aura::CallScriptEffectAfterManaShieldHandlers</a>(<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* aurEff, <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a> <span class="keyword">const</span>* aurApp, <a class="code" href="../../d6/d2a/class_damage_info.html">DamageInfo</a>&amp; dmgInfo, <a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&amp; absorbAmount)</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;{</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;    {</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a2ef312bd29f036eb8b15fedd4d2bc082">AURA_SCRIPT_HOOK_EFFECT_AFTER_MANASHIELD</a>, aurApp);</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;        std::list&lt;AuraScript::EffectManaShieldHandler&gt;::iterator effEndItr = (*scritr)-&gt;AfterEffectManaShield.end(), effItr = (*scritr)-&gt;AfterEffectManaShield.begin();</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;        <span class="keywordflow">for</span> (; effItr != effEndItr; ++effItr)</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;            <span class="keywordflow">if</span> (effItr-&gt;IsEffectAffected(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>()))</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;                effItr-&gt;Call(*scritr, aurEff, dmgInfo, absorbAmount);</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160; </div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;    }</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;}</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160; </div>
<div class="line"><a name="l02536"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#aad107d81d9d0898ac5922504526dd07e"> 2536</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#aad107d81d9d0898ac5922504526dd07e">Aura::CallScriptEffectSplitHandlers</a>(<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a>* aurEff, <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a> <span class="keyword">const</span>* aurApp, <a class="code" href="../../d6/d2a/class_damage_info.html">DamageInfo</a>&amp; dmgInfo, <a class="code" href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&amp; splitAmount)</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;{</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;    {</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236aca91b48c557565055039bb70ba1fd2eb">AURA_SCRIPT_HOOK_EFFECT_SPLIT</a>, aurApp);</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        std::list&lt;AuraScript::EffectSplitHandler&gt;::iterator effEndItr = (*scritr)-&gt;OnEffectSplit.end(), effItr = (*scritr)-&gt;OnEffectSplit.begin();</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;        <span class="keywordflow">for</span> (; effItr != effEndItr; ++effItr)</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;            <span class="keywordflow">if</span> (effItr-&gt;IsEffectAffected(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>()))</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;                effItr-&gt;Call(*scritr, aurEff, dmgInfo, splitAmount);</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160; </div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    }</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;}</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160; </div>
<div class="line"><a name="l02550"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a87be004e2c34b6652cd5350689b24dc3"> 2550</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a87be004e2c34b6652cd5350689b24dc3">Aura::CallScriptCheckProcHandlers</a>(<a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a> <span class="keyword">const</span>* aurApp, <a class="code" href="../../df/def/class_proc_event_info.html">ProcEventInfo</a>&amp; eventInfo)</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;{</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../df/d60/namespacedetail_1_1digits.html#aad69d2373aa047bdd9e81494bf3da5ae">result</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    {</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236add4f24c7c71aa1892b4f7aa25f162420">AURA_SCRIPT_HOOK_CHECK_PROC</a>, aurApp);</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;        std::list&lt;AuraScript::CheckProcHandler&gt;::iterator hookItrEnd = (*scritr)-&gt;DoCheckProc.end(), hookItr = (*scritr)-&gt;DoCheckProc.begin();</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;        <span class="keywordflow">for</span> (; hookItr != hookItrEnd; ++hookItr)</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;            <a class="code" href="../../df/d60/namespacedetail_1_1digits.html#aad69d2373aa047bdd9e81494bf3da5ae">result</a> &amp;= hookItr-&gt;Call(*scritr, eventInfo);</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160; </div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    }</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160; </div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../df/d60/namespacedetail_1_1digits.html#aad69d2373aa047bdd9e81494bf3da5ae">result</a>;</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;}</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160; </div>
<div class="line"><a name="l02566"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a6577a1543d871da43ab8b015f67d4150"> 2566</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a6577a1543d871da43ab8b015f67d4150">Aura::CallScriptPrepareProcHandlers</a>(<a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a> <span class="keyword">const</span>* aurApp, <a class="code" href="../../df/def/class_proc_event_info.html">ProcEventInfo</a>&amp; eventInfo)</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;{</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    <span class="keywordtype">bool</span> prepare = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    {</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a35f3fc9519440c5f846a1cb2789706df">AURA_SCRIPT_HOOK_PREPARE_PROC</a>, aurApp);</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;        std::list&lt;AuraScript::AuraProcHandler&gt;::iterator effEndItr = (*scritr)-&gt;DoPrepareProc.end(), effItr = (*scritr)-&gt;DoPrepareProc.begin();</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;        <span class="keywordflow">for</span> (; effItr != effEndItr; ++effItr)</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;            effItr-&gt;Call(*scritr, eventInfo);</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160; </div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;        <span class="keywordflow">if</span> (prepare)</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;            prepare = !(*scritr)-&gt;_IsDefaultActionPrevented();</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160; </div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    }</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160; </div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    <span class="keywordflow">return</span> prepare;</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;}</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160; </div>
<div class="line"><a name="l02585"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a99d38e9baa13b6683db43d67757ec982"> 2585</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a99d38e9baa13b6683db43d67757ec982">Aura::CallScriptProcHandlers</a>(<a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a> <span class="keyword">const</span>* aurApp, <a class="code" href="../../df/def/class_proc_event_info.html">ProcEventInfo</a>&amp; eventInfo)</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;{</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;    <span class="keywordtype">bool</span> handled = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;    {</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a7ab83bc59e26f2a76b49c41feebe0726">AURA_SCRIPT_HOOK_PROC</a>, aurApp);</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;        std::list&lt;AuraScript::AuraProcHandler&gt;::iterator hookItrEnd = (*scritr)-&gt;OnProc.end(), hookItr = (*scritr)-&gt;OnProc.begin();</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;        <span class="keywordflow">for</span> (; hookItr != hookItrEnd; ++hookItr)</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;            hookItr-&gt;Call(*scritr, eventInfo);</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160; </div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;        handled |= (*scritr)-&gt;_IsDefaultActionPrevented();</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;    }</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160; </div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    <span class="keywordflow">return</span> handled;</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;}</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160; </div>
<div class="line"><a name="l02602"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a3bac8c34612850e65cd2411f2c7b6baa"> 2602</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a3bac8c34612850e65cd2411f2c7b6baa">Aura::CallScriptAfterProcHandlers</a>(<a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a> <span class="keyword">const</span>* aurApp, <a class="code" href="../../df/def/class_proc_event_info.html">ProcEventInfo</a>&amp; eventInfo)</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;{</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;    {</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a4bfd62ef873930a2ed1f6da09b85296d">AURA_SCRIPT_HOOK_AFTER_PROC</a>, aurApp);</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;        std::list&lt;AuraScript::AuraProcHandler&gt;::iterator hookItrEnd = (*scritr)-&gt;AfterProc.end(), hookItr = (*scritr)-&gt;AfterProc.begin();</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;        <span class="keywordflow">for</span> (; hookItr != hookItrEnd; ++hookItr)</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;            hookItr-&gt;Call(*scritr, eventInfo);</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160; </div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;    }</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;}</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160; </div>
<div class="line"><a name="l02615"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a96d2072a3b0b06f82113eb9d3e186ac1"> 2615</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d2/dde/class_aura.html#a96d2072a3b0b06f82113eb9d3e186ac1">Aura::CallScriptEffectProcHandlers</a>(<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a> <span class="keyword">const</span>* aurEff, <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a> <span class="keyword">const</span>* aurApp, <a class="code" href="../../df/def/class_proc_event_info.html">ProcEventInfo</a>&amp; eventInfo)</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;{</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    <span class="keywordtype">bool</span> preventDefault = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    {</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236ac81ead411b37d2496c7a9993f339a39d">AURA_SCRIPT_HOOK_EFFECT_PROC</a>, aurApp);</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;        std::list&lt;AuraScript::EffectProcHandler&gt;::iterator effEndItr = (*scritr)-&gt;OnEffectProc.end(), effItr = (*scritr)-&gt;OnEffectProc.begin();</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;        <span class="keywordflow">for</span> (; effItr != effEndItr; ++effItr)</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;            <span class="keywordflow">if</span> (effItr-&gt;IsEffectAffected(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>()))</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;                effItr-&gt;Call(*scritr, aurEff, eventInfo);</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160; </div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;        <span class="keywordflow">if</span> (!preventDefault)</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;            preventDefault = (*scritr)-&gt;_IsDefaultActionPrevented();</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160; </div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    }</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    <span class="keywordflow">return</span> preventDefault;</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;}</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160; </div>
<div class="line"><a name="l02634"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a97347f8dc5f2dd96c7c45a77c13988a5"> 2634</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a97347f8dc5f2dd96c7c45a77c13988a5">Aura::CallScriptAfterEffectProcHandlers</a>(<a class="code" href="../../da/df1/class_aura_effect.html">AuraEffect</a> <span class="keyword">const</span>* aurEff, <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a> <span class="keyword">const</span>* aurApp, <a class="code" href="../../df/def/class_proc_event_info.html">ProcEventInfo</a>&amp; eventInfo)</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;{</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    <span class="keywordflow">for</span> (std::list&lt;AuraScript*&gt;::iterator scritr = <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.begin(); scritr != <a class="code" href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">m_loadedScripts</a>.end(); ++scritr)</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;    {</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;        (*scritr)-&gt;_PrepareScriptCall(<a class="code" href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236ab303f97a56ee2f3d7ecd4e7a7950236c">AURA_SCRIPT_HOOK_EFFECT_AFTER_PROC</a>, aurApp);</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        std::list&lt;AuraScript::EffectProcHandler&gt;::iterator effEndItr = (*scritr)-&gt;AfterEffectProc.end(), effItr = (*scritr)-&gt;AfterEffectProc.begin();</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;        <span class="keywordflow">for</span> (; effItr != effEndItr; ++effItr)</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;            <span class="keywordflow">if</span> (effItr-&gt;IsEffectAffected(<a class="code" href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">m_spellInfo</a>, aurEff-&gt;<a class="code" href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">GetEffIndex</a>()))</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;                effItr-&gt;Call(*scritr, aurEff, eventInfo);</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160; </div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;        (*scritr)-&gt;_FinishScriptCall();</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    }</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;}</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160; </div>
<div class="line"><a name="l02648"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#a32cda9926aa3e5d7def42ebf85f23bc8"> 2648</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d2/dde/class_aura.html#a32cda9926aa3e5d7def42ebf85f23bc8">Aura::SetTriggeredByAuraSpellInfo</a>(<a class="code" href="../../d4/d7d/class_spell_info.html">SpellInfo</a> <span class="keyword">const</span>* triggeredByAuraSpellInfo)</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;{</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#aa4972c4116685b08f25f6a2711c196d3">m_triggeredByAuraSpellInfo</a> = triggeredByAuraSpellInfo;</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;}</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160; </div>
<div class="line"><a name="l02653"></a><span class="lineno"><a class="line" href="../../d2/dde/class_aura.html#af64f07e2756640cb9caf21433bd4e2b6"> 2653</a></span>&#160;<a class="code" href="../../d4/d7d/class_spell_info.html">SpellInfo</a> <span class="keyword">const</span>* <a class="code" href="../../d2/dde/class_aura.html#af64f07e2756640cb9caf21433bd4e2b6">Aura::GetTriggeredByAuraSpellInfo</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/dde/class_aura.html#aa4972c4116685b08f25f6a2711c196d3">m_triggeredByAuraSpellInfo</a>;</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;}</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160; </div>
<div class="line"><a name="l02658"></a><span class="lineno"><a class="line" href="../../d1/dde/class_unit_aura.html#ada4033955271dfb21d16a95b316087f5"> 2658</a></span>&#160;<a class="code" href="../../d1/dde/class_unit_aura.html#ada4033955271dfb21d16a95b316087f5">UnitAura::UnitAura</a>(<a class="code" href="../../d4/d7d/class_spell_info.html">SpellInfo</a> <span class="keyword">const</span>* spellproto, <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> effMask, <a class="code" href="../../db/df7/class_world_object.html">WorldObject</a>* owner, <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster, <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>* baseAmount, <a class="code" href="../../dc/d32/class_item.html">Item</a>* castItem, <a class="code" href="../../d8/d03/class_object_guid.html">ObjectGuid</a> casterGUID, <a class="code" href="../../d8/d03/class_object_guid.html">ObjectGuid</a> itemGUID <span class="comment">/*= ObjectGuid::Empty*/</span>)</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    : <a class="code" href="../../d2/dde/class_aura.html">Aura</a>(spellproto, owner, caster, castItem, casterGUID, itemGUID)</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;{</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;    <a class="code" href="../../d1/dde/class_unit_aura.html#a4b413c5e62eee76875a22345059e6124">m_AuraDRGroup</a> = <a class="code" href="../../df/d0b/_shared_defines_8h.html#a1d74b2169d9a060490d81975a3064f50a463a6938a384ecb8e81ea00f8a66a85c">DIMINISHING_NONE</a>;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a9ed84a2b95a1cb898a682c809dd25d2b">LoadScripts</a>();</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#ab477124f94af36e9be706451dce791f7">_InitEffects</a>(effMask, caster, baseAmount);</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>()-&gt;<a class="code" href="../../da/db7/class_unit.html#a95169cc622a982afdbb1e5d865148c9d">_AddAura</a>(<span class="keyword">this</span>, caster);</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;}</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160; </div>
<div class="line"><a name="l02667"></a><span class="lineno"><a class="line" href="../../d1/dde/class_unit_aura.html#a920549cf55c8def37149b00ae971127d"> 2667</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/dde/class_unit_aura.html#a920549cf55c8def37149b00ae971127d">UnitAura::_ApplyForTarget</a>(<a class="code" href="../../da/db7/class_unit.html">Unit</a>* target, <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster, <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a>* aurApp)</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;{</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#ad1c2269615a73318dc9438801d1ee087">Aura::_ApplyForTarget</a>(target, caster, aurApp);</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160; </div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;    <span class="comment">// register aura diminishing on apply</span></div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../df/d0b/_shared_defines_8h.html#a1d74b2169d9a060490d81975a3064f50">DiminishingGroup</a> group = <a class="code" href="../../d1/dde/class_unit_aura.html#a8ebf7b01e7f324938f68ad4ce74d56b5">GetDiminishGroup</a>())</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;        target-&gt;<a class="code" href="../../da/db7/class_unit.html#ae2d52757675f654e5e314e49c5df210b">ApplyDiminishingAura</a>(group, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;}</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160; </div>
<div class="line"><a name="l02676"></a><span class="lineno"><a class="line" href="../../d1/dde/class_unit_aura.html#af4d453cee6758e633bdcae0049581898"> 2676</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/dde/class_unit_aura.html#af4d453cee6758e633bdcae0049581898">UnitAura::_UnapplyForTarget</a>(<a class="code" href="../../da/db7/class_unit.html">Unit</a>* target, <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster, <a class="code" href="../../d8/da3/class_aura_application.html">AuraApplication</a>* aurApp)</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;{</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a068cc46b636b35d317aea47a2de6253e">Aura::_UnapplyForTarget</a>(target, caster, aurApp);</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160; </div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;    <span class="comment">// unregister aura diminishing (and store last time)</span></div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../df/d0b/_shared_defines_8h.html#a1d74b2169d9a060490d81975a3064f50">DiminishingGroup</a> group = <a class="code" href="../../d1/dde/class_unit_aura.html#a8ebf7b01e7f324938f68ad4ce74d56b5">GetDiminishGroup</a>())</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;        target-&gt;<a class="code" href="../../da/db7/class_unit.html#ae2d52757675f654e5e314e49c5df210b">ApplyDiminishingAura</a>(group, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;}</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160; </div>
<div class="line"><a name="l02685"></a><span class="lineno"><a class="line" href="../../d1/dde/class_unit_aura.html#a28f714404942bb5c614ac844cf937546"> 2685</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/dde/class_unit_aura.html#a28f714404942bb5c614ac844cf937546">UnitAura::Remove</a>(<a class="code" href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94">AuraRemoveMode</a> removeMode)</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;{</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a462457cadd52ba8a0edd5609c71ebbc0">IsRemoved</a>())</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>()-&gt;<a class="code" href="../../da/db7/class_unit.html#a07e3ea0e73b3ac9987aedd33c99873c9">RemoveOwnedAura</a>(<span class="keyword">this</span>, removeMode);</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;}</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160; </div>
<div class="line"><a name="l02692"></a><span class="lineno"><a class="line" href="../../d1/dde/class_unit_aura.html#add5ce04446338e078c5986420abfd16e"> 2692</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/dde/class_unit_aura.html#add5ce04446338e078c5986420abfd16e">UnitAura::FillTargetMap</a>(std::map&lt;Unit*, uint8&gt;&amp; targets, <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster)</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;{</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> effIndex = 0; effIndex &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++effIndex)</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    {</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../d2/dde/class_aura.html#a3d22c519ba658770e61a1616be667a09">HasEffect</a>(effIndex))</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;        <a class="code" href="../../d5/d32/_unit_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a> targetList;</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;        <span class="comment">// non-area aura</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;Effects[effIndex].Effect == <a class="code" href="../../df/d0b/_shared_defines_8h.html#a292c893150c454dd75628b719db1fe97af737ae1ce32d016e21279dfed355d63d">SPELL_EFFECT_APPLY_AURA</a>)</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;        {</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;            targetList.push_back(<a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>());</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;        }</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;        {</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;            <span class="keywordtype">float</span> radius = <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;<a class="code" href="../../d4/d7d/class_spell_info.html#aa5bb0d7d6df03526d011d9cbfa3734e0">Effects</a>[effIndex].CalcRadius(caster);</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160; </div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>()-&gt;HasUnitState(<a class="code" href="../../d5/d32/_unit_8h.html#ae51d2ecb71f7a5cb3882982a622c9544a7c4ae74029844364315885e02df35505">UNIT_STATE_ISOLATED</a>))</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;            {</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;                <span class="keywordflow">switch</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;Effects[effIndex].Effect)</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;                {</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a292c893150c454dd75628b719db1fe97a0e98b45f9300ce66be7a701eff5e5fca">SPELL_EFFECT_APPLY_AREA_AURA_PARTY</a>:</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a292c893150c454dd75628b719db1fe97a96bae50ba11bd175354f4db26746867f">SPELL_EFFECT_APPLY_AREA_AURA_RAID</a>:</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;                        {</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;                            targetList.push_back(<a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>());</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;                            <a class="code" href="../../dc/dc0/class_acore_1_1_any_grouped_unit_in_object_range_check.html">Acore::AnyGroupedUnitInObjectRangeCheck</a> u_check(<a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>(), <a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>(), radius, <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;Effects[effIndex].Effect == <a class="code" href="../../df/d0b/_shared_defines_8h.html#a292c893150c454dd75628b719db1fe97a96bae50ba11bd175354f4db26746867f">SPELL_EFFECT_APPLY_AREA_AURA_RAID</a>);</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;                            <a class="code" href="../../da/d76/struct_acore_1_1_unit_list_searcher.html">Acore::UnitListSearcher&lt;Acore::AnyGroupedUnitInObjectRangeCheck&gt;</a> searcher(<a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>(), targetList, u_check);</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;                            <a class="code" href="../../dc/d9f/struct_cell.html#a15697efba7478b6e227b5f3c7aafc961">Cell::VisitAllObjects</a>(<a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>(), searcher, radius);</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;                        }</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a292c893150c454dd75628b719db1fe97a140c94210262d911b2db681aba463d19">SPELL_EFFECT_APPLY_AREA_AURA_FRIEND</a>:</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;                        {</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;                            targetList.push_back(<a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>());</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;                            <a class="code" href="../../d6/dc1/class_acore_1_1_any_friendly_unit_in_object_range_check.html">Acore::AnyFriendlyUnitInObjectRangeCheck</a> u_check(<a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>(), <a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>(), radius);</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;                            <a class="code" href="../../da/d76/struct_acore_1_1_unit_list_searcher.html">Acore::UnitListSearcher&lt;Acore::AnyFriendlyUnitInObjectRangeCheck&gt;</a> searcher(<a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>(), targetList, u_check);</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;                            <a class="code" href="../../dc/d9f/struct_cell.html#a15697efba7478b6e227b5f3c7aafc961">Cell::VisitAllObjects</a>(<a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>(), searcher, radius);</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;                        }</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a292c893150c454dd75628b719db1fe97ad8952de70b3fb92f22a051a26793a740">SPELL_EFFECT_APPLY_AREA_AURA_ENEMY</a>:</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;                        {</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;                            <a class="code" href="../../df/db4/class_acore_1_1_any_ao_e_target_unit_in_object_range_check.html">Acore::AnyAoETargetUnitInObjectRangeCheck</a> u_check(<a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>(), <a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>(), radius); <span class="comment">// No GetCharmer in searcher</span></div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                            <a class="code" href="../../da/d76/struct_acore_1_1_unit_list_searcher.html">Acore::UnitListSearcher&lt;Acore::AnyAoETargetUnitInObjectRangeCheck&gt;</a> searcher(<a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>(), targetList, u_check);</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                            <a class="code" href="../../dc/d9f/struct_cell.html#a15697efba7478b6e227b5f3c7aafc961">Cell::VisitAllObjects</a>(<a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>(), searcher, radius);</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;                        }</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a292c893150c454dd75628b719db1fe97a56fb7001bff11474629f084fda6953a1">SPELL_EFFECT_APPLY_AREA_AURA_PET</a>:</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;                        targetList.push_back(<a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>());</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;                        [[fallthrough]]; <span class="comment">// TODO: Not sure whether the fallthrough was a mistake (forgetting a break) or intended. This should be double-checked.</span></div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="../../df/d0b/_shared_defines_8h.html#a292c893150c454dd75628b719db1fe97affaa057383042f4e64d387fb592eecb6">SPELL_EFFECT_APPLY_AREA_AURA_OWNER</a>:</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;                        {</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="../../da/db7/class_unit.html">Unit</a>* owner = <a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>()-&gt;GetCharmerOrOwner())</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">GetUnitOwner</a>()-&gt;IsWithinDistInMap(owner, radius))</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;                                    targetList.push_back(owner);</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;                        }</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;                }</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;            }</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;        }</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160; </div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;        <span class="keywordflow">for</span> (UnitList::iterator itr = targetList.begin(); itr != targetList.end(); ++itr)</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;        {</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;            std::map&lt;Unit*, uint8&gt;::iterator existing = targets.find(*itr);</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;            <span class="keywordflow">if</span> (existing != targets.end())</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;                existing-&gt;second |= 1 &lt;&lt; effIndex;</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;                targets[*itr] = 1 &lt;&lt; effIndex;</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;        }</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    }</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;}</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160; </div>
<div class="line"><a name="l02761"></a><span class="lineno"><a class="line" href="../../d7/d48/class_dyn_obj_aura.html#aef75bb5d60c10ac63821b0e9baf6eb7a"> 2761</a></span>&#160;<a class="code" href="../../d7/d48/class_dyn_obj_aura.html#aef75bb5d60c10ac63821b0e9baf6eb7a">DynObjAura::DynObjAura</a>(<a class="code" href="../../d4/d7d/class_spell_info.html">SpellInfo</a> <span class="keyword">const</span>* spellproto, <a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> effMask, <a class="code" href="../../db/df7/class_world_object.html">WorldObject</a>* owner, <a class="code" href="../../da/db7/class_unit.html">Unit</a>* caster, <a class="code" href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>* baseAmount, <a class="code" href="../../dc/d32/class_item.html">Item</a>* castItem, <a class="code" href="../../d8/d03/class_object_guid.html">ObjectGuid</a> casterGUID, <a class="code" href="../../d8/d03/class_object_guid.html">ObjectGuid</a> itemGUID <span class="comment">/*= ObjectGuid::Empty*/</span>)</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;    : <a class="code" href="../../d2/dde/class_aura.html">Aura</a>(spellproto, owner, caster, castItem, casterGUID, itemGUID)</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;{</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#a9ed84a2b95a1cb898a682c809dd25d2b">LoadScripts</a>();</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(<a class="code" href="../../d2/dde/class_aura.html#abfb01581d89c746acf70279f5e5cf782">GetDynobjOwner</a>());</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(<a class="code" href="../../d2/dde/class_aura.html#abfb01581d89c746acf70279f5e5cf782">GetDynobjOwner</a>()-&gt;IsInWorld());</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    <a class="code" href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a>(<a class="code" href="../../d2/dde/class_aura.html#abfb01581d89c746acf70279f5e5cf782">GetDynobjOwner</a>()-&gt;GetMap() == caster-&gt;<a class="code" href="../../db/df7/class_world_object.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>());</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#ab477124f94af36e9be706451dce791f7">_InitEffects</a>(effMask, caster, baseAmount);</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#abfb01581d89c746acf70279f5e5cf782">GetDynobjOwner</a>()-&gt;<a class="code" href="../../d4/ddd/class_dynamic_object.html#a0e21e54eec1092b7ed05d1bacd0f8ed6">SetAura</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;}</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160; </div>
<div class="line"><a name="l02772"></a><span class="lineno"><a class="line" href="../../d7/d48/class_dyn_obj_aura.html#ada3f65b4a817e2337da43da437b93a3b"> 2772</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/d48/class_dyn_obj_aura.html#ada3f65b4a817e2337da43da437b93a3b">DynObjAura::Remove</a>(<a class="code" href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94">AuraRemoveMode</a> removeMode)</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;{</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a462457cadd52ba8a0edd5609c71ebbc0">IsRemoved</a>())</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;    <a class="code" href="../../d2/dde/class_aura.html#afb6874ab08b221b2f1f9d7582c1c93be">_Remove</a>(removeMode);</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;}</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160; </div>
<div class="line"><a name="l02779"></a><span class="lineno"><a class="line" href="../../d7/d48/class_dyn_obj_aura.html#af8e36643ed675ff5652e4665bee9b0c3"> 2779</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d7/d48/class_dyn_obj_aura.html#af8e36643ed675ff5652e4665bee9b0c3">DynObjAura::FillTargetMap</a>(std::map&lt;Unit*, uint8&gt;&amp; targets, <a class="code" href="../../da/db7/class_unit.html">Unit</a>* <span class="comment">/*caster*/</span>)</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;{</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    <a class="code" href="../../da/db7/class_unit.html">Unit</a>* dynObjOwnerCaster = <a class="code" href="../../d2/dde/class_aura.html#abfb01581d89c746acf70279f5e5cf782">GetDynobjOwner</a>()-&gt;<a class="code" href="../../d4/ddd/class_dynamic_object.html#aaa9a2dbbf9cbc8d01dd6f3d81dcba8a8">GetCaster</a>();</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    <span class="keywordtype">float</span> radius = <a class="code" href="../../d2/dde/class_aura.html#abfb01581d89c746acf70279f5e5cf782">GetDynobjOwner</a>()-&gt;<a class="code" href="../../d4/ddd/class_dynamic_object.html#afb0de652437ede9d70a06b3c110b5ae9">GetRadius</a>();</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160; </div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> effIndex = 0; effIndex &lt; <a class="code" href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a>; ++effIndex)</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    {</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../d2/dde/class_aura.html#a3d22c519ba658770e61a1616be667a09">HasEffect</a>(effIndex))</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;        <a class="code" href="../../d5/d32/_unit_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a> targetList;</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;Effects[effIndex].TargetB.GetTarget() == <a class="code" href="../../df/d0b/_shared_defines_8h.html#a418aed4e4066eb09ab979b5d78dc9152a89060caf79b628127f72c89a4ba73046">TARGET_DEST_DYNOBJ_ALLY</a></div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;                || <a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;Effects[effIndex].TargetB.GetTarget() == <a class="code" href="../../df/d0b/_shared_defines_8h.html#a418aed4e4066eb09ab979b5d78dc9152a1a24c010eb0d4314412fee23c67a98b4">TARGET_UNIT_DEST_AREA_ALLY</a>)</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;        {</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;            <a class="code" href="../../d6/dc1/class_acore_1_1_any_friendly_unit_in_object_range_check.html">Acore::AnyFriendlyUnitInObjectRangeCheck</a> u_check(<a class="code" href="../../d2/dde/class_aura.html#abfb01581d89c746acf70279f5e5cf782">GetDynobjOwner</a>(), dynObjOwnerCaster, radius);</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;            <a class="code" href="../../da/d76/struct_acore_1_1_unit_list_searcher.html">Acore::UnitListSearcher&lt;Acore::AnyFriendlyUnitInObjectRangeCheck&gt;</a> searcher(<a class="code" href="../../d2/dde/class_aura.html#abfb01581d89c746acf70279f5e5cf782">GetDynobjOwner</a>(), targetList, u_check);</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;            <a class="code" href="../../dc/d9f/struct_cell.html#a15697efba7478b6e227b5f3c7aafc961">Cell::VisitAllObjects</a>(<a class="code" href="../../d2/dde/class_aura.html#abfb01581d89c746acf70279f5e5cf782">GetDynobjOwner</a>(), searcher, radius);</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;        }</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;        <span class="comment">// pussywizard: TARGET_DEST_DYNOBJ_NONE is supposed to search for both friendly and unfriendly targets, so for any unit</span></div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;        <span class="comment">// what about EffectImplicitTargetA?</span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">GetSpellInfo</a>()-&gt;Effects[effIndex].TargetB.GetTarget() == <a class="code" href="../../df/d0b/_shared_defines_8h.html#a418aed4e4066eb09ab979b5d78dc9152a86bfc5644ebafe704834da6ecb5a0ac8">TARGET_DEST_DYNOBJ_NONE</a>)</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        {</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;            <a class="code" href="../../d6/d09/class_acore_1_1_any_attackable_unit_except_for_original_caster_in_object_range_check.html">Acore::AnyAttackableUnitExceptForOriginalCasterInObjectRangeCheck</a> u_check(<a class="code" href="../../d2/dde/class_aura.html#abfb01581d89c746acf70279f5e5cf782">GetDynobjOwner</a>(), dynObjOwnerCaster, radius);</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;            <a class="code" href="../../da/d76/struct_acore_1_1_unit_list_searcher.html">Acore::UnitListSearcher&lt;Acore::AnyAttackableUnitExceptForOriginalCasterInObjectRangeCheck&gt;</a> searcher(<a class="code" href="../../d2/dde/class_aura.html#abfb01581d89c746acf70279f5e5cf782">GetDynobjOwner</a>(), targetList, u_check);</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;            <a class="code" href="../../dc/d9f/struct_cell.html#a15697efba7478b6e227b5f3c7aafc961">Cell::VisitAllObjects</a>(<a class="code" href="../../d2/dde/class_aura.html#abfb01581d89c746acf70279f5e5cf782">GetDynobjOwner</a>(), searcher, radius);</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;        }</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;        {</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;            <a class="code" href="../../df/db4/class_acore_1_1_any_ao_e_target_unit_in_object_range_check.html">Acore::AnyAoETargetUnitInObjectRangeCheck</a> u_check(<a class="code" href="../../d2/dde/class_aura.html#abfb01581d89c746acf70279f5e5cf782">GetDynobjOwner</a>(), dynObjOwnerCaster, radius);</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;            <a class="code" href="../../da/d76/struct_acore_1_1_unit_list_searcher.html">Acore::UnitListSearcher&lt;Acore::AnyAoETargetUnitInObjectRangeCheck&gt;</a> searcher(<a class="code" href="../../d2/dde/class_aura.html#abfb01581d89c746acf70279f5e5cf782">GetDynobjOwner</a>(), targetList, u_check);</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;            <a class="code" href="../../dc/d9f/struct_cell.html#a15697efba7478b6e227b5f3c7aafc961">Cell::VisitAllObjects</a>(<a class="code" href="../../d2/dde/class_aura.html#abfb01581d89c746acf70279f5e5cf782">GetDynobjOwner</a>(), searcher, radius);</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;        }</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160; </div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;        <span class="keywordflow">for</span> (UnitList::iterator itr = targetList.begin(); itr != targetList.end(); ++itr)</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;        {</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;            <span class="comment">// xinef: check z level and los dependence</span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;            <a class="code" href="../../da/db7/class_unit.html">Unit</a>* target = *itr;</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;            <span class="keywordtype">float</span> zLevel = <a class="code" href="../../d2/dde/class_aura.html#abfb01581d89c746acf70279f5e5cf782">GetDynobjOwner</a>()-&gt;<a class="code" href="../../d1/d26/struct_position.html#a4e813a59345a6275e8b87b96be03e60b">GetPositionZ</a>();</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="../../d1/d26/struct_position.html#a4e813a59345a6275e8b87b96be03e60b">GetPositionZ</a>() + 3.0f &lt; zLevel || target-&gt;<a class="code" href="../../d1/d26/struct_position.html#a4e813a59345a6275e8b87b96be03e60b">GetPositionZ</a>() - 5.0f &gt; zLevel)</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;                <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="../../db/df7/class_world_object.html#ac7e0924673f67475886cdb46c4137700">IsWithinLOSInMap</a>(<a class="code" href="../../d2/dde/class_aura.html#abfb01581d89c746acf70279f5e5cf782">GetDynobjOwner</a>()))</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160; </div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;            std::map&lt;Unit*, uint8&gt;::iterator existing = targets.find(*itr);</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;            <span class="keywordflow">if</span> (existing != targets.end())</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;                existing-&gt;second |= 1 &lt;&lt; effIndex;</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;                targets[*itr] = 1 &lt;&lt; effIndex;</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;        }</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;    }</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;}</div>
<div class="ttc" id="a_arena_spectator_8h_html"><div class="ttname"><a href="../../d9/ded/_arena_spectator_8h.html">ArenaSpectator.h</a></div></div>
<div class="ttc" id="a_c99_2stdbool_8h_html_a65e9886d74aaee76545e83dd09011727"><div class="ttname"><a href="../../db/def/_c99_2stdbool_8h.html#a65e9886d74aaee76545e83dd09011727">false</a></div><div class="ttdeci">#define false</div><div class="ttdef"><b>Definition:</b> <a href="../../db/def/_c99_2stdbool_8h_source.html#l00016">stdbool.h:16</a></div></div>
<div class="ttc" id="a_cell_impl_8h_html"><div class="ttname"><a href="../../d4/d39/_cell_impl_8h.html">CellImpl.h</a></div></div>
<div class="ttc" id="a_condition_mgr_8h_html_a5ab0412c3dc24dbd690ba6d7f01657f8"><div class="ttname"><a href="../../d0/d62/_condition_mgr_8h.html#a5ab0412c3dc24dbd690ba6d7f01657f8">sConditionMgr</a></div><div class="ttdeci">#define sConditionMgr</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d62/_condition_mgr_8h_source.html#l00286">ConditionMgr.h:286</a></div></div>
<div class="ttc" id="a_condition_mgr_8h_html_a5ba040e3c1f6efbefb512efb9bd69a7faf346b42db2a33729fa82322e5b422843"><div class="ttname"><a href="../../d0/d62/_condition_mgr_8h.html#a5ba040e3c1f6efbefb512efb9bd69a7faf346b42db2a33729fa82322e5b422843">CONDITION_SOURCE_TYPE_SPELL_PROC</a></div><div class="ttdeci">@ CONDITION_SOURCE_TYPE_SPELL_PROC</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d62/_condition_mgr_8h_source.html#l00146">ConditionMgr.h:146</a></div></div>
<div class="ttc" id="a_condition_mgr_8h_html_ae942a8e25dc24ce42e62625bb583c0dd"><div class="ttname"><a href="../../d0/d62/_condition_mgr_8h.html#ae942a8e25dc24ce42e62625bb583c0dd">ConditionList</a></div><div class="ttdeci">std::list&lt; Condition * &gt; ConditionList</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d62/_condition_mgr_8h_source.html#l00233">ConditionMgr.h:233</a></div></div>
<div class="ttc" id="a_d_b_c_structure_8h_html_a3ac65d8635b4379f0d5b75a0e2dfd9c8"><div class="ttname"><a href="../../d1/d22/_d_b_c_structure_8h.html#a3ac65d8635b4379f0d5b75a0e2dfd9c8">MAX_EFFECT_MASK</a></div><div class="ttdeci">#define MAX_EFFECT_MASK</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d22/_d_b_c_structure_8h_source.html#l01560">DBCStructure.h:1560</a></div></div>
<div class="ttc" id="a_d_b_c_structure_8h_html_ac5733f5b58bf8a23a1919a005b5ec895"><div class="ttname"><a href="../../d1/d22/_d_b_c_structure_8h.html#ac5733f5b58bf8a23a1919a005b5ec895">MAX_SPELL_EFFECTS</a></div><div class="ttdeci">#define MAX_SPELL_EFFECTS</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d22/_d_b_c_structure_8h_source.html#l01559">DBCStructure.h:1559</a></div></div>
<div class="ttc" id="a_define_8h_html_a0bf9964a3ce962c07ad3d8b5432bbbcd"><div class="ttname"><a href="../../db/d35/_define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a></div><div class="ttdeci">std::int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d35/_define_8h_source.html#l00110">Define.h:110</a></div></div>
<div class="ttc" id="a_define_8h_html_a22f78cc9780bf32aff91ae17c3101c8d"><div class="ttname"><a href="../../db/d35/_define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a></div><div class="ttdeci">std::uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d35/_define_8h_source.html#l00114">Define.h:114</a></div></div>
<div class="ttc" id="a_dynamic_object_8h_html"><div class="ttname"><a href="../../d0/db0/_dynamic_object_8h.html">DynamicObject.h</a></div></div>
<div class="ttc" id="a_errors_8h_html_a5376571bbf4cdc9782683635f366f89a"><div class="ttname"><a href="../../db/d16/_errors_8h.html#a5376571bbf4cdc9782683635f366f89a">ABORT</a></div><div class="ttdeci">#define ABORT</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/_errors_8h_source.html#l00062">Errors.h:62</a></div></div>
<div class="ttc" id="a_errors_8h_html_af343b20373ba49a92fce523e948f2ab3"><div class="ttname"><a href="../../db/d16/_errors_8h.html#af343b20373ba49a92fce523e948f2ab3">ASSERT</a></div><div class="ttdeci">#define ASSERT</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/_errors_8h_source.html#l00058">Errors.h:58</a></div></div>
<div class="ttc" id="a_grid_notifiers_8h_html"><div class="ttname"><a href="../../d0/dc9/_grid_notifiers_8h.html">GridNotifiers.h</a></div></div>
<div class="ttc" id="a_grid_notifiers_impl_8h_html"><div class="ttname"><a href="../../dd/df9/_grid_notifiers_impl_8h.html">GridNotifiersImpl.h</a></div></div>
<div class="ttc" id="a_item_template_8h_html_ab76605e05d3b13f61472b9a89cd22a68acd2b804e85add83cfd65339c4a084f48"><div class="ttname"><a href="../../d1/d9e/_item_template_8h.html#ab76605e05d3b13f61472b9a89cd22a68acd2b804e85add83cfd65339c4a084f48">ITEM_CLASS_ARMOR</a></div><div class="ttdeci">@ ITEM_CLASS_ARMOR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/_item_template_8h_source.html#l00304">ItemTemplate.h:304</a></div></div>
<div class="ttc" id="a_item_template_8h_html_ab76605e05d3b13f61472b9a89cd22a68aeaefdfc527a31c7c733104c01368ac2a"><div class="ttname"><a href="../../d1/d9e/_item_template_8h.html#ab76605e05d3b13f61472b9a89cd22a68aeaefdfc527a31c7c733104c01368ac2a">ITEM_CLASS_WEAPON</a></div><div class="ttdeci">@ ITEM_CLASS_WEAPON</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d9e/_item_template_8h_source.html#l00302">ItemTemplate.h:302</a></div></div>
<div class="ttc" id="a_matrix_8h_html_aaf9f9f8a87c718439346b4e96107f5e9"><div class="ttname"><a href="../../d0/d45/_matrix_8h.html#aaf9f9f8a87c718439346b4e96107f5e9">abs</a></div><div class="ttdeci">G3D::Matrix abs(const G3D::Matrix &amp;M)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d45/_matrix_8h_source.html#l00632">Matrix.h:632</a></div></div>
<div class="ttc" id="a_object_accessor_8h_html"><div class="ttname"><a href="../../db/d59/_object_accessor_8h.html">ObjectAccessor.h</a></div></div>
<div class="ttc" id="a_object_guid_8h_html_a183c40b2ba67065929d70b3987da4cc2a86e2d54e816ea646c9cda372df01dc68"><div class="ttname"><a href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2a86e2d54e816ea646c9cda372df01dc68">TYPEID_DYNAMICOBJECT</a></div><div class="ttdeci">@ TYPEID_DYNAMICOBJECT</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d83/_object_guid_8h_source.html#l00040">ObjectGuid.h:40</a></div></div>
<div class="ttc" id="a_object_guid_8h_html_a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9"><div class="ttname"><a href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a></div><div class="ttdeci">@ TYPEID_UNIT</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d83/_object_guid_8h_source.html#l00037">ObjectGuid.h:37</a></div></div>
<div class="ttc" id="a_object_guid_8h_html_a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c"><div class="ttname"><a href="../../d9/d83/_object_guid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a></div><div class="ttdeci">@ TYPEID_PLAYER</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d83/_object_guid_8h_source.html#l00038">ObjectGuid.h:38</a></div></div>
<div class="ttc" id="a_object_guid_8h_html_acfe503ba26d8a881f16958aaafd431e1a611a6f19a7f885d824ea5be71ffca2de"><div class="ttname"><a href="../../d9/d83/_object_guid_8h.html#acfe503ba26d8a881f16958aaafd431e1a611a6f19a7f885d824ea5be71ffca2de">TYPEMASK_UNIT</a></div><div class="ttdeci">@ TYPEMASK_UNIT</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d83/_object_guid_8h_source.html#l00051">ObjectGuid.h:51</a></div></div>
<div class="ttc" id="a_object_mgr_8h_html"><div class="ttname"><a href="../../d9/d77/_object_mgr_8h.html">ObjectMgr.h</a></div></div>
<div class="ttc" id="a_opcodes_8h_html"><div class="ttname"><a href="../../da/d10/_opcodes_8h.html">Opcodes.h</a></div></div>
<div class="ttc" id="a_player_8h_html"><div class="ttname"><a href="../../d1/d39/_player_8h.html">Player.h</a></div></div>
<div class="ttc" id="a_player_8h_html_a93b8041f948d575ef2d23746324a37afa559e9d51b0cff8ac6448c07e005a13bd"><div class="ttname"><a href="../../d1/d39/_player_8h.html#a93b8041f948d575ef2d23746324a37afa559e9d51b0cff8ac6448c07e005a13bd">EQUIPMENT_SLOT_MAINHAND</a></div><div class="ttdeci">@ EQUIPMENT_SLOT_MAINHAND</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d39/_player_8h_source.html#l00671">Player.h:671</a></div></div>
<div class="ttc" id="a_player_8h_html_a93b8041f948d575ef2d23746324a37afab44cb19f2d7a24d14ef74748716cd731"><div class="ttname"><a href="../../d1/d39/_player_8h.html#a93b8041f948d575ef2d23746324a37afab44cb19f2d7a24d14ef74748716cd731">EQUIPMENT_SLOT_OFFHAND</a></div><div class="ttdeci">@ EQUIPMENT_SLOT_OFFHAND</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d39/_player_8h_source.html#l00672">Player.h:672</a></div></div>
<div class="ttc" id="a_player_8h_html_a93b8041f948d575ef2d23746324a37afafc73f33a54a6e48f474648a2ad5bd72a"><div class="ttname"><a href="../../d1/d39/_player_8h.html#a93b8041f948d575ef2d23746324a37afafc73f33a54a6e48f474648a2ad5bd72a">EQUIPMENT_SLOT_RANGED</a></div><div class="ttdeci">@ EQUIPMENT_SLOT_RANGED</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d39/_player_8h_source.html#l00673">Player.h:673</a></div></div>
<div class="ttc" id="a_player_8h_html_ad3dd8ed856e16139eaa67147d40cf24e"><div class="ttname"><a href="../../d1/d39/_player_8h.html#ad3dd8ed856e16139eaa67147d40cf24e">INVENTORY_SLOT_BAG_0</a></div><div class="ttdeci">#define INVENTORY_SLOT_BAG_0</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d39/_player_8h_source.html#l00651">Player.h:651</a></div></div>
<div class="ttc" id="a_script_mgr_8h_html"><div class="ttname"><a href="../../d0/d7d/_script_mgr_8h.html">ScriptMgr.h</a></div></div>
<div class="ttc" id="a_script_mgr_8h_html_ae8161e629869974bc49b1cbfc73c1087"><div class="ttname"><a href="../../d0/d7d/_script_mgr_8h.html#ae8161e629869974bc49b1cbfc73c1087">sScriptMgr</a></div><div class="ttdeci">#define sScriptMgr</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d7d/_script_mgr_8h_source.html#l02048">ScriptMgr.h:2048</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a0b4a3c2c7210e88f82b3dc3abb6e6f77ae36fda04a2c1fff26525d0c57f79a36d"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a0b4a3c2c7210e88f82b3dc3abb6e6f77ae36fda04a2c1fff26525d0c57f79a36d">EFFECT_0</a></div><div class="ttdeci">@ EFFECT_0</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00030">SharedDefines.h:30</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a17e15fab4b89f4840e745f31ca76a414"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a17e15fab4b89f4840e745f31ca76a414">Powers</a></div><div class="ttdeci">Powers</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00239">SharedDefines.h:240</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a17e15fab4b89f4840e745f31ca76a414a1b514bf3a42e9a5dc4271bd25b7dce7e"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a17e15fab4b89f4840e745f31ca76a414a1b514bf3a42e9a5dc4271bd25b7dce7e">POWER_RAGE</a></div><div class="ttdeci">@ POWER_RAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00242">SharedDefines.h:242</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a17e15fab4b89f4840e745f31ca76a414a46379b081e66f0ab034f94a9f5dbad22"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a17e15fab4b89f4840e745f31ca76a414a46379b081e66f0ab034f94a9f5dbad22">POWER_HEALTH</a></div><div class="ttdeci">@ POWER_HEALTH</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00251">SharedDefines.h:250</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a17e15fab4b89f4840e745f31ca76a414a4c504424e60c95f01e0ec1468a52d221"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a17e15fab4b89f4840e745f31ca76a414a4c504424e60c95f01e0ec1468a52d221">POWER_RUNIC_POWER</a></div><div class="ttdeci">@ POWER_RUNIC_POWER</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00247">SharedDefines.h:247</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a17e15fab4b89f4840e745f31ca76a414a535f3e3322566811e43bef82808b5288"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a17e15fab4b89f4840e745f31ca76a414a535f3e3322566811e43bef82808b5288">POWER_ENERGY</a></div><div class="ttdeci">@ POWER_ENERGY</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00244">SharedDefines.h:244</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a17e15fab4b89f4840e745f31ca76a414ab3e4f73d6494c917b99431bae75a4d5f"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a17e15fab4b89f4840e745f31ca76a414ab3e4f73d6494c917b99431bae75a4d5f">POWER_MANA</a></div><div class="ttdeci">@ POWER_MANA</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00241">SharedDefines.h:241</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a1d74b2169d9a060490d81975a3064f50"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a1d74b2169d9a060490d81975a3064f50">DiminishingGroup</a></div><div class="ttdeci">DiminishingGroup</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l03226">SharedDefines.h:3227</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a1d74b2169d9a060490d81975a3064f50a463a6938a384ecb8e81ea00f8a66a85c"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a1d74b2169d9a060490d81975a3064f50a463a6938a384ecb8e81ea00f8a66a85c">DIMINISHING_NONE</a></div><div class="ttdeci">@ DIMINISHING_NONE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l03228">SharedDefines.h:3228</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a292c893150c454dd75628b719db1fe97a0e98b45f9300ce66be7a701eff5e5fca"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a292c893150c454dd75628b719db1fe97a0e98b45f9300ce66be7a701eff5e5fca">SPELL_EFFECT_APPLY_AREA_AURA_PARTY</a></div><div class="ttdeci">@ SPELL_EFFECT_APPLY_AREA_AURA_PARTY</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00785">SharedDefines.h:785</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a292c893150c454dd75628b719db1fe97a140c94210262d911b2db681aba463d19"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a292c893150c454dd75628b719db1fe97a140c94210262d911b2db681aba463d19">SPELL_EFFECT_APPLY_AREA_AURA_FRIEND</a></div><div class="ttdeci">@ SPELL_EFFECT_APPLY_AREA_AURA_FRIEND</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00878">SharedDefines.h:878</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a292c893150c454dd75628b719db1fe97a56fb7001bff11474629f084fda6953a1"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a292c893150c454dd75628b719db1fe97a56fb7001bff11474629f084fda6953a1">SPELL_EFFECT_APPLY_AREA_AURA_PET</a></div><div class="ttdeci">@ SPELL_EFFECT_APPLY_AREA_AURA_PET</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00869">SharedDefines.h:869</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a292c893150c454dd75628b719db1fe97a96bae50ba11bd175354f4db26746867f"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a292c893150c454dd75628b719db1fe97a96bae50ba11bd175354f4db26746867f">SPELL_EFFECT_APPLY_AREA_AURA_RAID</a></div><div class="ttdeci">@ SPELL_EFFECT_APPLY_AREA_AURA_RAID</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00815">SharedDefines.h:815</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a292c893150c454dd75628b719db1fe97aa3290e738b6cd09859039989143f9ac1"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a292c893150c454dd75628b719db1fe97aa3290e738b6cd09859039989143f9ac1">SPELL_EFFECT_PERSISTENT_AREA_AURA</a></div><div class="ttdeci">@ SPELL_EFFECT_PERSISTENT_AREA_AURA</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00777">SharedDefines.h:777</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a292c893150c454dd75628b719db1fe97ad8952de70b3fb92f22a051a26793a740"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a292c893150c454dd75628b719db1fe97ad8952de70b3fb92f22a051a26793a740">SPELL_EFFECT_APPLY_AREA_AURA_ENEMY</a></div><div class="ttdeci">@ SPELL_EFFECT_APPLY_AREA_AURA_ENEMY</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00879">SharedDefines.h:879</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a292c893150c454dd75628b719db1fe97af737ae1ce32d016e21279dfed355d63d"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a292c893150c454dd75628b719db1fe97af737ae1ce32d016e21279dfed355d63d">SPELL_EFFECT_APPLY_AURA</a></div><div class="ttdeci">@ SPELL_EFFECT_APPLY_AURA</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00756">SharedDefines.h:756</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a292c893150c454dd75628b719db1fe97affaa057383042f4e64d387fb592eecb6"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a292c893150c454dd75628b719db1fe97affaa057383042f4e64d387fb592eecb6">SPELL_EFFECT_APPLY_AREA_AURA_OWNER</a></div><div class="ttdeci">@ SPELL_EFFECT_APPLY_AREA_AURA_OWNER</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00893">SharedDefines.h:893</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a376aa62261a98289589839b821786adaa54ee0547b3e23ed80b12bf5a04573360"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a376aa62261a98289589839b821786adaa54ee0547b3e23ed80b12bf5a04573360">SPELL_ATTR5_DO_NOT_DISPLAY_DURATION</a></div><div class="ttdeci">@ SPELL_ATTR5_DO_NOT_DISPLAY_DURATION</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00549">SharedDefines.h:549</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a376aa62261a98289589839b821786adaa884cc9555b9162ae33956c5ded8cb1d7"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a376aa62261a98289589839b821786adaa884cc9555b9162ae33956c5ded8cb1d7">SPELL_ATTR5_SPELL_HASTE_AFFECTS_PERIODIC</a></div><div class="ttdeci">@ SPELL_ATTR5_SPELL_HASTE_AFFECTS_PERIODIC</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00552">SharedDefines.h:552</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a418aed4e4066eb09ab979b5d78dc9152a1a24c010eb0d4314412fee23c67a98b4"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a418aed4e4066eb09ab979b5d78dc9152a1a24c010eb0d4314412fee23c67a98b4">TARGET_UNIT_DEST_AREA_ALLY</a></div><div class="ttdeci">@ TARGET_UNIT_DEST_AREA_ALLY</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l01407">SharedDefines.h:1407</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a418aed4e4066eb09ab979b5d78dc9152a86bfc5644ebafe704834da6ecb5a0ac8"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a418aed4e4066eb09ab979b5d78dc9152a86bfc5644ebafe704834da6ecb5a0ac8">TARGET_DEST_DYNOBJ_NONE</a></div><div class="ttdeci">@ TARGET_DEST_DYNOBJ_NONE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l01464">SharedDefines.h:1464</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a418aed4e4066eb09ab979b5d78dc9152a89060caf79b628127f72c89a4ba73046"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a418aed4e4066eb09ab979b5d78dc9152a89060caf79b628127f72c89a4ba73046">TARGET_DEST_DYNOBJ_ALLY</a></div><div class="ttdeci">@ TARGET_DEST_DYNOBJ_ALLY</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l01405">SharedDefines.h:1405</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a583cc1b9a8909370e4d51a890d897668a546d420c10fbdd64888c71cf01c821ec"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a583cc1b9a8909370e4d51a890d897668a546d420c10fbdd64888c71cf01c821ec">SPELL_ATTR2_NO_TARGET_PER_SECOND_COST</a></div><div class="ttdeci">@ SPELL_ATTR2_NO_TARGET_PER_SECOND_COST</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00439">SharedDefines.h:439</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a583cc1b9a8909370e4d51a890d897668a7d005cac4a5ae05e73630754eee639fc"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a583cc1b9a8909370e4d51a890d897668a7d005cac4a5ae05e73630754eee639fc">SPELL_ATTR2_ALLOW_WHILE_NOT_SHAPESHIFTED</a></div><div class="ttdeci">@ SPELL_ATTR2_ALLOW_WHILE_NOT_SHAPESHIFTED</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00447">SharedDefines.h:447</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a638f8f550e23b2e3180b481bb3f38076a804cce10f0767b3a9083e899217af6e3"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a638f8f550e23b2e3180b481bb3f38076a804cce10f0767b3a9083e899217af6e3">SPELL_ATTR1_AURA_UNIQUE</a></div><div class="ttdeci">@ SPELL_ATTR1_AURA_UNIQUE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00402">SharedDefines.h:402</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a6f95d0d447e8085b1097ac9965af2a81a47666e0aca649bbf39649d0214f4bc67"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a6f95d0d447e8085b1097ac9965af2a81a47666e0aca649bbf39649d0214f4bc67">SPELL_ATTR3_DOT_STACKING_RULE</a></div><div class="ttdeci">@ SPELL_ATTR3_DOT_STACKING_RULE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00472">SharedDefines.h:472</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a6f95d0d447e8085b1097ac9965af2a81a4edf48bdff5870bc31c248bd4a299a17"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a6f95d0d447e8085b1097ac9965af2a81a4edf48bdff5870bc31c248bd4a299a17">SPELL_ATTR3_NO_PROC_EQUIP_REQUIREMENT</a></div><div class="ttdeci">@ SPELL_ATTR3_NO_PROC_EQUIP_REQUIREMENT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00466">SharedDefines.h:466</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a86e4e3df7a5142175aa5df522d3346cfa7f7b30426fd386c181799196c1739058"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa7f7b30426fd386c181799196c1739058">CLASS_DEATH_KNIGHT</a></div><div class="ttdeci">@ CLASS_DEATH_KNIGHT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00118">SharedDefines.h:118</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a91d505a1e789c6ea6a338f3a3c85b6b9a981326220afec59126417e02e0b882de"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a91d505a1e789c6ea6a338f3a3c85b6b9a981326220afec59126417e02e0b882de">IMMUNITY_ID</a></div><div class="ttdeci">@ IMMUNITY_ID</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l01372">SharedDefines.h:1372</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a9264ae6b0ef1b61a6eeb7fdac9fbab1ba04f59ec569a753b4e47a0a230782f207"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba04f59ec569a753b4e47a0a230782f207">SPELLFAMILY_PRIEST</a></div><div class="ttdeci">@ SPELLFAMILY_PRIEST</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l03460">SharedDefines.h:3460</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a9264ae6b0ef1b61a6eeb7fdac9fbab1ba0a134bc75d430da10f6c1df4977c29cf"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba0a134bc75d430da10f6c1df4977c29cf">SPELLFAMILY_WARLOCK</a></div><div class="ttdeci">@ SPELLFAMILY_WARLOCK</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l03459">SharedDefines.h:3459</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a9264ae6b0ef1b61a6eeb7fdac9fbab1ba0e4b88db8be01ea5d62cc08d07b28aae"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba0e4b88db8be01ea5d62cc08d07b28aae">SPELLFAMILY_MAGE</a></div><div class="ttdeci">@ SPELLFAMILY_MAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l03457">SharedDefines.h:3457</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a9264ae6b0ef1b61a6eeb7fdac9fbab1ba0ebbb6206eb92cdc484b416eb6f41743"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba0ebbb6206eb92cdc484b416eb6f41743">SPELLFAMILY_GENERIC</a></div><div class="ttdeci">@ SPELLFAMILY_GENERIC</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l03454">SharedDefines.h:3454</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a9264ae6b0ef1b61a6eeb7fdac9fbab1ba52acbcf14a96b5ed01b8a43052a26a11"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba52acbcf14a96b5ed01b8a43052a26a11">SPELLFAMILY_WARRIOR</a></div><div class="ttdeci">@ SPELLFAMILY_WARRIOR</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l03458">SharedDefines.h:3458</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a9264ae6b0ef1b61a6eeb7fdac9fbab1ba573f9ad8924e7632156291378448e742"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba573f9ad8924e7632156291378448e742">SPELLFAMILY_PALADIN</a></div><div class="ttdeci">@ SPELLFAMILY_PALADIN</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l03464">SharedDefines.h:3464</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a9264ae6b0ef1b61a6eeb7fdac9fbab1ba66df9b34a3b922a8242d3dfb74494026"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba66df9b34a3b922a8242d3dfb74494026">SPELLFAMILY_HUNTER</a></div><div class="ttdeci">@ SPELLFAMILY_HUNTER</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l03463">SharedDefines.h:3463</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a9264ae6b0ef1b61a6eeb7fdac9fbab1ba84336097f9e363a9b6a4d7d4839c1b54"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba84336097f9e363a9b6a4d7d4839c1b54">SPELLFAMILY_POTION</a></div><div class="ttdeci">@ SPELLFAMILY_POTION</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l03467">SharedDefines.h:3467</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a9264ae6b0ef1b61a6eeb7fdac9fbab1ba9160b2e3a87a908af25c9a594295c0c1"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1ba9160b2e3a87a908af25c9a594295c0c1">SPELLFAMILY_ROGUE</a></div><div class="ttdeci">@ SPELLFAMILY_ROGUE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l03462">SharedDefines.h:3462</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a9264ae6b0ef1b61a6eeb7fdac9fbab1bac3788ce010075b8bd4e6083638d8cd40"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1bac3788ce010075b8bd4e6083638d8cd40">SPELLFAMILY_DRUID</a></div><div class="ttdeci">@ SPELLFAMILY_DRUID</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l03461">SharedDefines.h:3461</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a9264ae6b0ef1b61a6eeb7fdac9fbab1badc34b27f2cd523716d80c51d4e1d6f02"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a9264ae6b0ef1b61a6eeb7fdac9fbab1badc34b27f2cd523716d80c51d4e1d6f02">SPELLFAMILY_DEATHKNIGHT</a></div><div class="ttdeci">@ SPELLFAMILY_DEATHKNIGHT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l03469">SharedDefines.h:3469</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a9dcd0ba8d94905ba214797c12e7c44ada181bc0f8031c0a2e477f0eb213ae3fc0"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a9dcd0ba8d94905ba214797c12e7c44ada181bc0f8031c0a2e477f0eb213ae3fc0">SPELL_ATTR0_NOT_SHAPESHIFTED</a></div><div class="ttdeci">@ SPELL_ATTR0_NOT_SHAPESHIFTED</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00370">SharedDefines.h:370</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_a9dcd0ba8d94905ba214797c12e7c44ada9d53bd915f5409506cb045a0688a0a75"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#a9dcd0ba8d94905ba214797c12e7c44ada9d53bd915f5409506cb045a0688a0a75">SPELL_ATTR0_DO_NOT_DISPLAY</a></div><div class="ttdeci">@ SPELL_ATTR0_DO_NOT_DISPLAY</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00361">SharedDefines.h:361</a></div></div>
<div class="ttc" id="a_shared_defines_8h_html_afc0226d0611e178e6edb4d2776e03094a7e3a5efaeb82064d20232846d5e4437d"><div class="ttname"><a href="../../df/d0b/_shared_defines_8h.html#afc0226d0611e178e6edb4d2776e03094a7e3a5efaeb82064d20232846d5e4437d">SPELL_ATTR6_DO_NOT_CONSUME_RESOURCES</a></div><div class="ttdeci">@ SPELL_ATTR6_DO_NOT_CONSUME_RESOURCES</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0b/_shared_defines_8h_source.html#l00581">SharedDefines.h:581</a></div></div>
<div class="ttc" id="a_spell_8h_html"><div class="ttname"><a href="../../d5/dfa/_spell_8h.html">Spell.h</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a4c7deb1171a45d3528d20c5534828707"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a4c7deb1171a45d3528d20c5534828707">MAX_AURAS</a></div><div class="ttdeci">#define MAX_AURAS</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00021">SpellAuraDefines.h:21</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799">AuraType</a></div><div class="ttdeci">AuraType</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00061">SpellAuraDefines.h:62</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799a11166673929d2fda5967add284832fad"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a11166673929d2fda5967add284832fad">SPELL_AURA_PERIODIC_DAMAGE</a></div><div class="ttdeci">@ SPELL_AURA_PERIODIC_DAMAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00066">SpellAuraDefines.h:66</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799a1191ab2524c100b0d91f8d63cee8e781"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a1191ab2524c100b0d91f8d63cee8e781">SPELL_AURA_PERIODIC_HASTE</a></div><div class="ttdeci">@ SPELL_AURA_PERIODIC_HASTE</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00379">SpellAuraDefines.h:379</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799a1a0187ab21626c9032d7398c0b98941d"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a1a0187ab21626c9032d7398c0b98941d">SPELL_AURA_ABILITY_IGNORE_AURASTATE</a></div><div class="ttdeci">@ SPELL_AURA_ABILITY_IGNORE_AURASTATE</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00325">SpellAuraDefines.h:325</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799a2616d80ed4951b4ff860a0e0e2a98da0"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a2616d80ed4951b4ff860a0e0e2a98da0">SPELL_AURA_OBS_MOD_HEALTH</a></div><div class="ttdeci">@ SPELL_AURA_OBS_MOD_HEALTH</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00083">SpellAuraDefines.h:83</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799a2c530c4b7d2f3b77f65f62395bda9c4a"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a2c530c4b7d2f3b77f65f62395bda9c4a">SPELL_AURA_ADD_PCT_MODIFIER</a></div><div class="ttdeci">@ SPELL_AURA_ADD_PCT_MODIFIER</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00171">SpellAuraDefines.h:171</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799a2eb3f6e6a49bc0b70fa9726b1fa12bb3"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a2eb3f6e6a49bc0b70fa9726b1fa12bb3">SPELL_AURA_PERIODIC_MANA_LEECH</a></div><div class="ttdeci">@ SPELL_AURA_PERIODIC_MANA_LEECH</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00127">SpellAuraDefines.h:127</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799a30ae3c9499778cc5f920e81dc86cd020"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a30ae3c9499778cc5f920e81dc86cd020">SPELL_AURA_MOD_POSSESS_PET</a></div><div class="ttdeci">@ SPELL_AURA_MOD_POSSESS_PET</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00191">SpellAuraDefines.h:191</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799a3ea4c20e7d6e039f209ab904172d53e9"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a3ea4c20e7d6e039f209ab904172d53e9">SPELL_AURA_CONVERT_RUNE</a></div><div class="ttdeci">@ SPELL_AURA_CONVERT_RUNE</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00312">SpellAuraDefines.h:312</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799a4f1feb3950d2776a74c938c366adbbdf"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a4f1feb3950d2776a74c938c366adbbdf">SPELL_AURA_OBS_MOD_POWER</a></div><div class="ttdeci">@ SPELL_AURA_OBS_MOD_POWER</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00084">SpellAuraDefines.h:84</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799a50563ee6555455f041b81ce199ad1a4f"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a50563ee6555455f041b81ce199ad1a4f">SPELL_AURA_ADD_FLAT_MODIFIER</a></div><div class="ttdeci">@ SPELL_AURA_ADD_FLAT_MODIFIER</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00170">SpellAuraDefines.h:170</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799a583bf7e94825b7252010ad12dd50ed6f"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a583bf7e94825b7252010ad12dd50ed6f">SPELL_AURA_CONTROL_VEHICLE</a></div><div class="ttdeci">@ SPELL_AURA_CONTROL_VEHICLE</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00299">SpellAuraDefines.h:299</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799a6442a4a379f82e2f08734296e1e21c9f"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a6442a4a379f82e2f08734296e1e21c9f">SPELL_AURA_PERIODIC_HEAL</a></div><div class="ttdeci">@ SPELL_AURA_PERIODIC_HEAL</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00071">SpellAuraDefines.h:71</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799a66cca11731d68512cb0bb652cb1e7caf"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a66cca11731d68512cb0bb652cb1e7caf">SPELL_AURA_DUMMY</a></div><div class="ttdeci">@ SPELL_AURA_DUMMY</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00067">SpellAuraDefines.h:67</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799a7b5d0b48f9a7e84bf7a896602e8c66b9"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799a7b5d0b48f9a7e84bf7a896602e8c66b9">SPELL_AURA_MOD_CHARM</a></div><div class="ttdeci">@ SPELL_AURA_MOD_CHARM</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00069">SpellAuraDefines.h:69</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799aada4a291fd71b7b408ec0ac6543e79b1"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799aada4a291fd71b7b408ec0ac6543e79b1">SPELL_AURA_AOE_CHARM</a></div><div class="ttdeci">@ SPELL_AURA_AOE_CHARM</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00240">SpellAuraDefines.h:240</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799ab6c4d806c60e94fec189c27a7a205576"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799ab6c4d806c60e94fec189c27a7a205576">SPELL_AURA_PERIODIC_TRIGGER_SPELL_WITH_VALUE</a></div><div class="ttdeci">@ SPELL_AURA_PERIODIC_TRIGGER_SPELL_WITH_VALUE</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00290">SpellAuraDefines.h:290</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799ab9f377f6e107ad1633d32a22da2ec7d2"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799ab9f377f6e107ad1633d32a22da2ec7d2">SPELL_AURA_PERIODIC_ENERGIZE</a></div><div class="ttdeci">@ SPELL_AURA_PERIODIC_ENERGIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00087">SpellAuraDefines.h:87</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799aba7e00a7ce6cd006b67262e5e3731364"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799aba7e00a7ce6cd006b67262e5e3731364">SPELL_AURA_230</a></div><div class="ttdeci">@ SPELL_AURA_230</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00293">SpellAuraDefines.h:293</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799ac84a600c9fc81cbda953c9f64074ab9f"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799ac84a600c9fc81cbda953c9f64074ab9f">SPELL_AURA_PERIODIC_LEECH</a></div><div class="ttdeci">@ SPELL_AURA_PERIODIC_LEECH</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00116">SpellAuraDefines.h:116</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799ad06611922c0cf903c24b220140daacab"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799ad06611922c0cf903c24b220140daacab">SPELL_AURA_POWER_BURN</a></div><div class="ttdeci">@ SPELL_AURA_POWER_BURN</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00225">SpellAuraDefines.h:225</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799ad75b18045110664869a6a4a86c4db16e"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799ad75b18045110664869a6a4a86c4db16e">SPELL_AURA_OPEN_STABLE</a></div><div class="ttdeci">@ SPELL_AURA_OPEN_STABLE</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00355">SpellAuraDefines.h:355</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799adc30e3257d95c2736a98331a53766eea"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799adc30e3257d95c2736a98331a53766eea">SPELL_AURA_MOD_POSSESS</a></div><div class="ttdeci">@ SPELL_AURA_MOD_POSSESS</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00065">SpellAuraDefines.h:65</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799add498157825d0faca2c013bbcdfbae56"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799add498157825d0faca2c013bbcdfbae56">SPELL_AURA_PERIODIC_DUMMY</a></div><div class="ttdeci">@ SPELL_AURA_PERIODIC_DUMMY</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00289">SpellAuraDefines.h:289</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799aee9829857fab1a5438db7a7fdf8806fa"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799aee9829857fab1a5438db7a7fdf8806fa">SPELL_AURA_OVERRIDE_CLASS_SCRIPTS</a></div><div class="ttdeci">@ SPELL_AURA_OVERRIDE_CLASS_SCRIPTS</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00175">SpellAuraDefines.h:175</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799af034ae8de320204d3de55be2f4eb6919"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799af034ae8de320204d3de55be2f4eb6919">SPELL_AURA_MOD_CASTING_SPEED_NOT_STACK</a></div><div class="ttdeci">@ SPELL_AURA_MOD_CASTING_SPEED_NOT_STACK</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00128">SpellAuraDefines.h:128</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799af51e1877e096bbfd69505e5ab4fc69ad"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799af51e1877e096bbfd69505e5ab4fc69ad">SPELL_AURA_PERIODIC_TRIGGER_SPELL</a></div><div class="ttdeci">@ SPELL_AURA_PERIODIC_TRIGGER_SPELL</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00086">SpellAuraDefines.h:86</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799afba710f82abb2c1c8a2c9a267a68a340"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799afba710f82abb2c1c8a2c9a267a68a340">SPELL_AURA_MOD_DISPEL_RESIST</a></div><div class="ttdeci">@ SPELL_AURA_MOD_DISPEL_RESIST</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00298">SpellAuraDefines.h:298</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a538cdc259460b365f406fe0b3a981799aff313dd31d66c100086b4d9b6a81d329"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a538cdc259460b365f406fe0b3a981799aff313dd31d66c100086b4d9b6a81d329">SPELL_AURA_BIND_SIGHT</a></div><div class="ttdeci">@ SPELL_AURA_BIND_SIGHT</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00064">SpellAuraDefines.h:64</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a82ebee9e3cf7eaf2ab892a6eb7796288"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a82ebee9e3cf7eaf2ab892a6eb7796288">AuraEffectHandleModes</a></div><div class="ttdeci">AuraEffectHandleModes</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00039">SpellAuraDefines.h:40</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a82ebee9e3cf7eaf2ab892a6eb7796288a2b4b8f92986980a3905f0c2d299beaae"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a82ebee9e3cf7eaf2ab892a6eb7796288a2b4b8f92986980a3905f0c2d299beaae">AURA_EFFECT_HANDLE_CHANGE_AMOUNT</a></div><div class="ttdeci">@ AURA_EFFECT_HANDLE_CHANGE_AMOUNT</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00044">SpellAuraDefines.h:44</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_a82ebee9e3cf7eaf2ab892a6eb7796288a9db592566b0111486336c591e7a06e2b"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#a82ebee9e3cf7eaf2ab892a6eb7796288a9db592566b0111486336c591e7a06e2b">AURA_EFFECT_HANDLE_REAL</a></div><div class="ttdeci">@ AURA_EFFECT_HANDLE_REAL</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00042">SpellAuraDefines.h:42</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_ab37150561c6522271a12b3ea9778fe24a22252331a1f6efa27b043fa107a2b6e9"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#ab37150561c6522271a12b3ea9778fe24a22252331a1f6efa27b043fa107a2b6e9">AFLAG_POSITIVE</a></div><div class="ttdeci">@ AFLAG_POSITIVE</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00031">SpellAuraDefines.h:31</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_ab37150561c6522271a12b3ea9778fe24a8164f31786209a706f519d4e4256d66f"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#ab37150561c6522271a12b3ea9778fe24a8164f31786209a706f519d4e4256d66f">AFLAG_NONE</a></div><div class="ttdeci">@ AFLAG_NONE</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00026">SpellAuraDefines.h:26</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_ab37150561c6522271a12b3ea9778fe24a8b96c862bd69c042bbfe15b27fe32edd"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#ab37150561c6522271a12b3ea9778fe24a8b96c862bd69c042bbfe15b27fe32edd">AFLAG_NEGATIVE</a></div><div class="ttdeci">@ AFLAG_NEGATIVE</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00035">SpellAuraDefines.h:34</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_ab37150561c6522271a12b3ea9778fe24aa45c6dd1c787f9a244b1da6a457992a6"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#ab37150561c6522271a12b3ea9778fe24aa45c6dd1c787f9a244b1da6a457992a6">AFLAG_CASTER</a></div><div class="ttdeci">@ AFLAG_CASTER</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00030">SpellAuraDefines.h:30</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_ab37150561c6522271a12b3ea9778fe24af073599f1b898caf7f3b146e399040b4"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#ab37150561c6522271a12b3ea9778fe24af073599f1b898caf7f3b146e399040b4">AFLAG_DURATION</a></div><div class="ttdeci">@ AFLAG_DURATION</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00032">SpellAuraDefines.h:32</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_ade4e7c2cbd17c45015f9f70c2a5400b2"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#ade4e7c2cbd17c45015f9f70c2a5400b2">AuraObjectType</a></div><div class="ttdeci">AuraObjectType</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00383">SpellAuraDefines.h:384</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_ade4e7c2cbd17c45015f9f70c2a5400b2a51cd79314936d46d8bc738a8c1207ab4"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#ade4e7c2cbd17c45015f9f70c2a5400b2a51cd79314936d46d8bc738a8c1207ab4">DYNOBJ_AURA_TYPE</a></div><div class="ttdeci">@ DYNOBJ_AURA_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00386">SpellAuraDefines.h:386</a></div></div>
<div class="ttc" id="a_spell_aura_defines_8h_html_ade4e7c2cbd17c45015f9f70c2a5400b2a9db32fb1dd13d77afd835d5bb6f5d379"><div class="ttname"><a href="../../d7/d5a/_spell_aura_defines_8h.html#ade4e7c2cbd17c45015f9f70c2a5400b2a9db32fb1dd13d77afd835d5bb6f5d379">UNIT_AURA_TYPE</a></div><div class="ttdeci">@ UNIT_AURA_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/_spell_aura_defines_8h_source.html#l00385">SpellAuraDefines.h:385</a></div></div>
<div class="ttc" id="a_spell_aura_effects_8h_html"><div class="ttname"><a href="../../db/d82/_spell_aura_effects_8h.html">SpellAuraEffects.h</a></div></div>
<div class="ttc" id="a_spell_auras_8cpp_html_a49c1eff45f8eb67e523f8593923a5df0"><div class="ttname"><a href="../../d7/db3/_spell_auras_8cpp.html#a49c1eff45f8eb67e523f8593923a5df0">UPDATE_TARGET_MAP_INTERVAL</a></div><div class="ttdeci">static constexpr int32 UPDATE_TARGET_MAP_INTERVAL</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00040">SpellAuras.cpp:40</a></div></div>
<div class="ttc" id="a_spell_info_8h_html_a93795b2131c8cbe38a7b23768a5a146da23162f829e73ed8653b153a3e5212a39"><div class="ttname"><a href="../../dc/d70/_spell_info_8h.html#a93795b2131c8cbe38a7b23768a5a146da23162f829e73ed8653b153a3e5212a39">SPELL_ATTR0_CU_ENCHANT_PROC</a></div><div class="ttdeci">@ SPELL_ATTR0_CU_ENCHANT_PROC</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00176">SpellInfo.h:176</a></div></div>
<div class="ttc" id="a_spell_info_8h_html_a93795b2131c8cbe38a7b23768a5a146da4d7ba94d96c89ebddcef8c081fb14557"><div class="ttname"><a href="../../dc/d70/_spell_info_8h.html#a93795b2131c8cbe38a7b23768a5a146da4d7ba94d96c89ebddcef8c081fb14557">SPELL_ATTR0_CU_FORCE_AURA_SAVING</a></div><div class="ttdeci">@ SPELL_ATTR0_CU_FORCE_AURA_SAVING</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00205">SpellInfo.h:205</a></div></div>
<div class="ttc" id="a_spell_info_8h_html_a93795b2131c8cbe38a7b23768a5a146da779378cdabb274a575287575fa8bc912"><div class="ttname"><a href="../../dc/d70/_spell_info_8h.html#a93795b2131c8cbe38a7b23768a5a146da779378cdabb274a575287575fa8bc912">SPELL_ATTR0_CU_REJECT_AURA_SAVING</a></div><div class="ttdeci">@ SPELL_ATTR0_CU_REJECT_AURA_SAVING</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00204">SpellInfo.h:204</a></div></div>
<div class="ttc" id="a_spell_info_8h_html_a967f80d0c19acebc2e322c73b7b16442"><div class="ttname"><a href="../../dc/d70/_spell_info_8h.html#a967f80d0c19acebc2e322c73b7b16442">SpellSpecificType</a></div><div class="ttdeci">SpellSpecificType</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00148">SpellInfo.h:149</a></div></div>
<div class="ttc" id="a_spell_info_8h_html_a967f80d0c19acebc2e322c73b7b16442a7fec7caa0a8ef5d84d2c896a2e06520f"><div class="ttname"><a href="../../dc/d70/_spell_info_8h.html#a967f80d0c19acebc2e322c73b7b16442a7fec7caa0a8ef5d84d2c896a2e06520f">SPELL_SPECIFIC_JUDGEMENT</a></div><div class="ttdeci">@ SPELL_SPECIFIC_JUDGEMENT</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00161">SpellInfo.h:161</a></div></div>
<div class="ttc" id="a_spell_info_8h_html_a967f80d0c19acebc2e322c73b7b16442a8b31c1d8a369ac3bfa30c9e5b9b10ffa"><div class="ttname"><a href="../../dc/d70/_spell_info_8h.html#a967f80d0c19acebc2e322c73b7b16442a8b31c1d8a369ac3bfa30c9e5b9b10ffa">SPELL_SPECIFIC_AURA</a></div><div class="ttdeci">@ SPELL_SPECIFIC_AURA</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00152">SpellInfo.h:152</a></div></div>
<div class="ttc" id="a_spell_info_8h_html_a967f80d0c19acebc2e322c73b7b16442ab739709876cc712a09e288c112b7d128"><div class="ttname"><a href="../../dc/d70/_spell_info_8h.html#a967f80d0c19acebc2e322c73b7b16442ab739709876cc712a09e288c112b7d128">SPELL_SPECIFIC_MAGE_POLYMORPH</a></div><div class="ttdeci">@ SPELL_SPECIFIC_MAGE_POLYMORPH</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00160">SpellInfo.h:160</a></div></div>
<div class="ttc" id="a_spell_mgr_8h_html"><div class="ttname"><a href="../../d3/d75/_spell_mgr_8h.html">SpellMgr.h</a></div></div>
<div class="ttc" id="a_spell_mgr_8h_html_a3384f828e7f362dbdaecb22673641c88"><div class="ttname"><a href="../../d3/d75/_spell_mgr_8h.html#a3384f828e7f362dbdaecb22673641c88">SpellGroupStackFlags</a></div><div class="ttdeci">SpellGroupStackFlags</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d75/_spell_mgr_8h_source.html#l00344">SpellMgr.h:345</a></div></div>
<div class="ttc" id="a_spell_mgr_8h_html_a3384f828e7f362dbdaecb22673641c88a3556b4b6eac1a9cc343a58851626cc35"><div class="ttname"><a href="../../d3/d75/_spell_mgr_8h.html#a3384f828e7f362dbdaecb22673641c88a3556b4b6eac1a9cc343a58851626cc35">SPELL_GROUP_STACK_FLAG_EXCLUSIVE</a></div><div class="ttdeci">@ SPELL_GROUP_STACK_FLAG_EXCLUSIVE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d75/_spell_mgr_8h_source.html#l00347">SpellMgr.h:347</a></div></div>
<div class="ttc" id="a_spell_mgr_8h_html_a3384f828e7f362dbdaecb22673641c88a4cfbddea486e9940cbeb5ebdab267b3e"><div class="ttname"><a href="../../d3/d75/_spell_mgr_8h.html#a3384f828e7f362dbdaecb22673641c88a4cfbddea486e9940cbeb5ebdab267b3e">SPELL_GROUP_STACK_FLAG_FORCED_WEAKEST</a></div><div class="ttdeci">@ SPELL_GROUP_STACK_FLAG_FORCED_WEAKEST</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d75/_spell_mgr_8h_source.html#l00356">SpellMgr.h:356</a></div></div>
<div class="ttc" id="a_spell_mgr_8h_html_a3384f828e7f362dbdaecb22673641c88a657ce08869043f0b71ee8815c6fb869e"><div class="ttname"><a href="../../d3/d75/_spell_mgr_8h.html#a3384f828e7f362dbdaecb22673641c88a657ce08869043f0b71ee8815c6fb869e">SPELL_GROUP_STACK_FLAG_FORCED_STRONGEST</a></div><div class="ttdeci">@ SPELL_GROUP_STACK_FLAG_FORCED_STRONGEST</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d75/_spell_mgr_8h_source.html#l00355">SpellMgr.h:355</a></div></div>
<div class="ttc" id="a_spell_mgr_8h_html_a3384f828e7f362dbdaecb22673641c88ab87195d8c88d548d93dc11460e7ebf6a"><div class="ttname"><a href="../../d3/d75/_spell_mgr_8h.html#a3384f828e7f362dbdaecb22673641c88ab87195d8c88d548d93dc11460e7ebf6a">SPELL_GROUP_STACK_FLAG_NOT_SAME_CASTER</a></div><div class="ttdeci">@ SPELL_GROUP_STACK_FLAG_NOT_SAME_CASTER</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d75/_spell_mgr_8h_source.html#l00348">SpellMgr.h:348</a></div></div>
<div class="ttc" id="a_spell_mgr_8h_html_a3384f828e7f362dbdaecb22673641c88adf0c38d0364b5e9c36aa3bf4f68da680"><div class="ttname"><a href="../../d3/d75/_spell_mgr_8h.html#a3384f828e7f362dbdaecb22673641c88adf0c38d0364b5e9c36aa3bf4f68da680">SPELL_GROUP_STACK_FLAG_NEVER_STACK</a></div><div class="ttdeci">@ SPELL_GROUP_STACK_FLAG_NEVER_STACK</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d75/_spell_mgr_8h_source.html#l00350">SpellMgr.h:350</a></div></div>
<div class="ttc" id="a_spell_mgr_8h_html_a3384f828e7f362dbdaecb22673641c88ae78c94e5be26a7c2c8f4dcd4d22c9036"><div class="ttname"><a href="../../d3/d75/_spell_mgr_8h.html#a3384f828e7f362dbdaecb22673641c88ae78c94e5be26a7c2c8f4dcd4d22c9036">SPELL_GROUP_STACK_FLAG_EFFECT_EXCLUSIVE</a></div><div class="ttdeci">@ SPELL_GROUP_STACK_FLAG_EFFECT_EXCLUSIVE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d75/_spell_mgr_8h_source.html#l00351">SpellMgr.h:351</a></div></div>
<div class="ttc" id="a_spell_mgr_8h_html_a69bbd3906e9d334176d6a0ffde617490"><div class="ttname"><a href="../../d3/d75/_spell_mgr_8h.html#a69bbd3906e9d334176d6a0ffde617490">SpellAreaForAreaMapBounds</a></div><div class="ttdeci">std::pair&lt; SpellAreaForAreaMap::const_iterator, SpellAreaForAreaMap::const_iterator &gt; SpellAreaForAreaMapBounds</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d75/_spell_mgr_8h_source.html#l00534">SpellMgr.h:534</a></div></div>
<div class="ttc" id="a_spell_mgr_8h_html_aa21e14d8e1145507b746a69b5487109d"><div class="ttname"><a href="../../d3/d75/_spell_mgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a></div><div class="ttdeci">#define sSpellMgr</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d75/_spell_mgr_8h_source.html#l00794">SpellMgr.h:794</a></div></div>
<div class="ttc" id="a_spell_mgr_8h_html_ab05dedebdd8cfd6f2028ccc48bd240ddaa3391be8356e56c204b6a35987068fb0"><div class="ttname"><a href="../../d3/d75/_spell_mgr_8h.html#ab05dedebdd8cfd6f2028ccc48bd240ddaa3391be8356e56c204b6a35987068fb0">SPELL_LINK_AURA</a></div><div class="ttdeci">@ SPELL_LINK_AURA</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d75/_spell_mgr_8h_source.html#l00098">SpellMgr.h:98</a></div></div>
<div class="ttc" id="a_spell_mgr_8h_html_ab9f8654c03ec40ac9bdc5214da99e1eb"><div class="ttname"><a href="../../d3/d75/_spell_mgr_8h.html#ab9f8654c03ec40ac9bdc5214da99e1eb">SpellGroupSpecialFlags</a></div><div class="ttdeci">SpellGroupSpecialFlags</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d75/_spell_mgr_8h_source.html#l00325">SpellMgr.h:326</a></div></div>
<div class="ttc" id="a_spell_mgr_8h_html_ab9f8654c03ec40ac9bdc5214da99e1eba1241df11023c863e2de7d3371c703d76"><div class="ttname"><a href="../../d3/d75/_spell_mgr_8h.html#ab9f8654c03ec40ac9bdc5214da99e1eba1241df11023c863e2de7d3371c703d76">SPELL_GROUP_SPECIAL_FLAG_PRIORITY1</a></div><div class="ttdeci">@ SPELL_GROUP_SPECIAL_FLAG_PRIORITY1</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d75/_spell_mgr_8h_source.html#l00336">SpellMgr.h:336</a></div></div>
<div class="ttc" id="a_spell_script_8h_html"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html">SpellScript.h</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236a01bccb65044d0e5ccab470539e8a71a3"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a01bccb65044d0e5ccab470539e8a71a3">AURA_SCRIPT_HOOK_EFFECT_CALC_PERIODIC</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_EFFECT_CALC_PERIODIC</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00490">SpellScript.h:490</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236a12c382920aa6890efbc36805fc32e25a"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a12c382920aa6890efbc36805fc32e25a">AURA_SCRIPT_HOOK_EFFECT_CALC_AMOUNT</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_EFFECT_CALC_AMOUNT</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00489">SpellScript.h:489</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236a1794d2594c7b6dfe59a79a48aba6f142"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a1794d2594c7b6dfe59a79a48aba6f142">AURA_SCRIPT_HOOK_EFFECT_REMOVE</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_EFFECT_REMOVE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00485">SpellScript.h:485</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236a2ef312bd29f036eb8b15fedd4d2bc082"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a2ef312bd29f036eb8b15fedd4d2bc082">AURA_SCRIPT_HOOK_EFFECT_AFTER_MANASHIELD</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_EFFECT_AFTER_MANASHIELD</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00495">SpellScript.h:495</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236a35f3fc9519440c5f846a1cb2789706df"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a35f3fc9519440c5f846a1cb2789706df">AURA_SCRIPT_HOOK_PREPARE_PROC</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_PREPARE_PROC</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00502">SpellScript.h:502</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236a3d296fe0adb2f6f3c0ae690ef48e0626"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a3d296fe0adb2f6f3c0ae690ef48e0626">AURA_SCRIPT_HOOK_EFFECT_AFTER_APPLY</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_EFFECT_AFTER_APPLY</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00484">SpellScript.h:484</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236a419d135d3d232ceabcb89fba6b5cc2b1"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a419d135d3d232ceabcb89fba6b5cc2b1">AURA_SCRIPT_HOOK_EFFECT_AFTER_REMOVE</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_EFFECT_AFTER_REMOVE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00486">SpellScript.h:486</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236a4bfd62ef873930a2ed1f6da09b85296d"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a4bfd62ef873930a2ed1f6da09b85296d">AURA_SCRIPT_HOOK_AFTER_PROC</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_AFTER_PROC</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00506">SpellScript.h:506</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236a59cf037b8b521ba0958c29e7a8a4c262"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a59cf037b8b521ba0958c29e7a8a4c262">AURA_SCRIPT_HOOK_CHECK_AREA_TARGET</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_CHECK_AREA_TARGET</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00497">SpellScript.h:497</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236a67050daee69746f58a49b0f131a4a4de"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a67050daee69746f58a49b0f131a4a4de">AURA_SCRIPT_HOOK_EFFECT_MANASHIELD</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_EFFECT_MANASHIELD</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00494">SpellScript.h:494</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236a7ab83bc59e26f2a76b49c41feebe0726"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a7ab83bc59e26f2a76b49c41feebe0726">AURA_SCRIPT_HOOK_PROC</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_PROC</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00503">SpellScript.h:503</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236a9bab1f8dcc1dccde2a98e7f492c9d5a9"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a9bab1f8dcc1dccde2a98e7f492c9d5a9">AURA_SCRIPT_HOOK_EFFECT_AFTER_ABSORB</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_EFFECT_AFTER_ABSORB</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00493">SpellScript.h:493</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236a9c2d093615242927901d1c4c256212b2"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236a9c2d093615242927901d1c4c256212b2">AURA_SCRIPT_HOOK_DISPEL</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_DISPEL</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00498">SpellScript.h:498</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236aa70d783c590006f1a8cbf2b3d144e94c"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236aa70d783c590006f1a8cbf2b3d144e94c">AURA_SCRIPT_HOOK_EFFECT_APPLY</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_EFFECT_APPLY</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00483">SpellScript.h:483</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236aaf214dbb6995dfa6ae911fa471484b01"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236aaf214dbb6995dfa6ae911fa471484b01">AURA_SCRIPT_HOOK_EFFECT_PERIODIC</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_EFFECT_PERIODIC</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00487">SpellScript.h:487</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236ab303f97a56ee2f3d7ecd4e7a7950236c"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236ab303f97a56ee2f3d7ecd4e7a7950236c">AURA_SCRIPT_HOOK_EFFECT_AFTER_PROC</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_EFFECT_AFTER_PROC</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00505">SpellScript.h:505</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236ac1dc8a3040268f42f5fbce32d51c71e3"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236ac1dc8a3040268f42f5fbce32d51c71e3">AURA_SCRIPT_HOOK_EFFECT_ABSORB</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_EFFECT_ABSORB</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00492">SpellScript.h:492</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236ac81ead411b37d2496c7a9993f339a39d"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236ac81ead411b37d2496c7a9993f339a39d">AURA_SCRIPT_HOOK_EFFECT_PROC</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_EFFECT_PROC</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00504">SpellScript.h:504</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236aca91b48c557565055039bb70ba1fd2eb"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236aca91b48c557565055039bb70ba1fd2eb">AURA_SCRIPT_HOOK_EFFECT_SPLIT</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_EFFECT_SPLIT</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00496">SpellScript.h:496</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236ad09bca933a358610ff271989afdc2f9a"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236ad09bca933a358610ff271989afdc2f9a">AURA_SCRIPT_HOOK_EFFECT_CALC_SPELLMOD</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_EFFECT_CALC_SPELLMOD</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00491">SpellScript.h:491</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236adc21054212f2fda577059533337ff63a"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236adc21054212f2fda577059533337ff63a">AURA_SCRIPT_HOOK_AFTER_DISPEL</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_AFTER_DISPEL</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00499">SpellScript.h:499</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236add4f24c7c71aa1892b4f7aa25f162420"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236add4f24c7c71aa1892b4f7aa25f162420">AURA_SCRIPT_HOOK_CHECK_PROC</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_CHECK_PROC</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00501">SpellScript.h:501</a></div></div>
<div class="ttc" id="a_spell_script_8h_html_a0106a0551a3a660c390c8335a1655236aef9114d2ad5df80081d2e5fce725a352"><div class="ttname"><a href="../../d1/df6/_spell_script_8h.html#a0106a0551a3a660c390c8335a1655236aef9114d2ad5df80081d2e5fce725a352">AURA_SCRIPT_HOOK_EFFECT_UPDATE_PERIODIC</a></div><div class="ttdeci">@ AURA_SCRIPT_HOOK_EFFECT_UPDATE_PERIODIC</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00488">SpellScript.h:488</a></div></div>
<div class="ttc" id="a_unit_8h_html"><div class="ttname"><a href="../../d5/d32/_unit_8h.html">Unit.h</a></div></div>
<div class="ttc" id="a_unit_8h_html_a2a35652af7129b6f139b0f7a2af1876aa052681ec165e5b5e3edcf2089607ae67"><div class="ttname"><a href="../../d5/d32/_unit_8h.html#a2a35652af7129b6f139b0f7a2af1876aa052681ec165e5b5e3edcf2089607ae67">OFF_ATTACK</a></div><div class="ttdeci">@ OFF_ATTACK</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00556">Unit.h:556</a></div></div>
<div class="ttc" id="a_unit_8h_html_a2a35652af7129b6f139b0f7a2af1876aa5145c1138a6f21d47061e9015e07a3ae"><div class="ttname"><a href="../../d5/d32/_unit_8h.html#a2a35652af7129b6f139b0f7a2af1876aa5145c1138a6f21d47061e9015e07a3ae">BASE_ATTACK</a></div><div class="ttdeci">@ BASE_ATTACK</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00555">Unit.h:555</a></div></div>
<div class="ttc" id="a_unit_8h_html_a39b60e1f12cca9b6873cb817e7717351a0ed7ea54baf4ab31426eac33358a734b"><div class="ttname"><a href="../../d5/d32/_unit_8h.html#a39b60e1f12cca9b6873cb817e7717351a0ed7ea54baf4ab31426eac33358a734b">SPELLMOD_CHANCE_OF_SUCCESS</a></div><div class="ttdeci">@ SPELLMOD_CHANCE_OF_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00103">Unit.h:103</a></div></div>
<div class="ttc" id="a_unit_8h_html_a39b60e1f12cca9b6873cb817e7717351abbf47ed0b69b726537ecd64649c0d73c"><div class="ttname"><a href="../../d5/d32/_unit_8h.html#a39b60e1f12cca9b6873cb817e7717351abbf47ed0b69b726537ecd64649c0d73c">SPELLMOD_DURATION</a></div><div class="ttdeci">@ SPELLMOD_DURATION</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00086">Unit.h:86</a></div></div>
<div class="ttc" id="a_unit_8h_html_a39b60e1f12cca9b6873cb817e7717351ae8f4e49f8ba63fb75c0c151d851b5bae"><div class="ttname"><a href="../../d5/d32/_unit_8h.html#a39b60e1f12cca9b6873cb817e7717351ae8f4e49f8ba63fb75c0c151d851b5bae">SPELLMOD_CHARGES</a></div><div class="ttdeci">@ SPELLMOD_CHARGES</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00089">Unit.h:89</a></div></div>
<div class="ttc" id="a_unit_8h_html_a39b60e1f12cca9b6873cb817e7717351afeabfe64507fbc8262484ccb76f4bf49"><div class="ttname"><a href="../../d5/d32/_unit_8h.html#a39b60e1f12cca9b6873cb817e7717351afeabfe64507fbc8262484ccb76f4bf49">SPELLMOD_RESIST_DISPEL_CHANCE</a></div><div class="ttdeci">@ SPELLMOD_RESIST_DISPEL_CHANCE</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00113">Unit.h:113</a></div></div>
<div class="ttc" id="a_unit_8h_html_a9a4f502870485ba32e759067c9adca94"><div class="ttname"><a href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94">AuraRemoveMode</a></div><div class="ttdeci">AuraRemoveMode</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00384">Unit.h:385</a></div></div>
<div class="ttc" id="a_unit_8h_html_a9a4f502870485ba32e759067c9adca94a1d65b866fb33f41d71498231aeb4e6e5"><div class="ttname"><a href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94a1d65b866fb33f41d71498231aeb4e6e5">AURA_REMOVE_NONE</a></div><div class="ttdeci">@ AURA_REMOVE_NONE</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00386">Unit.h:386</a></div></div>
<div class="ttc" id="a_unit_8h_html_a9a4f502870485ba32e759067c9adca94a51dd2d6d8e90e4ea4113c02fb772b80c"><div class="ttname"><a href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94a51dd2d6d8e90e4ea4113c02fb772b80c">AURA_REMOVE_BY_DEFAULT</a></div><div class="ttdeci">@ AURA_REMOVE_BY_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00387">Unit.h:387</a></div></div>
<div class="ttc" id="a_unit_8h_html_a9a4f502870485ba32e759067c9adca94a8b8b753a1458a21a162528088acee913"><div class="ttname"><a href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94a8b8b753a1458a21a162528088acee913">AURA_REMOVE_BY_DEATH</a></div><div class="ttdeci">@ AURA_REMOVE_BY_DEATH</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00392">Unit.h:391</a></div></div>
<div class="ttc" id="a_unit_8h_html_a9a4f502870485ba32e759067c9adca94a9ca05b22853d12d44ac7e80a9e864a10"><div class="ttname"><a href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94a9ca05b22853d12d44ac7e80a9e864a10">AURA_REMOVE_BY_EXPIRE</a></div><div class="ttdeci">@ AURA_REMOVE_BY_EXPIRE</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00390">Unit.h:390</a></div></div>
<div class="ttc" id="a_unit_8h_html_a9a4f502870485ba32e759067c9adca94aa40c81252e354a16d6f036827c872e12"><div class="ttname"><a href="../../d5/d32/_unit_8h.html#a9a4f502870485ba32e759067c9adca94aa40c81252e354a16d6f036827c872e12">AURA_REMOVE_BY_ENEMY_SPELL</a></div><div class="ttdeci">@ AURA_REMOVE_BY_ENEMY_SPELL</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00389">Unit.h:389</a></div></div>
<div class="ttc" id="a_unit_8h_html_abbe331960980fa852a0be15ccebef947"><div class="ttname"><a href="../../d5/d32/_unit_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a></div><div class="ttdeci">std::list&lt; Unit * &gt; UnitList</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00349">Unit.h:347</a></div></div>
<div class="ttc" id="a_unit_8h_html_ae51d2ecb71f7a5cb3882982a622c9544a7c4ae74029844364315885e02df35505"><div class="ttname"><a href="../../d5/d32/_unit_8h.html#ae51d2ecb71f7a5cb3882982a622c9544a7c4ae74029844364315885e02df35505">UNIT_STATE_ISOLATED</a></div><div class="ttdeci">@ UNIT_STATE_ISOLATED</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00497">Unit.h:497</a></div></div>
<div class="ttc" id="a_unit_8h_html_aff59f402d05917ab1de0c5f6bf148ea4a87fdcd2ffa8f71b49da9e0cfd4fb893f"><div class="ttname"><a href="../../d5/d32/_unit_8h.html#aff59f402d05917ab1de0c5f6bf148ea4a87fdcd2ffa8f71b49da9e0cfd4fb893f">DOT</a></div><div class="ttdeci">@ DOT</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00596">Unit.h:596</a></div></div>
<div class="ttc" id="a_update_fields_8h_html_a0e42dc606678c9df7884e1aad621e881a5662db4f743b497fc17de3f73e4e9235"><div class="ttname"><a href="../../dd/d65/_update_fields_8h.html#a0e42dc606678c9df7884e1aad621e881a5662db4f743b497fc17de3f73e4e9235">UNIT_MOD_CAST_SPEED</a></div><div class="ttdeci">@ UNIT_MOD_CAST_SPEED</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d65/_update_fields_8h_source.html#l00137">UpdateFields.h:137</a></div></div>
<div class="ttc" id="a_vehicle_8h_html"><div class="ttname"><a href="../../df/d90/_vehicle_8h.html">Vehicle.h</a></div></div>
<div class="ttc" id="a_world_packet_8h_html"><div class="ttname"><a href="../../db/d66/_world_packet_8h.html">WorldPacket.h</a></div></div>
<div class="ttc" id="achrono_8h_html_ade692a13be7c7dfac09a8ff2fd00d172"><div class="ttname"><a href="../../dd/d90/chrono_8h.html#ade692a13be7c7dfac09a8ff2fd00d172">mod</a></div><div class="ttdeci">T mod(T x, int y)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d90/chrono_8h_source.html#l00822">chrono.h:822</a></div></div>
<div class="ttc" id="aclass_acore_1_1_any_ao_e_target_unit_in_object_range_check_html"><div class="ttname"><a href="../../df/db4/class_acore_1_1_any_ao_e_target_unit_in_object_range_check.html">Acore::AnyAoETargetUnitInObjectRangeCheck</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dc9/_grid_notifiers_8h_source.html#l00968">GridNotifiers.h:969</a></div></div>
<div class="ttc" id="aclass_acore_1_1_any_attackable_unit_except_for_original_caster_in_object_range_check_html"><div class="ttname"><a href="../../d6/d09/class_acore_1_1_any_attackable_unit_except_for_original_caster_in_object_range_check.html">Acore::AnyAttackableUnitExceptForOriginalCasterInObjectRangeCheck</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dc9/_grid_notifiers_8h_source.html#l01001">GridNotifiers.h:1002</a></div></div>
<div class="ttc" id="aclass_acore_1_1_any_friendly_unit_in_object_range_check_html"><div class="ttname"><a href="../../d6/dc1/class_acore_1_1_any_friendly_unit_in_object_range_check.html">Acore::AnyFriendlyUnitInObjectRangeCheck</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dc9/_grid_notifiers_8h_source.html#l00867">GridNotifiers.h:868</a></div></div>
<div class="ttc" id="aclass_acore_1_1_any_grouped_unit_in_object_range_check_html"><div class="ttname"><a href="../../dc/dc0/class_acore_1_1_any_grouped_unit_in_object_range_check.html">Acore::AnyGroupedUnitInObjectRangeCheck</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dc9/_grid_notifiers_8h_source.html#l00903">GridNotifiers.h:904</a></div></div>
<div class="ttc" id="aclass_aura_application_html"><div class="ttname"><a href="../../d8/da3/class_aura_application.html">AuraApplication</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00036">SpellAuras.h:37</a></div></div>
<div class="ttc" id="aclass_aura_application_html_a051b0814a63b9398b523a6bfd23998d2"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#a051b0814a63b9398b523a6bfd23998d2">AuraApplication::IsActive</a></div><div class="ttdeci">bool IsActive(uint8 effIdx)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00081">SpellAuras.h:81</a></div></div>
<div class="ttc" id="aclass_aura_application_html_a233ba733e1634be3a745665de8925e25"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#a233ba733e1634be3a745665de8925e25">AuraApplication::_slot</a></div><div class="ttdeci">uint8 _slot</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00047">SpellAuras.h:47</a></div></div>
<div class="ttc" id="aclass_aura_application_html_a45c36a5104886209be9fb1819924f106"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#a45c36a5104886209be9fb1819924f106">AuraApplication::ClientUpdate</a></div><div class="ttdeci">void ClientUpdate(bool remove=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00276">SpellAuras.cpp:276</a></div></div>
<div class="ttc" id="aclass_aura_application_html_a48f6d82daf06f6f2ced98484c2b56248"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#a48f6d82daf06f6f2ced98484c2b56248">AuraApplication::GetTarget</a></div><div class="ttdeci">Unit * GetTarget() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00061">SpellAuras.h:61</a></div></div>
<div class="ttc" id="aclass_aura_application_html_a4af52f837bff39572c28eea21ccb6b80"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#a4af52f837bff39572c28eea21ccb6b80">AuraApplication::BuildUpdatePacket</a></div><div class="ttdeci">void BuildUpdatePacket(ByteBuffer &amp;data, bool remove) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00243">SpellAuras.cpp:243</a></div></div>
<div class="ttc" id="aclass_aura_application_html_a5c7a5164ed0a58b967de33c5fc578292"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#a5c7a5164ed0a58b967de33c5fc578292">AuraApplication::_effectsToApply</a></div><div class="ttdeci">uint8 _effectsToApply</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00049">SpellAuras.h:49</a></div></div>
<div class="ttc" id="aclass_aura_application_html_a5e3618ecbc81ed6d23dec9db84729126"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#a5e3618ecbc81ed6d23dec9db84729126">AuraApplication::_needClientUpdate</a></div><div class="ttdeci">bool _needClientUpdate</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00050">SpellAuras.h:50</a></div></div>
<div class="ttc" id="aclass_aura_application_html_a5f37e8e4c660272fa2e73721604b7e97"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#a5f37e8e4c660272fa2e73721604b7e97">AuraApplication::GetEffectMask</a></div><div class="ttdeci">uint8 GetEffectMask() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00066">SpellAuras.h:66</a></div></div>
<div class="ttc" id="aclass_aura_application_html_a6319e8a7e0abd0e572f41c099378b5da"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#a6319e8a7e0abd0e572f41c099378b5da">AuraApplication::_HandleEffect</a></div><div class="ttdeci">void _HandleEffect(uint8 effIndex, bool apply)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00156">SpellAuras.cpp:156</a></div></div>
<div class="ttc" id="aclass_aura_application_html_a6beb5bdaa8621586c7ff7ca0b436a30c"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#a6beb5bdaa8621586c7ff7ca0b436a30c">AuraApplication::_InitFlags</a></div><div class="ttdeci">void _InitFlags(Unit *caster, uint8 effMask)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00119">SpellAuras.cpp:119</a></div></div>
<div class="ttc" id="aclass_aura_application_html_a9025ca75394343521cf0a7c3d454adc5"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#a9025ca75394343521cf0a7c3d454adc5">AuraApplication::RemoveDisableMask</a></div><div class="ttdeci">void RemoveDisableMask(uint8 effIdx)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00083">SpellAuras.h:83</a></div></div>
<div class="ttc" id="aclass_aura_application_html_a99ef59ad583a7802b21f6799d58d2017"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#a99ef59ad583a7802b21f6799d58d2017">AuraApplication::_Remove</a></div><div class="ttdeci">void _Remove()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00089">SpellAuras.cpp:89</a></div></div>
<div class="ttc" id="aclass_aura_application_html_aa47dcf75b9d9676aee31bab4dbdb92aa"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#aa47dcf75b9d9676aee31bab4dbdb92aa">AuraApplication::IsSelfcasted</a></div><div class="ttdeci">bool IsSelfcasted() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00069">SpellAuras.h:69</a></div></div>
<div class="ttc" id="aclass_aura_application_html_ab216ef41e9d7370cb5fcfce7d42f84cc"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#ab216ef41e9d7370cb5fcfce7d42f84cc">AuraApplication::GetSlot</a></div><div class="ttdeci">uint8 GetSlot() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00064">SpellAuras.h:64</a></div></div>
<div class="ttc" id="aclass_aura_application_html_abb45aa5fa55c1e566e16022a972d72d6"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#abb45aa5fa55c1e566e16022a972d72d6">AuraApplication::_flags</a></div><div class="ttdeci">uint8 _flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00048">SpellAuras.h:48</a></div></div>
<div class="ttc" id="aclass_aura_application_html_ace7adda123954ef4cd5c5f9837b9708a"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#ace7adda123954ef4cd5c5f9837b9708a">AuraApplication::AuraApplication</a></div><div class="ttdeci">AuraApplication(Unit *target, Unit *caster, Aura *base, uint8 effMask)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00042">SpellAuras.cpp:42</a></div></div>
<div class="ttc" id="aclass_aura_application_html_ad0af1e6d6bb19f80390e65e26e3a8b48"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#ad0af1e6d6bb19f80390e65e26e3a8b48">AuraApplication::GetBase</a></div><div class="ttdeci">Aura * GetBase() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00062">SpellAuras.h:62</a></div></div>
<div class="ttc" id="aclass_aura_application_html_ad15259f132b607f215d94e43ddd69009"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#ad15259f132b607f215d94e43ddd69009">AuraApplication::SetNeedClientUpdate</a></div><div class="ttdeci">void SetNeedClientUpdate()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00075">SpellAuras.h:75</a></div></div>
<div class="ttc" id="aclass_aura_application_html_ae6b921446fc7901f8f053e19c3fb3f4c"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#ae6b921446fc7901f8f053e19c3fb3f4c">AuraApplication::GetRemoveMode</a></div><div class="ttdeci">AuraRemoveMode GetRemoveMode() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00073">SpellAuras.h:73</a></div></div>
<div class="ttc" id="aclass_aura_application_html_af3e44cda4fe299e5bf2ba8ca37142cba"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#af3e44cda4fe299e5bf2ba8ca37142cba">AuraApplication::HasEffect</a></div><div class="ttdeci">bool HasEffect(uint8 effect) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00067">SpellAuras.h:67</a></div></div>
<div class="ttc" id="aclass_aura_application_html_af9dc1969efa6eb3dbab368a3f09e0f9c"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#af9dc1969efa6eb3dbab368a3f09e0f9c">AuraApplication::_target</a></div><div class="ttdeci">Unit *const _target</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00044">SpellAuras.h:44</a></div></div>
<div class="ttc" id="aclass_aura_application_html_af9f3adb73dfe0cfa9466091bb34e14ae"><div class="ttname"><a href="../../d8/da3/class_aura_application.html#af9f3adb73dfe0cfa9466091bb34e14ae">AuraApplication::SetDisableMask</a></div><div class="ttdeci">void SetDisableMask(uint8 effIdx)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00082">SpellAuras.h:82</a></div></div>
<div class="ttc" id="aclass_aura_effect_html"><div class="ttname"><a href="../../da/df1/class_aura_effect.html">AuraEffect</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d82/_spell_aura_effects_8h_source.html#l00031">SpellAuraEffects.h:32</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_a0417bd1d648cb9d2888937ddad75788c"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#a0417bd1d648cb9d2888937ddad75788c">AuraEffect::GetBase</a></div><div class="ttdeci">Aura * GetBase() const</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d82/_spell_aura_effects_8h_source.html#l00042">SpellAuraEffects.h:42</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_a063903240b281f490908845ef93ec68a"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#a063903240b281f490908845ef93ec68a">AuraEffect::SetEnabled</a></div><div class="ttdeci">void SetEnabled(bool enabled)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d82/_spell_aura_effects_8h_source.html#l00110">SpellAuraEffects.h:110</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_a07673908af178ffaee01353a6d11a703"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#a07673908af178ffaee01353a6d11a703">AuraEffect::ChangeAmount</a></div><div class="ttdeci">void ChangeAmount(int32 newAmount, bool mark=true, bool onStackOrReapply=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d3c/_spell_aura_effects_8cpp_source.html#l00700">SpellAuraEffects.cpp:700</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_a120cf8a45a3c816e4ef588733fa812e5"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#a120cf8a45a3c816e4ef588733fa812e5">AuraEffect::GetAuraType</a></div><div class="ttdeci">AuraType GetAuraType() const</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d3c/_spell_aura_effects_8cpp_source.html#l00446">SpellAuraEffects.cpp:446</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_a1e57c07b017695d76137b0d81074df1e"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#a1e57c07b017695d76137b0d81074df1e">AuraEffect::Update</a></div><div class="ttdeci">void Update(uint32 diff, Unit *caster)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d3c/_spell_aura_effects_8cpp_source.html#l00889">SpellAuraEffects.cpp:889</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_a36e4e8b964658519a723d668b7ad0bba"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#a36e4e8b964658519a723d668b7ad0bba">AuraEffect::GetAuraGroup</a></div><div class="ttdeci">uint32 GetAuraGroup() const</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d82/_spell_aura_effects_8h_source.html#l00107">SpellAuraEffects.h:107</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_a5b0a6694f62bf72c41a1f461f9894581"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#a5b0a6694f62bf72c41a1f461f9894581">AuraEffect::CalculatePeriodic</a></div><div class="ttdeci">void CalculatePeriodic(Unit *caster, bool create=false, bool load=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d3c/_spell_aura_effects_8cpp_source.html#l00586">SpellAuraEffects.cpp:586</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_a5d248ef37c73049cf4df98b6fc1008fe"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#a5d248ef37c73049cf4df98b6fc1008fe">AuraEffect::CalculateSpellMod</a></div><div class="ttdeci">void CalculateSpellMod()</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d3c/_spell_aura_effects_8cpp_source.html#l00676">SpellAuraEffects.cpp:676</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_a63863fb01a8cf08251c0b4482be6a20f"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#a63863fb01a8cf08251c0b4482be6a20f">AuraEffect::GetId</a></div><div class="ttdeci">uint32 GetId() const</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d3c/_spell_aura_effects_8cpp_source.html#l00431">SpellAuraEffects.cpp:431</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_a67ca18798f448847e77665752fa4a32c"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#a67ca18798f448847e77665752fa4a32c">AuraEffect::GetTotalTicks</a></div><div class="ttdeci">int32 GetTotalTicks() const</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d82/_spell_aura_effects_8h_source.html#l00080">SpellAuraEffects.h:80</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_a7710e32fe9dc267292c3b15333521560"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#a7710e32fe9dc267292c3b15333521560">AuraEffect::HandleEffect</a></div><div class="ttdeci">void HandleEffect(AuraApplication *aurApp, uint8 mode, bool apply)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d3c/_spell_aura_effects_8cpp_source.html#l00733">SpellAuraEffects.cpp:733</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_a7d45367044e196745676c63d61fbd89d"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#a7d45367044e196745676c63d61fbd89d">AuraEffect::IsPeriodic</a></div><div class="ttdeci">bool IsPeriodic() const</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d82/_spell_aura_effects_8h_source.html#l00084">SpellAuraEffects.h:84</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_a93f49c4b2f8cabfc0372c8aef24f022e"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#a93f49c4b2f8cabfc0372c8aef24f022e">AuraEffect::GetSpellInfo</a></div><div class="ttdeci">SpellInfo const  * GetSpellInfo() const</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d82/_spell_aura_effects_8h_source.html#l00047">SpellAuraEffects.h:47</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_a9790b9f33c52c6d3b830dc6f56f08bf0"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#a9790b9f33c52c6d3b830dc6f56f08bf0">AuraEffect::SetAmount</a></div><div class="ttdeci">void SetAmount(int32 amount)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d82/_spell_aura_effects_8h_source.html#l00058">SpellAuraEffects.h:58</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_aa183791665930afb43bbac2163b1d8d4"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#aa183791665930afb43bbac2163b1d8d4">AuraEffect::GetMiscValue</a></div><div class="ttdeci">int32 GetMiscValue() const</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d3c/_spell_aura_effects_8cpp_source.html#l00441">SpellAuraEffects.cpp:441</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_ab8c4811ced24cbd9b4afff1c22fbb1b0"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#ab8c4811ced24cbd9b4afff1c22fbb1b0">AuraEffect::GetEffIndex</a></div><div class="ttdeci">uint32 GetEffIndex() const</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d82/_spell_aura_effects_8h_source.html#l00049">SpellAuraEffects.h:49</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_ac313992b1527bbeddf09365da0d28ebc"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#ac313992b1527bbeddf09365da0d28ebc">AuraEffect::CleanupTriggeredSpells</a></div><div class="ttdeci">void CleanupTriggeredSpells(Unit *target)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d3c/_spell_aura_effects_8cpp_source.html#l01167">SpellAuraEffects.cpp:1167</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_ad2a6d0a6fcbf6f5d53633e0d1ab10dd3"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#ad2a6d0a6fcbf6f5d53633e0d1ab10dd3">AuraEffect::HandleProc</a></div><div class="ttdeci">void HandleProc(AuraApplication *aurApp, ProcEventInfo &amp;eventInfo)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d3c/_spell_aura_effects_8cpp_source.html#l01137">SpellAuraEffects.cpp:1137</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_adc38a016285e442a485c9b9bc17a6105"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#adc38a016285e442a485c9b9bc17a6105">AuraEffect::RecalculateAmount</a></div><div class="ttdeci">void RecalculateAmount()</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d82/_spell_aura_effects_8h_source.html#l00068">SpellAuraEffects.h:68</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_af93cf68cd8854d93010663353043e4a2"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#af93cf68cd8854d93010663353043e4a2">AuraEffect::SetCanBeRecalculated</a></div><div class="ttdeci">void SetCanBeRecalculated(bool val)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d82/_spell_aura_effects_8h_source.html#l00071">SpellAuraEffects.h:71</a></div></div>
<div class="ttc" id="aclass_aura_effect_html_afcf272bebf373ad3aebc03cce644cbee"><div class="ttname"><a href="../../da/df1/class_aura_effect.html#afcf272bebf373ad3aebc03cce644cbee">AuraEffect::GetAmount</a></div><div class="ttdeci">int32 GetAmount() const</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d82/_spell_aura_effects_8h_source.html#l00056">SpellAuraEffects.h:56</a></div></div>
<div class="ttc" id="aclass_aura_html"><div class="ttname"><a href="../../d2/dde/class_aura.html">Aura</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00086">SpellAuras.h:87</a></div></div>
<div class="ttc" id="aclass_aura_html_a03c8f1e4156ac6526e401f2a95ad08e7"><div class="ttname"><a href="../../d2/dde/class_aura.html#a03c8f1e4156ac6526e401f2a95ad08e7">Aura::HandleAllEffects</a></div><div class="ttdeci">void HandleAllEffects(AuraApplication *aurApp, uint8 mode, bool apply)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01229">SpellAuras.cpp:1229</a></div></div>
<div class="ttc" id="aclass_aura_html_a04a25715c9b268afa2025a47681df76c"><div class="ttname"><a href="../../d2/dde/class_aura.html#a04a25715c9b268afa2025a47681df76c">Aura::m_removedApplications</a></div><div class="ttdeci">Unit::AuraApplicationList m_removedApplications</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00269">SpellAuras.h:269</a></div></div>
<div class="ttc" id="aclass_aura_html_a068cc46b636b35d317aea47a2de6253e"><div class="ttname"><a href="../../d2/dde/class_aura.html#a068cc46b636b35d317aea47a2de6253e">Aura::_UnapplyForTarget</a></div><div class="ttdeci">virtual void _UnapplyForTarget(Unit *target, Unit *caster, AuraApplication *auraApp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00506">SpellAuras.cpp:506</a></div></div>
<div class="ttc" id="aclass_aura_html_a0b7486aa10607794eaa6739f73b19741"><div class="ttname"><a href="../../d2/dde/class_aura.html#a0b7486aa10607794eaa6739f73b19741">Aura::CanBeSaved</a></div><div class="ttdeci">bool CanBeSaved() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01049">SpellAuras.cpp:1049</a></div></div>
<div class="ttc" id="aclass_aura_html_a1124c642995a40561d7fe23347f0dcdb"><div class="ttname"><a href="../../d2/dde/class_aura.html#a1124c642995a40561d7fe23347f0dcdb">Aura::AddProcCooldown</a></div><div class="ttdeci">void AddProcCooldown(uint32 msec)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02118">SpellAuras.cpp:2118</a></div></div>
<div class="ttc" id="aclass_aura_html_a139193e2e2688d6ea9c6a817c0a00318"><div class="ttname"><a href="../../d2/dde/class_aura.html#a139193e2e2688d6ea9c6a817c0a00318">Aura::CheckAreaTarget</a></div><div class="ttdeci">bool CheckAreaTarget(Unit *target)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01909">SpellAuras.cpp:1909</a></div></div>
<div class="ttc" id="aclass_aura_html_a13f14942fd6394df8e5d8ae820fd3fc7"><div class="ttname"><a href="../../d2/dde/class_aura.html#a13f14942fd6394df8e5d8ae820fd3fc7">Aura::IsArea</a></div><div class="ttdeci">bool IsArea() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01024">SpellAuras.cpp:1024</a></div></div>
<div class="ttc" id="aclass_aura_html_a14457cfa6d589b8024bbeeb1d4aa03d3"><div class="ttname"><a href="../../d2/dde/class_aura.html#a14457cfa6d589b8024bbeeb1d4aa03d3">Aura::GetMaxDuration</a></div><div class="ttdeci">int32 GetMaxDuration() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00129">SpellAuras.h:129</a></div></div>
<div class="ttc" id="aclass_aura_html_a1734994c88d98ccd513b4f8d2f090d70"><div class="ttname"><a href="../../d2/dde/class_aura.html#a1734994c88d98ccd513b4f8d2f090d70">Aura::CallScriptEffectAbsorbHandlers</a></div><div class="ttdeci">void CallScriptEffectAbsorbHandlers(AuraEffect *aurEff, AuraApplication const *aurApp, DamageInfo &amp;dmgInfo, uint32 &amp;absorbAmount, bool &amp;defaultPrevented)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02476">SpellAuras.cpp:2476</a></div></div>
<div class="ttc" id="aclass_aura_html_a1cb0ef5c31c0ebb5e274a99c186e83ab"><div class="ttname"><a href="../../d2/dde/class_aura.html#a1cb0ef5c31c0ebb5e274a99c186e83ab">Aura::CallScriptDispel</a></div><div class="ttdeci">void CallScriptDispel(DispelInfo *dispelInfo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02307">SpellAuras.cpp:2307</a></div></div>
<div class="ttc" id="aclass_aura_html_a1f6c2606d7dc499c1fc1ba0cee1f255b"><div class="ttname"><a href="../../d2/dde/class_aura.html#a1f6c2606d7dc499c1fc1ba0cee1f255b">Aura::SetStackAmount</a></div><div class="ttdeci">void SetStackAmount(uint8 num)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00947">SpellAuras.cpp:947</a></div></div>
<div class="ttc" id="aclass_aura_html_a205938814ca394a9a229f4b4e80e54a6"><div class="ttname"><a href="../../d2/dde/class_aura.html#a205938814ca394a9a229f4b4e80e54a6">Aura::CallScriptEffectCalcSpellModHandlers</a></div><div class="ttdeci">void CallScriptEffectCalcSpellModHandlers(AuraEffect const *aurEff, SpellModifier *&amp;spellMod)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02462">SpellAuras.cpp:2462</a></div></div>
<div class="ttc" id="aclass_aura_html_a24ab9b1f0a73ca4da9aa77e9ee0e3a55"><div class="ttname"><a href="../../d2/dde/class_aura.html#a24ab9b1f0a73ca4da9aa77e9ee0e3a55">Aura::m_maxDuration</a></div><div class="ttdeci">int32 m_maxDuration</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00252">SpellAuras.h:252</a></div></div>
<div class="ttc" id="aclass_aura_html_a2cea44bce63fa2b3fe6fa71905b3e1e2"><div class="ttname"><a href="../../d2/dde/class_aura.html#a2cea44bce63fa2b3fe6fa71905b3e1e2">Aura::m_effects</a></div><div class="ttdeci">AuraEffect * m_effects[3]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00261">SpellAuras.h:261</a></div></div>
<div class="ttc" id="aclass_aura_html_a2ed7d1d11cbc433767ca25c869755f1c"><div class="ttname"><a href="../../d2/dde/class_aura.html#a2ed7d1d11cbc433767ca25c869755f1c">Aura::GetEffect</a></div><div class="ttdeci">AuraEffect * GetEffect(uint8 effIndex) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00174">SpellAuras.h:174</a></div></div>
<div class="ttc" id="aclass_aura_html_a2f108f33766c253a827d41c2f3fdc45e"><div class="ttname"><a href="../../d2/dde/class_aura.html#a2f108f33766c253a827d41c2f3fdc45e">Aura::RefreshDuration</a></div><div class="ttdeci">void RefreshDuration(bool withMods=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00861">SpellAuras.cpp:861</a></div></div>
<div class="ttc" id="aclass_aura_html_a2f182c808ac1ea674dbc625ac03716b6"><div class="ttname"><a href="../../d2/dde/class_aura.html#a2f182c808ac1ea674dbc625ac03716b6">Aura::m_loadedScripts</a></div><div class="ttdeci">std::list&lt; AuraScript * &gt; m_loadedScripts</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00236">SpellAuras.h:236</a></div></div>
<div class="ttc" id="aclass_aura_html_a2fa2b27d98d99af4f226c0156d47a628"><div class="ttname"><a href="../../d2/dde/class_aura.html#a2fa2b27d98d99af4f226c0156d47a628">Aura::RefreshTimers</a></div><div class="ttdeci">void RefreshTimers(bool periodicReset=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00890">SpellAuras.cpp:890</a></div></div>
<div class="ttc" id="aclass_aura_html_a304404f284fba0b6d8dc046140e309ae"><div class="ttname"><a href="../../d2/dde/class_aura.html#a304404f284fba0b6d8dc046140e309ae">Aura::FillTargetMap</a></div><div class="ttdeci">virtual void FillTargetMap(std::map&lt; Unit *, uint8 &gt; &amp;targets, Unit *caster)=0</div></div>
<div class="ttc" id="aclass_aura_html_a323b5e9af786e15e7e1bdac6a47ea359"><div class="ttname"><a href="../../d2/dde/class_aura.html#a323b5e9af786e15e7e1bdac6a47ea359">Aura::CanBeSentToClient</a></div><div class="ttdeci">bool CanBeSentToClient() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01125">SpellAuras.cpp:1125</a></div></div>
<div class="ttc" id="aclass_aura_html_a32cda9926aa3e5d7def42ebf85f23bc8"><div class="ttname"><a href="../../d2/dde/class_aura.html#a32cda9926aa3e5d7def42ebf85f23bc8">Aura::SetTriggeredByAuraSpellInfo</a></div><div class="ttdeci">void SetTriggeredByAuraSpellInfo(SpellInfo const *triggeredByAuraSpellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02648">SpellAuras.cpp:2648</a></div></div>
<div class="ttc" id="aclass_aura_html_a3666518caf5cf301c27857b2e909cf16"><div class="ttname"><a href="../../d2/dde/class_aura.html#a3666518caf5cf301c27857b2e909cf16">Aura::CallScriptCheckAreaTargetHandlers</a></div><div class="ttdeci">bool CallScriptCheckAreaTargetHandlers(Unit *target)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02292">SpellAuras.cpp:2292</a></div></div>
<div class="ttc" id="aclass_aura_html_a37a192c8e0119a8bc304c1711b15376e"><div class="ttname"><a href="../../d2/dde/class_aura.html#a37a192c8e0119a8bc304c1711b15376e">Aura::CallScriptEffectRemoveHandlers</a></div><div class="ttdeci">bool CallScriptEffectRemoveHandlers(AuraEffect const *aurEff, AuraApplication const *aurApp, AuraEffectHandleModes mode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02353">SpellAuras.cpp:2353</a></div></div>
<div class="ttc" id="aclass_aura_html_a38c31b87dea32024c55f15d37faa93da"><div class="ttname"><a href="../../d2/dde/class_aura.html#a38c31b87dea32024c55f15d37faa93da">Aura::CallScriptEffectCalcAmountHandlers</a></div><div class="ttdeci">void CallScriptEffectCalcAmountHandlers(AuraEffect const *aurEff, int32 &amp;amount, bool &amp;canBeRecalculated)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02434">SpellAuras.cpp:2434</a></div></div>
<div class="ttc" id="aclass_aura_html_a3b0854e2019338fd16c9ca46e3997931"><div class="ttname"><a href="../../d2/dde/class_aura.html#a3b0854e2019338fd16c9ca46e3997931">Aura::CallScriptEffectPeriodicHandlers</a></div><div class="ttdeci">bool CallScriptEffectPeriodicHandlers(AuraEffect const *aurEff, AuraApplication const *aurApp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02400">SpellAuras.cpp:2400</a></div></div>
<div class="ttc" id="aclass_aura_html_a3bac8c34612850e65cd2411f2c7b6baa"><div class="ttname"><a href="../../d2/dde/class_aura.html#a3bac8c34612850e65cd2411f2c7b6baa">Aura::CallScriptAfterProcHandlers</a></div><div class="ttdeci">void CallScriptAfterProcHandlers(AuraApplication const *aurApp, ProcEventInfo &amp;eventInfo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02602">SpellAuras.cpp:2602</a></div></div>
<div class="ttc" id="aclass_aura_html_a3bbcbc2c658a2d959b20837e1e2c31b7"><div class="ttname"><a href="../../d2/dde/class_aura.html#a3bbcbc2c658a2d959b20837e1e2c31b7">Aura::TryCreate</a></div><div class="ttdeci">static Aura * TryCreate(SpellInfo const *spellproto, uint8 effMask, WorldObject *owner, Unit *caster, int32 *baseAmount=nullptr, Item *castItem=nullptr, ObjectGuid casterGUID=ObjectGuid::Empty, ObjectGuid itemGUID=ObjectGuid::Empty)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00347">SpellAuras.cpp:347</a></div></div>
<div class="ttc" id="aclass_aura_html_a3c01fd7df3476af276831667baa3a0ee"><div class="ttname"><a href="../../d2/dde/class_aura.html#a3c01fd7df3476af276831667baa3a0ee">Aura::m_stackAmount</a></div><div class="ttdeci">uint8 m_stackAmount</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00259">SpellAuras.h:259</a></div></div>
<div class="ttc" id="aclass_aura_html_a3c4dfe75dad16fbf2afaf23ce77e4262"><div class="ttname"><a href="../../d2/dde/class_aura.html#a3c4dfe75dad16fbf2afaf23ce77e4262">Aura::GetCasterGUID</a></div><div class="ttdeci">ObjectGuid GetCasterGUID() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00105">SpellAuras.h:105</a></div></div>
<div class="ttc" id="aclass_aura_html_a3d22c519ba658770e61a1616be667a09"><div class="ttname"><a href="../../d2/dde/class_aura.html#a3d22c519ba658770e61a1616be667a09">Aura::HasEffect</a></div><div class="ttdeci">bool HasEffect(uint8 effIndex) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00172">SpellAuras.h:172</a></div></div>
<div class="ttc" id="aclass_aura_html_a406738b04948572a30626082ebe7a0e0"><div class="ttname"><a href="../../d2/dde/class_aura.html#a406738b04948572a30626082ebe7a0e0">Aura::m_duration</a></div><div class="ttdeci">int32 m_duration</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00253">SpellAuras.h:253</a></div></div>
<div class="ttc" id="aclass_aura_html_a40cd6707c45eead445b1f487991da9c1"><div class="ttname"><a href="../../d2/dde/class_aura.html#a40cd6707c45eead445b1f487991da9c1">Aura::CanStackWith</a></div><div class="ttdeci">bool CanStackWith(Aura const *checkAura, bool remove) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01943">SpellAuras.cpp:1943</a></div></div>
<div class="ttc" id="aclass_aura_html_a462457cadd52ba8a0edd5609c71ebbc0"><div class="ttname"><a href="../../d2/dde/class_aura.html#a462457cadd52ba8a0edd5609c71ebbc0">Aura::IsRemoved</a></div><div class="ttdeci">bool IsRemoved() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00160">SpellAuras.h:160</a></div></div>
<div class="ttc" id="aclass_aura_html_a4c573f5f8069c14c997c85c08bac3dd4"><div class="ttname"><a href="../../d2/dde/class_aura.html#a4c573f5f8069c14c997c85c08bac3dd4">Aura::Update</a></div><div class="ttdeci">void Update(uint32 diff, Unit *caster)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00779">SpellAuras.cpp:779</a></div></div>
<div class="ttc" id="aclass_aura_html_a4ef16baec1bec4d7c5e1db67ce392035"><div class="ttname"><a href="../../d2/dde/class_aura.html#a4ef16baec1bec4d7c5e1db67ce392035">Aura::GetCasterLevel</a></div><div class="ttdeci">uint8 GetCasterLevel() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00153">SpellAuras.h:153</a></div></div>
<div class="ttc" id="aclass_aura_html_a51d9e2f08034d14c95ab54045d6860a1"><div class="ttname"><a href="../../d2/dde/class_aura.html#a51d9e2f08034d14c95ab54045d6860a1">Aura::IsSingleTargetWith</a></div><div class="ttdeci">bool IsSingleTargetWith(Aura const *aura) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01130">SpellAuras.cpp:1130</a></div></div>
<div class="ttc" id="aclass_aura_html_a52fbcc7d7f48d46bed2873889640e6d3"><div class="ttname"><a href="../../d2/dde/class_aura.html#a52fbcc7d7f48d46bed2873889640e6d3">Aura::ModCharges</a></div><div class="ttdeci">bool ModCharges(int32 num, AuraRemoveMode removeMode=AURA_REMOVE_BY_DEFAULT)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00925">SpellAuras.cpp:925</a></div></div>
<div class="ttc" id="aclass_aura_html_a54447127bfb738f6722d3f6feddfc168"><div class="ttname"><a href="../../d2/dde/class_aura.html#a54447127bfb738f6722d3f6feddfc168">Aura::GetId</a></div><div class="ttdeci">uint32 GetId() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00461">SpellAuras.cpp:461</a></div></div>
<div class="ttc" id="aclass_aura_html_a585e23fd7b42fa974a2d014fe366ede9"><div class="ttname"><a href="../../d2/dde/class_aura.html#a585e23fd7b42fa974a2d014fe366ede9">Aura::SetLoadedState</a></div><div class="ttdeci">void SetLoadedState(int32 maxduration, int32 duration, int32 charges, uint8 stackamount, uint8 recalculateMask, int32 *amount)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01191">SpellAuras.cpp:1191</a></div></div>
<div class="ttc" id="aclass_aura_html_a5860e9094ea1ef6525b77c1957879486"><div class="ttname"><a href="../../d2/dde/class_aura.html#a5860e9094ea1ef6525b77c1957879486">Aura::IsAppliedOnTarget</a></div><div class="ttdeci">bool IsAppliedOnTarget(ObjectGuid guid) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00184">SpellAuras.h:184</a></div></div>
<div class="ttc" id="aclass_aura_html_a59978cc8d9ebb00cb569d64eed5cef03"><div class="ttname"><a href="../../d2/dde/class_aura.html#a59978cc8d9ebb00cb569d64eed5cef03">Aura::m_applications</a></div><div class="ttdeci">ApplicationMap m_applications</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00262">SpellAuras.h:262</a></div></div>
<div class="ttc" id="aclass_aura_html_a5e79eaa33b5f9ae5aaa44a62d096d6fe"><div class="ttname"><a href="../../d2/dde/class_aura.html#a5e79eaa33b5f9ae5aaa44a62d096d6fe">Aura::GetDuration</a></div><div class="ttdeci">int32 GetDuration() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00133">SpellAuras.h:133</a></div></div>
<div class="ttc" id="aclass_aura_html_a62c2b89c6a9269aba7870b36e5872330"><div class="ttname"><a href="../../d2/dde/class_aura.html#a62c2b89c6a9269aba7870b36e5872330">Aura::IsUsingCharges</a></div><div class="ttdeci">bool IsUsingCharges() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00199">SpellAuras.h:199</a></div></div>
<div class="ttc" id="aclass_aura_html_a6349dd41e39827b8c55464982801d1b4"><div class="ttname"><a href="../../d2/dde/class_aura.html#a6349dd41e39827b8c55464982801d1b4">Aura::UpdateOwner</a></div><div class="ttdeci">void UpdateOwner(uint32 diff, WorldObject *owner)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00737">SpellAuras.cpp:737</a></div></div>
<div class="ttc" id="aclass_aura_html_a640ec9d7dd98eaf508209a8e3991ea4c"><div class="ttname"><a href="../../d2/dde/class_aura.html#a640ec9d7dd98eaf508209a8e3991ea4c">Aura::UnregisterSingleTarget</a></div><div class="ttdeci">void UnregisterSingleTarget()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01155">SpellAuras.cpp:1155</a></div></div>
<div class="ttc" id="aclass_aura_html_a64355d207f7177e6d35a568b93ec322f"><div class="ttname"><a href="../../d2/dde/class_aura.html#a64355d207f7177e6d35a568b93ec322f">Aura::IsDeathPersistent</a></div><div class="ttdeci">bool IsDeathPersistent() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01039">SpellAuras.cpp:1039</a></div></div>
<div class="ttc" id="aclass_aura_html_a6577a1543d871da43ab8b015f67d4150"><div class="ttname"><a href="../../d2/dde/class_aura.html#a6577a1543d871da43ab8b015f67d4150">Aura::CallScriptPrepareProcHandlers</a></div><div class="ttdeci">bool CallScriptPrepareProcHandlers(AuraApplication const *aurApp, ProcEventInfo &amp;eventInfo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02566">SpellAuras.cpp:2566</a></div></div>
<div class="ttc" id="aclass_aura_html_a66f71f0ac319d34ae8cbe5bc4b4bcfb7"><div class="ttname"><a href="../../d2/dde/class_aura.html#a66f71f0ac319d34ae8cbe5bc4b4bcfb7">Aura::GetApplicationList</a></div><div class="ttdeci">void GetApplicationList(std::list&lt; AuraApplication * &gt; &amp;applicationList) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01237">SpellAuras.cpp:1237</a></div></div>
<div class="ttc" id="aclass_aura_html_a6890e111fba863b7163fa5eb0b0870f5"><div class="ttname"><a href="../../d2/dde/class_aura.html#a6890e111fba863b7163fa5eb0b0870f5">Aura::HasEffectType</a></div><div class="ttdeci">bool HasEffectType(AuraType type) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01210">SpellAuras.cpp:1210</a></div></div>
<div class="ttc" id="aclass_aura_html_a69b589a7414d5d73ed75d12d5ba736ef"><div class="ttname"><a href="../../d2/dde/class_aura.html#a69b589a7414d5d73ed75d12d5ba736ef">Aura::ModStackAmount</a></div><div class="ttdeci">bool ModStackAmount(int32 num, AuraRemoveMode removeMode=AURA_REMOVE_BY_DEFAULT, bool periodicReset=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00973">SpellAuras.cpp:973</a></div></div>
<div class="ttc" id="aclass_aura_html_a6a627815a8f313c2454de85907046bbf"><div class="ttname"><a href="../../d2/dde/class_aura.html#a6a627815a8f313c2454de85907046bbf">Aura::GetOwner</a></div><div class="ttdeci">WorldObject * GetOwner() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00107">SpellAuras.h:107</a></div></div>
<div class="ttc" id="aclass_aura_html_a6fc52109b7711606f15d9880fda8f815"><div class="ttname"><a href="../../d2/dde/class_aura.html#a6fc52109b7711606f15d9880fda8f815">Aura::GetCaster</a></div><div class="ttdeci">Unit * GetCaster() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00466">SpellAuras.cpp:466</a></div></div>
<div class="ttc" id="aclass_aura_html_a742caadbfa7658d6957bf73eda7c624a"><div class="ttname"><a href="../../d2/dde/class_aura.html#a742caadbfa7658d6957bf73eda7c624a">Aura::m_castItemGuid</a></div><div class="ttdeci">ObjectGuid const m_castItemGuid</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00247">SpellAuras.h:247</a></div></div>
<div class="ttc" id="aclass_aura_html_a76282958056070ecbf58c7a864ea7494"><div class="ttname"><a href="../../d2/dde/class_aura.html#a76282958056070ecbf58c7a864ea7494">Aura::CallScriptAfterEffectApplyHandlers</a></div><div class="ttdeci">void CallScriptAfterEffectApplyHandlers(AuraEffect const *aurEff, AuraApplication const *aurApp, AuraEffectHandleModes mode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02372">SpellAuras.cpp:2372</a></div></div>
<div class="ttc" id="aclass_aura_html_a7af03c4091eed4aab81dd2d0613b4eca"><div class="ttname"><a href="../../d2/dde/class_aura.html#a7af03c4091eed4aab81dd2d0613b4eca">Aura::m_timeCla</a></div><div class="ttdeci">int32 m_timeCla</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00254">SpellAuras.h:254</a></div></div>
<div class="ttc" id="aclass_aura_html_a7c8537a933fb3deee10c40f1345ad86b"><div class="ttname"><a href="../../d2/dde/class_aura.html#a7c8537a933fb3deee10c40f1345ad86b">Aura::GetSpellInfo</a></div><div class="ttdeci">SpellInfo const  * GetSpellInfo() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00100">SpellAuras.h:100</a></div></div>
<div class="ttc" id="aclass_aura_html_a7e2bf3f6ccfcf6531a3cb146f1eb5405"><div class="ttname"><a href="../../d2/dde/class_aura.html#a7e2bf3f6ccfcf6531a3cb146f1eb5405">Aura::CalcDispelChance</a></div><div class="ttdeci">int32 CalcDispelChance(Unit *auraTarget, bool offensive) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01170">SpellAuras.cpp:1170</a></div></div>
<div class="ttc" id="aclass_aura_html_a7f7d613279717173c13708425f3a8083"><div class="ttname"><a href="../../d2/dde/class_aura.html#a7f7d613279717173c13708425f3a8083">Aura::SetCharges</a></div><div class="ttdeci">void SetCharges(uint8 charges)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00904">SpellAuras.cpp:904</a></div></div>
<div class="ttc" id="aclass_aura_html_a87be004e2c34b6652cd5350689b24dc3"><div class="ttname"><a href="../../d2/dde/class_aura.html#a87be004e2c34b6652cd5350689b24dc3">Aura::CallScriptCheckProcHandlers</a></div><div class="ttdeci">bool CallScriptCheckProcHandlers(AuraApplication const *aurApp, ProcEventInfo &amp;eventInfo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02550">SpellAuras.cpp:2550</a></div></div>
<div class="ttc" id="aclass_aura_html_a882f4ec3b0f104d3c18c718dc71ec668"><div class="ttname"><a href="../../d2/dde/class_aura.html#a882f4ec3b0f104d3c18c718dc71ec668">Aura::CallScriptEffectApplyHandlers</a></div><div class="ttdeci">bool CallScriptEffectApplyHandlers(AuraEffect const *aurEff, AuraApplication const *aurApp, AuraEffectHandleModes mode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02333">SpellAuras.cpp:2333</a></div></div>
<div class="ttc" id="aclass_aura_html_a893e1bed86677e695a28d8eb4fab763d"><div class="ttname"><a href="../../d2/dde/class_aura.html#a893e1bed86677e695a28d8eb4fab763d">Aura::CallScriptAfterEffectRemoveHandlers</a></div><div class="ttdeci">void CallScriptAfterEffectRemoveHandlers(AuraEffect const *aurEff, AuraApplication const *aurApp, AuraEffectHandleModes mode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02386">SpellAuras.cpp:2386</a></div></div>
<div class="ttc" id="aclass_aura_html_a8b5668b0179cec254f21a0b6bdf83974"><div class="ttname"><a href="../../d2/dde/class_aura.html#a8b5668b0179cec254f21a0b6bdf83974">Aura::UpdateTargetMap</a></div><div class="ttdeci">void UpdateTargetMap(Unit *caster, bool apply=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00555">SpellAuras.cpp:555</a></div></div>
<div class="ttc" id="aclass_aura_html_a8f9f4a57e87c86b384b637403fff06e7"><div class="ttname"><a href="../../d2/dde/class_aura.html#a8f9f4a57e87c86b384b637403fff06e7">Aura::SetNeedClientUpdateForTargets</a></div><div class="ttdeci">void SetNeedClientUpdateForTargets() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01246">SpellAuras.cpp:1246</a></div></div>
<div class="ttc" id="aclass_aura_html_a9637e205c147457e50b47efe0f8f7904"><div class="ttname"><a href="../../d2/dde/class_aura.html#a9637e205c147457e50b47efe0f8f7904">Aura::TryRefreshStackOrCreate</a></div><div class="ttdeci">static Aura * TryRefreshStackOrCreate(SpellInfo const *spellproto, uint8 tryEffMask, WorldObject *owner, Unit *caster, int32 *baseAmount=nullptr, Item *castItem=nullptr, ObjectGuid casterGUID=ObjectGuid::Empty, bool *refresh=nullptr, bool periodicReset=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00321">SpellAuras.cpp:321</a></div></div>
<div class="ttc" id="aclass_aura_html_a96d2072a3b0b06f82113eb9d3e186ac1"><div class="ttname"><a href="../../d2/dde/class_aura.html#a96d2072a3b0b06f82113eb9d3e186ac1">Aura::CallScriptEffectProcHandlers</a></div><div class="ttdeci">bool CallScriptEffectProcHandlers(AuraEffect const *aurEff, AuraApplication const *aurApp, ProcEventInfo &amp;eventInfo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02615">SpellAuras.cpp:2615</a></div></div>
<div class="ttc" id="aclass_aura_html_a97347f8dc5f2dd96c7c45a77c13988a5"><div class="ttname"><a href="../../d2/dde/class_aura.html#a97347f8dc5f2dd96c7c45a77c13988a5">Aura::CallScriptAfterEffectProcHandlers</a></div><div class="ttdeci">void CallScriptAfterEffectProcHandlers(AuraEffect const *aurEff, AuraApplication const *aurApp, ProcEventInfo &amp;eventInfo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02634">SpellAuras.cpp:2634</a></div></div>
<div class="ttc" id="aclass_aura_html_a97f212bb7332fdf03fccafe5389c1e0a"><div class="ttname"><a href="../../d2/dde/class_aura.html#a97f212bb7332fdf03fccafe5389c1e0a">Aura::CalcMaxDuration</a></div><div class="ttdeci">int32 CalcMaxDuration() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00131">SpellAuras.h:131</a></div></div>
<div class="ttc" id="aclass_aura_html_a99930c42ad9f6e002ffe6de5e5fbe59b"><div class="ttname"><a href="../../d2/dde/class_aura.html#a99930c42ad9f6e002ffe6de5e5fbe59b">Aura::SetDuration</a></div><div class="ttdeci">void SetDuration(int32 duration, bool withMods=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00849">SpellAuras.cpp:849</a></div></div>
<div class="ttc" id="aclass_aura_html_a99d38e9baa13b6683db43d67757ec982"><div class="ttname"><a href="../../d2/dde/class_aura.html#a99d38e9baa13b6683db43d67757ec982">Aura::CallScriptProcHandlers</a></div><div class="ttdeci">bool CallScriptProcHandlers(AuraApplication const *aurApp, ProcEventInfo &amp;eventInfo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02585">SpellAuras.cpp:2585</a></div></div>
<div class="ttc" id="aclass_aura_html_a9b82ca1499317e9a44b1315e16472d44"><div class="ttname"><a href="../../d2/dde/class_aura.html#a9b82ca1499317e9a44b1315e16472d44">Aura::IsProcOnCooldown</a></div><div class="ttdeci">bool IsProcOnCooldown() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02108">SpellAuras.cpp:2108</a></div></div>
<div class="ttc" id="aclass_aura_html_a9ed84a2b95a1cb898a682c809dd25d2b"><div class="ttname"><a href="../../d2/dde/class_aura.html#a9ed84a2b95a1cb898a682c809dd25d2b">Aura::LoadScripts</a></div><div class="ttdeci">void LoadScripts()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02273">SpellAuras.cpp:2273</a></div></div>
<div class="ttc" id="aclass_aura_html_a9fb02e4e6e4b16378e89d2126cc291e7"><div class="ttname"><a href="../../d2/dde/class_aura.html#a9fb02e4e6e4b16378e89d2126cc291e7">Aura::GetApplicationOfTarget</a></div><div class="ttdeci">const AuraApplication * GetApplicationOfTarget(ObjectGuid guid) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00182">SpellAuras.h:182</a></div></div>
<div class="ttc" id="aclass_aura_html_aa2544b7425a5ec6df5d7e9ba26aff84f"><div class="ttname"><a href="../../d2/dde/class_aura.html#aa2544b7425a5ec6df5d7e9ba26aff84f">Aura::GetUnitOwner</a></div><div class="ttdeci">Unit * GetUnitOwner() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00108">SpellAuras.h:108</a></div></div>
<div class="ttc" id="aclass_aura_html_aa4972c4116685b08f25f6a2711c196d3"><div class="ttname"><a href="../../d2/dde/class_aura.html#aa4972c4116685b08f25f6a2711c196d3">Aura::m_triggeredByAuraSpellInfo</a></div><div class="ttdeci">SpellInfo const  * m_triggeredByAuraSpellInfo</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00271">SpellAuras.h:271</a></div></div>
<div class="ttc" id="aclass_aura_html_aa515b9daf648d268f02ef974b3573550"><div class="ttname"><a href="../../d2/dde/class_aura.html#aa515b9daf648d268f02ef974b3573550">Aura::CalcProcChance</a></div><div class="ttdeci">float CalcProcChance(SpellProcEntry const &amp;procEntry, ProcEventInfo &amp;eventInfo) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02228">SpellAuras.cpp:2228</a></div></div>
<div class="ttc" id="aclass_aura_html_aa5ebe6aa240ef26f1bfe4ac77240dd35"><div class="ttname"><a href="../../d2/dde/class_aura.html#aa5ebe6aa240ef26f1bfe4ac77240dd35">Aura::CallScriptEffectAfterAbsorbHandlers</a></div><div class="ttdeci">void CallScriptEffectAfterAbsorbHandlers(AuraEffect *aurEff, AuraApplication const *aurApp, DamageInfo &amp;dmgInfo, uint32 &amp;absorbAmount)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02494">SpellAuras.cpp:2494</a></div></div>
<div class="ttc" id="aclass_aura_html_aa75669dbdf619c939c3dc7fff9fe8736"><div class="ttname"><a href="../../d2/dde/class_aura.html#aa75669dbdf619c939c3dc7fff9fe8736">Aura::CallScriptEffectManaShieldHandlers</a></div><div class="ttdeci">void CallScriptEffectManaShieldHandlers(AuraEffect *aurEff, AuraApplication const *aurApp, DamageInfo &amp;dmgInfo, uint32 &amp;absorbAmount, bool &amp;defaultPrevented)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02508">SpellAuras.cpp:2508</a></div></div>
<div class="ttc" id="aclass_aura_html_aaba50101334e21660ff99d4668ae06b7"><div class="ttname"><a href="../../d2/dde/class_aura.html#aaba50101334e21660ff99d4668ae06b7">Aura::m_spellInfo</a></div><div class="ttdeci">SpellInfo const  *const m_spellInfo</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00245">SpellAuras.h:245</a></div></div>
<div class="ttc" id="aclass_aura_html_aad107d81d9d0898ac5922504526dd07e"><div class="ttname"><a href="../../d2/dde/class_aura.html#aad107d81d9d0898ac5922504526dd07e">Aura::CallScriptEffectSplitHandlers</a></div><div class="ttdeci">void CallScriptEffectSplitHandlers(AuraEffect *aurEff, AuraApplication const *aurApp, DamageInfo &amp;dmgInfo, uint32 &amp;splitAmount)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02536">SpellAuras.cpp:2536</a></div></div>
<div class="ttc" id="aclass_aura_html_aaddb94cd3bd95b145a8b8392e9feecca"><div class="ttname"><a href="../../d2/dde/class_aura.html#aaddb94cd3bd95b145a8b8392e9feecca">Aura::GetType</a></div><div class="ttdeci">AuraObjectType GetType() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00476">SpellAuras.cpp:476</a></div></div>
<div class="ttc" id="aclass_aura_html_aae0b7e0da61a681e67a19b6d23c2cee6"><div class="ttname"><a href="../../d2/dde/class_aura.html#aae0b7e0da61a681e67a19b6d23c2cee6">Aura::GetStackAmount</a></div><div class="ttdeci">uint8 GetStackAmount() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00147">SpellAuras.h:147</a></div></div>
<div class="ttc" id="aclass_aura_html_aaf49ca3ee98e09b072985755bcfb2d34"><div class="ttname"><a href="../../d2/dde/class_aura.html#aaf49ca3ee98e09b072985755bcfb2d34">Aura::_ApplyEffectForTargets</a></div><div class="ttdeci">void _ApplyEffectForTargets(uint8 effIndex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00716">SpellAuras.cpp:716</a></div></div>
<div class="ttc" id="aclass_aura_html_ab048dcde17f19db0f48464f9cdea182b"><div class="ttname"><a href="../../d2/dde/class_aura.html#ab048dcde17f19db0f48464f9cdea182b">Aura::GetScriptByName</a></div><div class="ttdeci">AuraScript * GetScriptByName(std::string const &amp;scriptName) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00422">SpellAuras.cpp:422</a></div></div>
<div class="ttc" id="aclass_aura_html_ab07705be94c0c10fce558c80d7208e0b"><div class="ttname"><a href="../../d2/dde/class_aura.html#ab07705be94c0c10fce558c80d7208e0b">Aura::GetCharges</a></div><div class="ttdeci">uint8 GetCharges() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00140">SpellAuras.h:140</a></div></div>
<div class="ttc" id="aclass_aura_html_ab0d4d20bb3fac4108ba3dbc891d8dec9"><div class="ttname"><a href="../../d2/dde/class_aura.html#ab0d4d20bb3fac4108ba3dbc891d8dec9">Aura::TriggerProcOnEvent</a></div><div class="ttdeci">void TriggerProcOnEvent(AuraApplication *aurApp, ProcEventInfo &amp;eventInfo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02248">SpellAuras.cpp:2248</a></div></div>
<div class="ttc" id="aclass_aura_html_ab415594d025a57ab429a85ab70e598cb"><div class="ttname"><a href="../../d2/dde/class_aura.html#ab415594d025a57ab429a85ab70e598cb">Aura::m_owner</a></div><div class="ttdeci">WorldObject *const m_owner</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00250">SpellAuras.h:250</a></div></div>
<div class="ttc" id="aclass_aura_html_ab477124f94af36e9be706451dce791f7"><div class="ttname"><a href="../../d2/dde/class_aura.html#ab477124f94af36e9be706451dce791f7">Aura::_InitEffects</a></div><div class="ttdeci">void _InitEffects(uint8 effMask, Unit *caster, int32 *baseAmount)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00430">SpellAuras.cpp:430</a></div></div>
<div class="ttc" id="aclass_aura_html_ab5641e8e175470f121e2c6eda7dfb253"><div class="ttname"><a href="../../d2/dde/class_aura.html#ab5641e8e175470f121e2c6eda7dfb253">Aura::GetCastItemGUID</a></div><div class="ttdeci">ObjectGuid GetCastItemGUID() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00103">SpellAuras.h:103</a></div></div>
<div class="ttc" id="aclass_aura_html_abbd4948d31a548af813815efb91ff311"><div class="ttname"><a href="../../d2/dde/class_aura.html#abbd4948d31a548af813815efb91ff311">Aura::IsRemovedOnShapeLost</a></div><div class="ttdeci">bool IsRemovedOnShapeLost(Unit *target) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01044">SpellAuras.cpp:1044</a></div></div>
<div class="ttc" id="aclass_aura_html_abd4f379de7ed0890f28df1209aad70c7"><div class="ttname"><a href="../../d2/dde/class_aura.html#abd4f379de7ed0890f28df1209aad70c7">Aura::CallScriptEffectCalcPeriodicHandlers</a></div><div class="ttdeci">void CallScriptEffectCalcPeriodicHandlers(AuraEffect const *aurEff, bool &amp;isPeriodic, int32 &amp;amplitude)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02448">SpellAuras.cpp:2448</a></div></div>
<div class="ttc" id="aclass_aura_html_abf0ff1d6e3be882ce7e8ddd7e935ab66"><div class="ttname"><a href="../../d2/dde/class_aura.html#abf0ff1d6e3be882ce7e8ddd7e935ab66">Aura::SetMaxDuration</a></div><div class="ttdeci">void SetMaxDuration(int32 duration)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00130">SpellAuras.h:130</a></div></div>
<div class="ttc" id="aclass_aura_html_abfb01581d89c746acf70279f5e5cf782"><div class="ttname"><a href="../../d2/dde/class_aura.html#abfb01581d89c746acf70279f5e5cf782">Aura::GetDynobjOwner</a></div><div class="ttdeci">DynamicObject * GetDynobjOwner() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00109">SpellAuras.h:109</a></div></div>
<div class="ttc" id="aclass_aura_html_ac2ee53cb584c3528f2990d391393bc1d"><div class="ttname"><a href="../../d2/dde/class_aura.html#ac2ee53cb584c3528f2990d391393bc1d">Aura::CanBeAppliedOn</a></div><div class="ttdeci">bool CanBeAppliedOn(Unit *target)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01892">SpellAuras.cpp:1892</a></div></div>
<div class="ttc" id="aclass_aura_html_ac4544d5fa6bb4171de4fccdad5e96918"><div class="ttname"><a href="../../d2/dde/class_aura.html#ac4544d5fa6bb4171de4fccdad5e96918">Aura::IsAuraStronger</a></div><div class="ttdeci">bool IsAuraStronger(Aura const *newAura) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01914">SpellAuras.cpp:1914</a></div></div>
<div class="ttc" id="aclass_aura_html_ac514e08ac3f8733a650d243239dada58"><div class="ttname"><a href="../../d2/dde/class_aura.html#ac514e08ac3f8733a650d243239dada58">Aura::IsProcTriggeredOnEvent</a></div><div class="ttdeci">bool IsProcTriggeredOnEvent(AuraApplication *aurApp, ProcEventInfo &amp;eventInfo) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02144">SpellAuras.cpp:2144</a></div></div>
<div class="ttc" id="aclass_aura_html_ac6a690bd3e87d00af4c6a562b250f6f1"><div class="ttname"><a href="../../d2/dde/class_aura.html#ac6a690bd3e87d00af4c6a562b250f6f1">Aura::HandleAuraSpecificMods</a></div><div class="ttdeci">void HandleAuraSpecificMods(AuraApplication const *aurApp, Unit *caster, bool apply, bool onReapply)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01253">SpellAuras.cpp:1253</a></div></div>
<div class="ttc" id="aclass_aura_html_ac7a35591f5b0d0429cf706984dbe4316"><div class="ttname"><a href="../../d2/dde/class_aura.html#ac7a35591f5b0d0429cf706984dbe4316">Aura::~Aura</a></div><div class="ttdeci">virtual ~Aura()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00442">SpellAuras.cpp:442</a></div></div>
<div class="ttc" id="aclass_aura_html_aca22c44b0c3179824f9951b0b3ce206c"><div class="ttname"><a href="../../d2/dde/class_aura.html#aca22c44b0c3179824f9951b0b3ce206c">Aura::BuildEffectMaskForOwner</a></div><div class="ttdeci">static uint8 BuildEffectMaskForOwner(SpellInfo const *spellProto, uint8 avalibleEffectMask, WorldObject *owner)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00293">SpellAuras.cpp:293</a></div></div>
<div class="ttc" id="aclass_aura_html_aca7aa7ab17d4d24ddcef476c6c0c08b6"><div class="ttname"><a href="../../d2/dde/class_aura.html#aca7aa7ab17d4d24ddcef476c6c0c08b6">Aura::Aura</a></div><div class="ttdeci">Aura(SpellInfo const *spellproto, WorldObject *owner, Unit *caster, Item *castItem, ObjectGuid casterGUID, ObjectGuid itemGUID=ObjectGuid::Empty)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00404">SpellAuras.cpp:404</a></div></div>
<div class="ttc" id="aclass_aura_html_acb34c6f61b861a35398f1d8b7947312e"><div class="ttname"><a href="../../d2/dde/class_aura.html#acb34c6f61b861a35398f1d8b7947312e">Aura::SetIsSingleTarget</a></div><div class="ttdeci">void SetIsSingleTarget(bool val)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00165">SpellAuras.h:165</a></div></div>
<div class="ttc" id="aclass_aura_html_accc852560f7b56d60c77581365a3b17f"><div class="ttname"><a href="../../d2/dde/class_aura.html#accc852560f7b56d60c77581365a3b17f">Aura::_DeleteRemovedApplications</a></div><div class="ttdeci">void _DeleteRemovedApplications()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02264">SpellAuras.cpp:2264</a></div></div>
<div class="ttc" id="aclass_aura_html_ace1f81adb69a07eddbdeee16bfe2ed33"><div class="ttname"><a href="../../d2/dde/class_aura.html#ace1f81adb69a07eddbdeee16bfe2ed33">Aura::PrepareProcToTrigger</a></div><div class="ttdeci">void PrepareProcToTrigger(AuraApplication *aurApp, ProcEventInfo &amp;eventInfo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02123">SpellAuras.cpp:2123</a></div></div>
<div class="ttc" id="aclass_aura_html_ace74284832d9713a175bb3905449f954"><div class="ttname"><a href="../../d2/dde/class_aura.html#ace74284832d9713a175bb3905449f954">Aura::IsExpired</a></div><div class="ttdeci">bool IsExpired() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00137">SpellAuras.h:137</a></div></div>
<div class="ttc" id="aclass_aura_html_ad1c2269615a73318dc9438801d1ee087"><div class="ttname"><a href="../../d2/dde/class_aura.html#ad1c2269615a73318dc9438801d1ee087">Aura::_ApplyForTarget</a></div><div class="ttdeci">virtual void _ApplyForTarget(Unit *target, Unit *caster, AuraApplication *auraApp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00487">SpellAuras.cpp:487</a></div></div>
<div class="ttc" id="aclass_aura_html_ad786924c8b4617ff4724065b6452b04f"><div class="ttname"><a href="../../d2/dde/class_aura.html#ad786924c8b4617ff4724065b6452b04f">Aura::CalcMaxCharges</a></div><div class="ttdeci">uint8 CalcMaxCharges() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00143">SpellAuras.h:143</a></div></div>
<div class="ttc" id="aclass_aura_html_ad8811634ba5d82b9581e94e8a0fd6097"><div class="ttname"><a href="../../d2/dde/class_aura.html#ad8811634ba5d82b9581e94e8a0fd6097">Aura::m_isUsingCharges</a></div><div class="ttdeci">bool m_isUsingCharges</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00266">SpellAuras.h:266</a></div></div>
<div class="ttc" id="aclass_aura_html_adac81f948f034942046b45a94fea365f"><div class="ttname"><a href="../../d2/dde/class_aura.html#adac81f948f034942046b45a94fea365f">Aura::CallScriptEffectUpdatePeriodicHandlers</a></div><div class="ttdeci">void CallScriptEffectUpdatePeriodicHandlers(AuraEffect *aurEff)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02420">SpellAuras.cpp:2420</a></div></div>
<div class="ttc" id="aclass_aura_html_adbd7f397bbd36e4273d430032ddcd073"><div class="ttname"><a href="../../d2/dde/class_aura.html#adbd7f397bbd36e4273d430032ddcd073">Aura::RecalculateAmountOfEffects</a></div><div class="ttdeci">void RecalculateAmountOfEffects()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01220">SpellAuras.cpp:1220</a></div></div>
<div class="ttc" id="aclass_aura_html_ae24c050668e78ef9d8728e6b5bd77c12"><div class="ttname"><a href="../../d2/dde/class_aura.html#ae24c050668e78ef9d8728e6b5bd77c12">Aura::IsPassive</a></div><div class="ttdeci">bool IsPassive() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01034">SpellAuras.cpp:1034</a></div></div>
<div class="ttc" id="aclass_aura_html_ae2a6c05d26b1254d93038b666d1e46cd"><div class="ttname"><a href="../../d2/dde/class_aura.html#ae2a6c05d26b1254d93038b666d1e46cd">Aura::RefreshSpellMods</a></div><div class="ttdeci">void RefreshSpellMods()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l01017">SpellAuras.cpp:1017</a></div></div>
<div class="ttc" id="aclass_aura_html_ae44dc9394657b8fbc90bec95911cac03"><div class="ttname"><a href="../../d2/dde/class_aura.html#ae44dc9394657b8fbc90bec95911cac03">Aura::Create</a></div><div class="ttdeci">static Aura * Create(SpellInfo const *spellproto, uint8 effMask, WorldObject *owner, Unit *caster, int32 *baseAmount, Item *castItem, ObjectGuid casterGUID, ObjectGuid itemGUID=ObjectGuid::Empty)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00359">SpellAuras.cpp:359</a></div></div>
<div class="ttc" id="aclass_aura_html_ae63436802a402d26115d21f4a2073e1a"><div class="ttname"><a href="../../d2/dde/class_aura.html#ae63436802a402d26115d21f4a2073e1a">Aura::m_isRemoved</a></div><div class="ttdeci">bool m_isRemoved</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00264">SpellAuras.h:264</a></div></div>
<div class="ttc" id="aclass_aura_html_aeb7fadeb3b25c9d5a2903e5c1ea06ff2"><div class="ttname"><a href="../../d2/dde/class_aura.html#aeb7fadeb3b25c9d5a2903e5c1ea06ff2">Aura::m_updateTargetMapInterval</a></div><div class="ttdeci">int32 m_updateTargetMapInterval</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00255">SpellAuras.h:255</a></div></div>
<div class="ttc" id="aclass_aura_html_af0236680754f81e374b015640e4b6eff"><div class="ttname"><a href="../../d2/dde/class_aura.html#af0236680754f81e374b015640e4b6eff">Aura::CallScriptEffectAfterManaShieldHandlers</a></div><div class="ttdeci">void CallScriptEffectAfterManaShieldHandlers(AuraEffect *aurEff, AuraApplication const *aurApp, DamageInfo &amp;dmgInfo, uint32 &amp;absorbAmount)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02522">SpellAuras.cpp:2522</a></div></div>
<div class="ttc" id="aclass_aura_html_af22450afa8bf33c979c0a0f7d801ab4c"><div class="ttname"><a href="../../d2/dde/class_aura.html#af22450afa8bf33c979c0a0f7d801ab4c">Aura::m_isSingleTarget</a></div><div class="ttdeci">bool m_isSingleTarget</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00265">SpellAuras.h:265</a></div></div>
<div class="ttc" id="aclass_aura_html_af32b9da81a73be723f660ae4e3363e74"><div class="ttname"><a href="../../d2/dde/class_aura.html#af32b9da81a73be723f660ae4e3363e74">Aura::m_procCharges</a></div><div class="ttdeci">uint8 m_procCharges</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00258">SpellAuras.h:258</a></div></div>
<div class="ttc" id="aclass_aura_html_af64f07e2756640cb9caf21433bd4e2b6"><div class="ttname"><a href="../../d2/dde/class_aura.html#af64f07e2756640cb9caf21433bd4e2b6">Aura::GetTriggeredByAuraSpellInfo</a></div><div class="ttdeci">SpellInfo const  * GetTriggeredByAuraSpellInfo() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02653">SpellAuras.cpp:2653</a></div></div>
<div class="ttc" id="aclass_aura_html_af70f37c9e40b7038cf952c2969ae9ab2"><div class="ttname"><a href="../../d2/dde/class_aura.html#af70f37c9e40b7038cf952c2969ae9ab2">Aura::IsPermanent</a></div><div class="ttdeci">bool IsPermanent() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00138">SpellAuras.h:138</a></div></div>
<div class="ttc" id="aclass_aura_html_af9799e5670c2bc3899e3430aa793ca20"><div class="ttname"><a href="../../d2/dde/class_aura.html#af9799e5670c2bc3899e3430aa793ca20">Aura::Remove</a></div><div class="ttdeci">virtual void Remove(AuraRemoveMode removeMode=AURA_REMOVE_BY_DEFAULT)=0</div></div>
<div class="ttc" id="aclass_aura_html_afa8b3462e2d68da5a9972c6cbd637022"><div class="ttname"><a href="../../d2/dde/class_aura.html#afa8b3462e2d68da5a9972c6cbd637022">Aura::CallScriptAfterDispel</a></div><div class="ttdeci">void CallScriptAfterDispel(DispelInfo *dispelInfo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02320">SpellAuras.cpp:2320</a></div></div>
<div class="ttc" id="aclass_aura_html_afb6874ab08b221b2f1f9d7582c1c93be"><div class="ttname"><a href="../../d2/dde/class_aura.html#afb6874ab08b221b2f1f9d7582c1c93be">Aura::_Remove</a></div><div class="ttdeci">void _Remove(AuraRemoveMode removeMode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l00541">SpellAuras.cpp:541</a></div></div>
<div class="ttc" id="aclass_aura_html_afb782970ace7a9385038481911d388fc"><div class="ttname"><a href="../../d2/dde/class_aura.html#afb782970ace7a9385038481911d388fc">Aura::IsSingleTarget</a></div><div class="ttdeci">bool IsSingleTarget() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00163">SpellAuras.h:163</a></div></div>
<div class="ttc" id="aclass_aura_script_html"><div class="ttname"><a href="../../d4/d72/class_aura_script.html">AuraScript</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/df6/_spell_script_8h_source.html#l00515">SpellScript.h:516</a></div></div>
<div class="ttc" id="aclass_byte_buffer_html"><div class="ttname"><a href="../../dd/d44/class_byte_buffer.html">ByteBuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6c/_byte_buffer_8h_source.html#l00069">ByteBuffer.h:70</a></div></div>
<div class="ttc" id="aclass_creature_html"><div class="ttname"><a href="../../d1/dac/class_creature.html">Creature</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d93/_creature_8h_source.html#l00045">Creature.h:46</a></div></div>
<div class="ttc" id="aclass_damage_info_html"><div class="ttname"><a href="../../d6/d2a/class_damage_info.html">DamageInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00902">Unit.h:903</a></div></div>
<div class="ttc" id="aclass_damage_info_html_a8bf9edb2df92b0164ffc21a00c8925d6"><div class="ttname"><a href="../../d6/d2a/class_damage_info.html#a8bf9edb2df92b0164ffc21a00c8925d6">DamageInfo::GetAttackType</a></div><div class="ttdeci">WeaponAttackType GetAttackType() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00931">Unit.h:931</a></div></div>
<div class="ttc" id="aclass_dispel_info_html"><div class="ttname"><a href="../../dc/de3/class_dispel_info.html">DispelInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00868">Unit.h:869</a></div></div>
<div class="ttc" id="aclass_dyn_obj_aura_html"><div class="ttname"><a href="../../d7/d48/class_dyn_obj_aura.html">DynObjAura</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00297">SpellAuras.h:298</a></div></div>
<div class="ttc" id="aclass_dyn_obj_aura_html_ada3f65b4a817e2337da43da437b93a3b"><div class="ttname"><a href="../../d7/d48/class_dyn_obj_aura.html#ada3f65b4a817e2337da43da437b93a3b">DynObjAura::Remove</a></div><div class="ttdeci">void Remove(AuraRemoveMode removeMode=AURA_REMOVE_BY_DEFAULT) override</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02772">SpellAuras.cpp:2772</a></div></div>
<div class="ttc" id="aclass_dyn_obj_aura_html_aef75bb5d60c10ac63821b0e9baf6eb7a"><div class="ttname"><a href="../../d7/d48/class_dyn_obj_aura.html#aef75bb5d60c10ac63821b0e9baf6eb7a">DynObjAura::DynObjAura</a></div><div class="ttdeci">DynObjAura(SpellInfo const *spellproto, uint8 effMask, WorldObject *owner, Unit *caster, int32 *baseAmount, Item *castItem, ObjectGuid casterGUID, ObjectGuid itemGUID=ObjectGuid::Empty)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02761">SpellAuras.cpp:2761</a></div></div>
<div class="ttc" id="aclass_dyn_obj_aura_html_af8e36643ed675ff5652e4665bee9b0c3"><div class="ttname"><a href="../../d7/d48/class_dyn_obj_aura.html#af8e36643ed675ff5652e4665bee9b0c3">DynObjAura::FillTargetMap</a></div><div class="ttdeci">void FillTargetMap(std::map&lt; Unit *, uint8 &gt; &amp;targets, Unit *caster) override</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02779">SpellAuras.cpp:2779</a></div></div>
<div class="ttc" id="aclass_dynamic_object_html_a0e21e54eec1092b7ed05d1bacd0f8ed6"><div class="ttname"><a href="../../d4/ddd/class_dynamic_object.html#a0e21e54eec1092b7ed05d1bacd0f8ed6">DynamicObject::SetAura</a></div><div class="ttdeci">void SetAura(Aura *aura)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dbb/_dynamic_object_8cpp_source.html#l00201">DynamicObject.cpp:201</a></div></div>
<div class="ttc" id="aclass_dynamic_object_html_aaa9a2dbbf9cbc8d01dd6f3d81dcba8a8"><div class="ttname"><a href="../../d4/ddd/class_dynamic_object.html#aaa9a2dbbf9cbc8d01dd6f3d81dcba8a8">DynamicObject::GetCaster</a></div><div class="ttdeci">Unit * GetCaster() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db0/_dynamic_object_8h_source.html#l00055">DynamicObject.h:55</a></div></div>
<div class="ttc" id="aclass_dynamic_object_html_afb0de652437ede9d70a06b3c110b5ae9"><div class="ttname"><a href="../../d4/ddd/class_dynamic_object.html#afb0de652437ede9d70a06b3c110b5ae9">DynamicObject::GetRadius</a></div><div class="ttdeci">float GetRadius() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db0/_dynamic_object_8h_source.html#l00060">DynamicObject.h:60</a></div></div>
<div class="ttc" id="aclass_item_html"><div class="ttname"><a href="../../dc/d32/class_item.html">Item</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d43/_item_8h_source.html#l00213">Item.h:214</a></div></div>
<div class="ttc" id="aclass_item_html_a65aafded62a4c193fc631a1ed5c72f71"><div class="ttname"><a href="../../dc/d32/class_item.html#a65aafded62a4c193fc631a1ed5c72f71">Item::IsBroken</a></div><div class="ttdeci">bool IsBroken() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d43/_item_8h_source.html#l00251">Item.h:251</a></div></div>
<div class="ttc" id="aclass_item_html_af64f6b0baa8ab4ce263b60058af19196"><div class="ttname"><a href="../../dc/d32/class_item.html#af64f6b0baa8ab4ce263b60058af19196">Item::IsFitToSpellRequirements</a></div><div class="ttdeci">bool IsFitToSpellRequirements(SpellInfo const *spellInfo) const</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d54/_item_8cpp_source.html#l00847">Item.cpp:847</a></div></div>
<div class="ttc" id="aclass_object_guid_html"><div class="ttname"><a href="../../d8/d03/class_object_guid.html">ObjectGuid</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d83/_object_guid_8h_source.html#l00119">ObjectGuid.h:120</a></div></div>
<div class="ttc" id="aclass_object_guid_html_a07e7802fc81a89510d4286ecf52ddb08"><div class="ttname"><a href="../../d8/d03/class_object_guid.html#a07e7802fc81a89510d4286ecf52ddb08">ObjectGuid::WriteAsPacked</a></div><div class="ttdeci">PackedGuid WriteAsPacked() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d83/_object_guid_8h_source.html#l00318">ObjectGuid.h:318</a></div></div>
<div class="ttc" id="aclass_object_guid_html_a14039d3f3df79203693f713495503165"><div class="ttname"><a href="../../d8/d03/class_object_guid.html#a14039d3f3df79203693f713495503165">ObjectGuid::Empty</a></div><div class="ttdeci">static ObjectGuid const Empty</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d83/_object_guid_8h_source.html#l00122">ObjectGuid.h:122</a></div></div>
<div class="ttc" id="aclass_object_guid_html_a32695a11f47a244236e7bce277fcf3a8"><div class="ttname"><a href="../../d8/d03/class_object_guid.html#a32695a11f47a244236e7bce277fcf3a8">ObjectGuid::IsEmpty</a></div><div class="ttdeci">bool IsEmpty() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d83/_object_guid_8h_source.html#l00163">ObjectGuid.h:163</a></div></div>
<div class="ttc" id="aclass_object_guid_html_a78f5fb47e3b35addf8984000c175125b"><div class="ttname"><a href="../../d8/d03/class_object_guid.html#a78f5fb47e3b35addf8984000c175125b">ObjectGuid::ToString</a></div><div class="ttdeci">std::string ToString() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d5f/_object_guid_8cpp_source.html#l00047">ObjectGuid.cpp:47</a></div></div>
<div class="ttc" id="aclass_object_html_a3aeab7def818ba6c50249f197ad2f9ca"><div class="ttname"><a href="../../d8/d83/class_object.html#a3aeab7def818ba6c50249f197ad2f9ca">Object::IsInWorld</a></div><div class="ttdeci">bool IsInWorld() const</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d30/_object_8h_source.html#l00093">Object.h:93</a></div></div>
<div class="ttc" id="aclass_object_html_a4a4bdac0d151f9193aa3581bda31193c"><div class="ttname"><a href="../../d8/d83/class_object.html#a4a4bdac0d151f9193aa3581bda31193c">Object::ToCreature</a></div><div class="ttdeci">Creature * ToCreature()</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d30/_object_8h_source.html#l00183">Object.h:183</a></div></div>
<div class="ttc" id="aclass_object_html_a621a345fc34deed6d3a4e1e498a652da"><div class="ttname"><a href="../../d8/d83/class_object.html#a621a345fc34deed6d3a4e1e498a652da">Object::GetTypeId</a></div><div class="ttdeci">TypeID GetTypeId() const</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d30/_object_8h_source.html#l00107">Object.h:107</a></div></div>
<div class="ttc" id="aclass_object_html_a7253dbcbed15f5f1190c5cc56d141610"><div class="ttname"><a href="../../d8/d83/class_object.html#a7253dbcbed15f5f1190c5cc56d141610">Object::isType</a></div><div class="ttdeci">bool isType(uint16 mask) const</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d30/_object_8h_source.html#l00108">Object.h:108</a></div></div>
<div class="ttc" id="aclass_object_html_a8797257c31223076c1b76b4b1a6f8007"><div class="ttname"><a href="../../d8/d83/class_object.html#a8797257c31223076c1b76b4b1a6f8007">Object::GetFloatValue</a></div><div class="ttdeci">float GetFloatValue(uint16 index) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ded/_object_8cpp_source.html#l00312">Object.cpp:312</a></div></div>
<div class="ttc" id="aclass_object_html_ac7d5ffa5c25d3951457c9b0a3c90ce76"><div class="ttname"><a href="../../d8/d83/class_object.html#ac7d5ffa5c25d3951457c9b0a3c90ce76">Object::ToUnit</a></div><div class="ttdeci">Unit * ToUnit()</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d30/_object_8h_source.html#l00186">Object.h:186</a></div></div>
<div class="ttc" id="aclass_object_html_ad23b997e2442fa6a6228ba73a7ecc138"><div class="ttname"><a href="../../d8/d83/class_object.html#ad23b997e2442fa6a6228ba73a7ecc138">Object::GetGUID</a></div><div class="ttdeci">static ObjectGuid GetGUID(Object const *o)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d30/_object_8h_source.html#l00098">Object.h:98</a></div></div>
<div class="ttc" id="aclass_object_html_ad4b3f372b6700cd50e1eb7ef238cf3be"><div class="ttname"><a href="../../d8/d83/class_object.html#ad4b3f372b6700cd50e1eb7ef238cf3be">Object::GetPackGUID</a></div><div class="ttdeci">PackedGuid const  &amp; GetPackGUID() const</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d30/_object_8h_source.html#l00100">Object.h:100</a></div></div>
<div class="ttc" id="aclass_object_html_ae635434021784608b659501867538c87"><div class="ttname"><a href="../../d8/d83/class_object.html#ae635434021784608b659501867538c87">Object::ToPlayer</a></div><div class="ttdeci">Player * ToPlayer()</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d30/_object_8h_source.html#l00181">Object.h:181</a></div></div>
<div class="ttc" id="aclass_player_html"><div class="ttname"><a href="../../d8/d53/class_player.html">Player</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d39/_player_8h_source.html#l01023">Player.h:1024</a></div></div>
<div class="ttc" id="aclass_player_html_a0a8d74504a10a162c77d4a64d652a1b5"><div class="ttname"><a href="../../d8/d53/class_player.html#a0a8d74504a10a162c77d4a64d652a1b5">Player::SetSpellModTakingSpell</a></div><div class="ttdeci">void SetSpellModTakingSpell(Spell *spell, bool apply)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d82/_player_8cpp_source.html#l09375">Player.cpp:9375</a></div></div>
<div class="ttc" id="aclass_player_html_a0d99907a41953dfe2e4589a785503fc1"><div class="ttname"><a href="../../d8/d53/class_player.html#a0d99907a41953dfe2e4589a785503fc1">Player::RemoveRunesByAuraEffect</a></div><div class="ttdeci">void RemoveRunesByAuraEffect(AuraEffect const *aura)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d82/_player_8cpp_source.html#l12574">Player.cpp:12574</a></div></div>
<div class="ttc" id="aclass_player_html_a1c212b8f9ae8b1a38a41f9c7db005dca"><div class="ttname"><a href="../../d8/d53/class_player.html#a1c212b8f9ae8b1a38a41f9c7db005dca">Player::GetSession</a></div><div class="ttdeci">WorldSession * GetSession() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d39/_player_8h_source.html#l01940">Player.h:1940</a></div></div>
<div class="ttc" id="aclass_player_html_a37cb2ab58a7a8481ff23a57e7730e066"><div class="ttname"><a href="../../d8/d53/class_player.html#a37cb2ab58a7a8481ff23a57e7730e066">Player::SendDirectMessage</a></div><div class="ttdeci">void SendDirectMessage(WorldPacket *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d82/_player_8cpp_source.html#l05529">Player.cpp:5529</a></div></div>
<div class="ttc" id="aclass_player_html_a51561ce856656946ba127e4f0b049a35"><div class="ttname"><a href="../../d8/d53/class_player.html#a51561ce856656946ba127e4f0b049a35">Player::GetUseableItemByPos</a></div><div class="ttdeci">Item * GetUseableItemByPos(uint8 bag, uint8 slot) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d39/_player_8h_source.html#l01190">Player.h:1190</a></div></div>
<div class="ttc" id="aclass_player_html_a582a0cd15b37f0b0302e6f758e299e2c"><div class="ttname"><a href="../../d8/d53/class_player.html#a582a0cd15b37f0b0302e6f758e299e2c">Player::ActivateTaxiPathTo</a></div><div class="ttdeci">bool ActivateTaxiPathTo(std::vector&lt; uint32 &gt; const &amp;nodes, Creature *npc=nullptr, uint32 spellid=1)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d82/_player_8cpp_source.html#l09528">Player.cpp:9528</a></div></div>
<div class="ttc" id="aclass_player_html_a6b5d9a18a5a03f4e55b7ff90479acee9"><div class="ttname"><a href="../../d8/d53/class_player.html#a6b5d9a18a5a03f4e55b7ff90479acee9">Player::HasSpellCooldown</a></div><div class="ttdeci">bool HasSpellCooldown(uint32 spell_id) const override</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d39/_player_8h_source.html#l01721">Player.h:1721</a></div></div>
<div class="ttc" id="aclass_player_html_a7d8edd7357f54d719fbe47e021b9997e"><div class="ttname"><a href="../../d8/d53/class_player.html#a7d8edd7357f54d719fbe47e021b9997e">Player::AddSpellAndCategoryCooldowns</a></div><div class="ttdeci">void AddSpellAndCategoryCooldowns(SpellInfo const *spellInfo, uint32 itemId, Spell *spell=nullptr, bool infinityCooldown=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d82/_player_8cpp_source.html#l10176">Player.cpp:10176</a></div></div>
<div class="ttc" id="aclass_player_html_a8b94883b20744d45b498bb1ae292083d"><div class="ttname"><a href="../../d8/d53/class_player.html#a8b94883b20744d45b498bb1ae292083d">Player::AddSpellCooldown</a></div><div class="ttdeci">void AddSpellCooldown(uint32 spell_id, uint32 itemid, uint32 end_time, bool needSendToClient=false, bool forceSendToSpectator=false) override</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d82/_player_8cpp_source.html#l10349">Player.cpp:10349</a></div></div>
<div class="ttc" id="aclass_player_html_abe45751f505290dc65dbc0d0fd2e0370"><div class="ttname"><a href="../../d8/d53/class_player.html#abe45751f505290dc65dbc0d0fd2e0370">Player::ApplySpellMod</a></div><div class="ttdeci">T ApplySpellMod(uint32 spellId, SpellModOp op, T &amp;basevalue, Spell *spell=nullptr, bool temporaryPet=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d39/_player_8h_source.html#l02955">Player.h:2955</a></div></div>
<div class="ttc" id="aclass_player_html_ac1da2650933e6311dc3c26416ae70c9c"><div class="ttname"><a href="../../d8/d53/class_player.html#ac1da2650933e6311dc3c26416ae70c9c">Player::GetSpellCooldownDelay</a></div><div class="ttdeci">uint32 GetSpellCooldownDelay(uint32 spell_id) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d39/_player_8h_source.html#l01731">Player.h:1731</a></div></div>
<div class="ttc" id="aclass_player_html_ad52044947ef0aa2325b2688075bac34d"><div class="ttname"><a href="../../d8/d53/class_player.html#ad52044947ef0aa2325b2688075bac34d">Player::RemoveSpellCooldown</a></div><div class="ttdeci">void RemoveSpellCooldown(uint32 spell_id, bool update=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d82/_player_8cpp_source.html#l03414">Player.cpp:3414</a></div></div>
<div class="ttc" id="aclass_player_html_af30525fcf507cfc5f665e70eb6181318"><div class="ttname"><a href="../../d8/d53/class_player.html#af30525fcf507cfc5f665e70eb6181318">Player::SendCooldownEvent</a></div><div class="ttdeci">void SendCooldownEvent(SpellInfo const *spellInfo, uint32 itemId=0, Spell *spell=nullptr, bool setCooldown=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d82/_player_8cpp_source.html#l10369">Player.cpp:10369</a></div></div>
<div class="ttc" id="aclass_proc_event_info_html"><div class="ttname"><a href="../../df/def/class_proc_event_info.html">ProcEventInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00975">Unit.h:976</a></div></div>
<div class="ttc" id="aclass_proc_event_info_html_a759add2c89e786125196eb6bd3b20c6d"><div class="ttname"><a href="../../df/def/class_proc_event_info.html#a759add2c89e786125196eb6bd3b20c6d">ProcEventInfo::GetSpellInfo</a></div><div class="ttdeci">SpellInfo const  * GetSpellInfo() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l00176">Unit.cpp:176</a></div></div>
<div class="ttc" id="aclass_proc_event_info_html_a958e2f1cabb9e39bc575504f9ca568df"><div class="ttname"><a href="../../df/def/class_proc_event_info.html#a958e2f1cabb9e39bc575504f9ca568df">ProcEventInfo::GetActor</a></div><div class="ttdeci">Unit * GetActor()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00994">Unit.h:994</a></div></div>
<div class="ttc" id="aclass_proc_event_info_html_ad63bc4856be234d9968568b04cdf636a"><div class="ttname"><a href="../../df/def/class_proc_event_info.html#ad63bc4856be234d9968568b04cdf636a">ProcEventInfo::GetActionTarget</a></div><div class="ttdeci">Unit * GetActionTarget() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l00995">Unit.h:995</a></div></div>
<div class="ttc" id="aclass_proc_event_info_html_afb7b81b16f80f5a5dfea9b43347b4410"><div class="ttname"><a href="../../df/def/class_proc_event_info.html#afb7b81b16f80f5a5dfea9b43347b4410">ProcEventInfo::GetDamageInfo</a></div><div class="ttdeci">DamageInfo * GetDamageInfo() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l01004">Unit.h:1004</a></div></div>
<div class="ttc" id="aclass_spell_html"><div class="ttname"><a href="../../d8/d0d/class_spell.html">Spell</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dfa/_spell_8h_source.html#l00283">Spell.h:284</a></div></div>
<div class="ttc" id="aclass_spell_info_html"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html">SpellInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00312">SpellInfo.h:313</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a0a651a1cf655c9d5619f6b78e471656a"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a0a651a1cf655c9d5619f6b78e471656a">SpellInfo::IsRankOf</a></div><div class="ttdeci">bool IsRankOf(SpellInfo const *spellInfo) const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7f/_spell_info_8cpp_source.html#l02510">SpellInfo.cpp:2510</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a21cf48a7eb77db7f731ebe746d2d6878"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a21cf48a7eb77db7f731ebe746d2d6878">SpellInfo::Stances</a></div><div class="ttdeci">uint32 Stances</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00328">SpellInfo.h:328</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a30452de2bd62607418f3962d00124144"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a30452de2bd62607418f3962d00124144">SpellInfo::SpellFamilyFlags</a></div><div class="ttdeci">flag96 SpellFamilyFlags</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00382">SpellInfo.h:382</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a3f193840a6704ec13ba08bbe39824737"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a3f193840a6704ec13ba08bbe39824737">SpellInfo::IsAuraExclusiveBySpecificPerCasterWith</a></div><div class="ttdeci">bool IsAuraExclusiveBySpecificPerCasterWith(SpellInfo const *spellInfo) const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7f/_spell_info_8cpp_source.html#l01395">SpellInfo.cpp:1395</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a40cefe82961ab58e8070546b2d1a1fc5"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a40cefe82961ab58e8070546b2d1a1fc5">SpellInfo::ManaPerSecondPerLevel</a></div><div class="ttdeci">uint32 ManaPerSecondPerLevel</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00361">SpellInfo.h:361</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a40f8c8d2e4fc70591e503113a4328f46"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a40f8c8d2e4fc70591e503113a4328f46">SpellInfo::IsDeathPersistent</a></div><div class="ttdeci">bool IsDeathPersistent() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7f/_spell_info_8cpp_source.html#l01200">SpellInfo.cpp:1200</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a43566c3ed76d2e2a9eb6830061c772bd"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a43566c3ed76d2e2a9eb6830061c772bd">SpellInfo::IsCooldownStartedOnEvent</a></div><div class="ttdeci">bool IsCooldownStartedOnEvent() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7f/_spell_info_8cpp_source.html#l01195">SpellInfo.cpp:1195</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a44ac36a7f40b3c5b26a82a3bb0e8af30"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a44ac36a7f40b3c5b26a82a3bb0e8af30">SpellInfo::IsPassive</a></div><div class="ttdeci">bool IsPassive() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7f/_spell_info_8cpp_source.html#l01081">SpellInfo.cpp:1081</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a46f51f384b1455b03000e98a08d11790"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a46f51f384b1455b03000e98a08d11790">SpellInfo::StackAmount</a></div><div class="ttdeci">uint32 StackAmount</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00366">SpellInfo.h:366</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a49b3ca759c4a7aaa0f97c01c9273e39b"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a49b3ca759c4a7aaa0f97c01c9273e39b">SpellInfo::IsAuraExclusiveBySpecificWith</a></div><div class="ttdeci">bool IsAuraExclusiveBySpecificWith(SpellInfo const *spellInfo) const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7f/_spell_info_8cpp_source.html#l01363">SpellInfo.cpp:1363</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a49bc14059c2bd3785231c52e0d54d382"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a49bc14059c2bd3785231c52e0d54d382">SpellInfo::Id</a></div><div class="ttdeci">uint32 Id</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00315">SpellInfo.h:315</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a4b82e530c085010e7247ae0862301ac9"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a4b82e530c085010e7247ae0862301ac9">SpellInfo::ProcCharges</a></div><div class="ttdeci">uint32 ProcCharges</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00352">SpellInfo.h:352</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a517ef88a7d9ce773b7906bdd19a88e85"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a517ef88a7d9ce773b7906bdd19a88e85">SpellInfo::PowerType</a></div><div class="ttdeci">uint32 PowerType</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00357">SpellInfo.h:357</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a5f7fd27528084c1e80f74896fac4ac53"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a5f7fd27528084c1e80f74896fac4ac53">SpellInfo::GetSpellSpecific</a></div><div class="ttdeci">SpellSpecificType GetSpellSpecific() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7f/_spell_info_8cpp_source.html#l02079">SpellInfo.cpp:2079</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a6c038b16dbe3eacfcdd424c6075b8f78"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a6c038b16dbe3eacfcdd424c6075b8f78">SpellInfo::IsMultiSlotAura</a></div><div class="ttdeci">bool IsMultiSlotAura() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7f/_spell_info_8cpp_source.html#l01190">SpellInfo.cpp:1190</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a6cc135f2b87d1fecd6e7db475f9039dd"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a6cc135f2b87d1fecd6e7db475f9039dd">SpellInfo::GetMaxDuration</a></div><div class="ttdeci">int32 GetMaxDuration() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7f/_spell_info_8cpp_source.html#l02287">SpellInfo.cpp:2287</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a6dc0b0fd741c87fae3faccea295b0616"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a6dc0b0fd741c87fae3faccea295b0616">SpellInfo::EquippedItemClass</a></div><div class="ttdeci">int32 EquippedItemClass</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00370">SpellInfo.h:370</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a8fff47546b8052ac55963dd40e4ae394"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a8fff47546b8052ac55963dd40e4ae394">SpellInfo::ManaPerSecond</a></div><div class="ttdeci">uint32 ManaPerSecond</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00360">SpellInfo.h:360</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a93b51808183b35049d7e5847acee0390"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a93b51808183b35049d7e5847acee0390">SpellInfo::IsChanneled</a></div><div class="ttdeci">bool IsChanneled() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7f/_spell_info_8cpp_source.html#l01239">SpellInfo.cpp:1239</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a975746d6b737abb063ea037327abfc5a"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a975746d6b737abb063ea037327abfc5a">SpellInfo::HasAttribute</a></div><div class="ttdeci">bool HasAttribute(SpellAttr0 attribute) const</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00408">SpellInfo.h:408</a></div></div>
<div class="ttc" id="aclass_spell_info_html_a9904a9ebdd084815af5ef6d1653ffbbd"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#a9904a9ebdd084815af5ef6d1653ffbbd">SpellInfo::DurationEntry</a></div><div class="ttdeci">SpellDurationEntry const  * DurationEntry</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00356">SpellInfo.h:356</a></div></div>
<div class="ttc" id="aclass_spell_info_html_aa5bb0d7d6df03526d011d9cbfa3734e0"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#aa5bb0d7d6df03526d011d9cbfa3734e0">SpellInfo::Effects</a></div><div class="ttdeci">std::array&lt; SpellEffectInfo, MAX_SPELL_EFFECTS &gt; Effects</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00387">SpellInfo.h:387</a></div></div>
<div class="ttc" id="aclass_spell_info_html_aa8de3a55617f9dbe8313e4d66907a0b7"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#aa8de3a55617f9dbe8313e4d66907a0b7">SpellInfo::GetDuration</a></div><div class="ttdeci">int32 GetDuration() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7f/_spell_info_8cpp_source.html#l02280">SpellInfo.cpp:2280</a></div></div>
<div class="ttc" id="aclass_spell_info_html_abdcbf79c1c255a5f7029a93a75e5cebf"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#abdcbf79c1c255a5f7029a93a75e5cebf">SpellInfo::HasAreaAuraEffect</a></div><div class="ttdeci">bool HasAreaAuraEffect() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7f/_spell_info_8cpp_source.html#l00892">SpellInfo.cpp:892</a></div></div>
<div class="ttc" id="aclass_spell_info_html_ac8da2514a9cabed9631f91779dcd623c"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#ac8da2514a9cabed9631f91779dcd623c">SpellInfo::IsDifferentRankOf</a></div><div class="ttdeci">bool IsDifferentRankOf(SpellInfo const *spellInfo) const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7f/_spell_info_8cpp_source.html#l02515">SpellInfo.cpp:2515</a></div></div>
<div class="ttc" id="aclass_spell_info_html_af6ec577353f7d3cc59badd7d332153b0"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#af6ec577353f7d3cc59badd7d332153b0">SpellInfo::SpellFamilyName</a></div><div class="ttdeci">uint32 SpellFamilyName</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d70/_spell_info_8h_source.html#l00381">SpellInfo.h:381</a></div></div>
<div class="ttc" id="aclass_spell_info_html_afbd5cba63decf0bf28500d4fc795bc44"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#afbd5cba63decf0bf28500d4fc795bc44">SpellInfo::IsPositiveEffect</a></div><div class="ttdeci">bool IsPositiveEffect(uint8 effIndex) const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7f/_spell_info_8cpp_source.html#l01225">SpellInfo.cpp:1225</a></div></div>
<div class="ttc" id="aclass_spell_info_html_afc8742bc858cb12197c005168931cb2d"><div class="ttname"><a href="../../d4/d7d/class_spell_info.html#afc8742bc858cb12197c005168931cb2d">SpellInfo::IsSingleTarget</a></div><div class="ttdeci">bool IsSingleTarget() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7f/_spell_info_8cpp_source.html#l01346">SpellInfo.cpp:1346</a></div></div>
<div class="ttc" id="aclass_unit_aura_html"><div class="ttname"><a href="../../d1/dde/class_unit_aura.html">UnitAura</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00274">SpellAuras.h:275</a></div></div>
<div class="ttc" id="aclass_unit_aura_html_a28f714404942bb5c614ac844cf937546"><div class="ttname"><a href="../../d1/dde/class_unit_aura.html#a28f714404942bb5c614ac844cf937546">UnitAura::Remove</a></div><div class="ttdeci">void Remove(AuraRemoveMode removeMode=AURA_REMOVE_BY_DEFAULT) override</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02685">SpellAuras.cpp:2685</a></div></div>
<div class="ttc" id="aclass_unit_aura_html_a4b413c5e62eee76875a22345059e6124"><div class="ttname"><a href="../../d1/dde/class_unit_aura.html#a4b413c5e62eee76875a22345059e6124">UnitAura::m_AuraDRGroup</a></div><div class="ttdeci">DiminishingGroup m_AuraDRGroup</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00294">SpellAuras.h:294</a></div></div>
<div class="ttc" id="aclass_unit_aura_html_a8ebf7b01e7f324938f68ad4ce74d56b5"><div class="ttname"><a href="../../d1/dde/class_unit_aura.html#a8ebf7b01e7f324938f68ad4ce74d56b5">UnitAura::GetDiminishGroup</a></div><div class="ttdeci">DiminishingGroup GetDiminishGroup() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dcf/_spell_auras_8h_source.html#l00291">SpellAuras.h:291</a></div></div>
<div class="ttc" id="aclass_unit_aura_html_a920549cf55c8def37149b00ae971127d"><div class="ttname"><a href="../../d1/dde/class_unit_aura.html#a920549cf55c8def37149b00ae971127d">UnitAura::_ApplyForTarget</a></div><div class="ttdeci">void _ApplyForTarget(Unit *target, Unit *caster, AuraApplication *aurApp) override</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02667">SpellAuras.cpp:2667</a></div></div>
<div class="ttc" id="aclass_unit_aura_html_ada4033955271dfb21d16a95b316087f5"><div class="ttname"><a href="../../d1/dde/class_unit_aura.html#ada4033955271dfb21d16a95b316087f5">UnitAura::UnitAura</a></div><div class="ttdeci">UnitAura(SpellInfo const *spellproto, uint8 effMask, WorldObject *owner, Unit *caster, int32 *baseAmount, Item *castItem, ObjectGuid casterGUID, ObjectGuid itemGUID=ObjectGuid::Empty)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02658">SpellAuras.cpp:2658</a></div></div>
<div class="ttc" id="aclass_unit_aura_html_add5ce04446338e078c5986420abfd16e"><div class="ttname"><a href="../../d1/dde/class_unit_aura.html#add5ce04446338e078c5986420abfd16e">UnitAura::FillTargetMap</a></div><div class="ttdeci">void FillTargetMap(std::map&lt; Unit *, uint8 &gt; &amp;targets, Unit *caster) override</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02692">SpellAuras.cpp:2692</a></div></div>
<div class="ttc" id="aclass_unit_aura_html_af4d453cee6758e633bdcae0049581898"><div class="ttname"><a href="../../d1/dde/class_unit_aura.html#af4d453cee6758e633bdcae0049581898">UnitAura::_UnapplyForTarget</a></div><div class="ttdeci">void _UnapplyForTarget(Unit *target, Unit *caster, AuraApplication *aurApp) override</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/db3/_spell_auras_8cpp_source.html#l02676">SpellAuras.cpp:2676</a></div></div>
<div class="ttc" id="aclass_unit_html"><div class="ttname"><a href="../../da/db7/class_unit.html">Unit</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l01418">Unit.h:1419</a></div></div>
<div class="ttc" id="aclass_unit_html_a000570a88dd253d3746e6ff5ac1c918b"><div class="ttname"><a href="../../da/db7/class_unit.html#a000570a88dd253d3746e6ff5ac1c918b">Unit::HasAuraTypeWithAffectMask</a></div><div class="ttdeci">bool HasAuraTypeWithAffectMask(AuraType auratype, SpellInfo const *affectedSpell) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l05227">Unit.cpp:5227</a></div></div>
<div class="ttc" id="aclass_unit_html_a009a87eeb9cc40ed7017610cbb914b9b"><div class="ttname"><a href="../../da/db7/class_unit.html#a009a87eeb9cc40ed7017610cbb914b9b">Unit::ModifyHealth</a></div><div class="ttdeci">int32 ModifyHealth(int32 val)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l13270">Unit.cpp:13270</a></div></div>
<div class="ttc" id="aclass_unit_html_a07e3ea0e73b3ac9987aedd33c99873c9"><div class="ttname"><a href="../../da/db7/class_unit.html#a07e3ea0e73b3ac9987aedd33c99873c9">Unit::RemoveOwnedAura</a></div><div class="ttdeci">void RemoveOwnedAura(AuraMap::iterator &amp;i, AuraRemoveMode removeMode=AURA_REMOVE_BY_DEFAULT)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l04222">Unit.cpp:4222</a></div></div>
<div class="ttc" id="aclass_unit_html_a135e4d345c338da83450a60528f71222"><div class="ttname"><a href="../../da/db7/class_unit.html#a135e4d345c338da83450a60528f71222">Unit::GetAura</a></div><div class="ttdeci">Aura * GetAura(uint32 spellId, ObjectGuid casterGUID=ObjectGuid::Empty, ObjectGuid itemCasterGUID=ObjectGuid::Empty, uint8 reqEffMask=0) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l05076">Unit.cpp:5076</a></div></div>
<div class="ttc" id="aclass_unit_html_a142e7592a0de507230fc0c8868f9c49f"><div class="ttname"><a href="../../da/db7/class_unit.html#a142e7592a0de507230fc0c8868f9c49f">Unit::GetVisibleAura</a></div><div class="ttdeci">AuraApplication * GetVisibleAura(uint8 slot)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l02239">Unit.h:2239</a></div></div>
<div class="ttc" id="aclass_unit_html_a1560f8912954788c900cab1bfa57ea76"><div class="ttname"><a href="../../da/db7/class_unit.html#a1560f8912954788c900cab1bfa57ea76">Unit::RemoveAurasWithFamily</a></div><div class="ttdeci">void RemoveAurasWithFamily(SpellFamilyNames family, uint32 familyFlag1, uint32 familyFlag2, uint32 familyFlag3, ObjectGuid casterGUID)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l04710">Unit.cpp:4710</a></div></div>
<div class="ttc" id="aclass_unit_html_a16a73fea59a6ef3595093aa29225b37b"><div class="ttname"><a href="../../da/db7/class_unit.html#a16a73fea59a6ef3595093aa29225b37b">Unit::GetOwner</a></div><div class="ttdeci">Unit * GetOwner() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l09994">Unit.cpp:9994</a></div></div>
<div class="ttc" id="aclass_unit_html_a18f77484ed2acc7be7fa29d1df7a0c12"><div class="ttname"><a href="../../da/db7/class_unit.html#a18f77484ed2acc7be7fa29d1df7a0c12">Unit::CombatStop</a></div><div class="ttdeci">void CombatStop(bool includingCast=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l09835">Unit.cpp:9835</a></div></div>
<div class="ttc" id="aclass_unit_html_a1afc1e413f12c5bd7bc00c926fa05833"><div class="ttname"><a href="../../da/db7/class_unit.html#a1afc1e413f12c5bd7bc00c926fa05833">Unit::ApplySpellImmune</a></div><div class="ttdeci">void ApplySpellImmune(uint32 spellId, uint32 op, uint32 type, bool apply, SpellImmuneBlockType blockType=SPELL_BLOCK_TYPE_ALL)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l12604">Unit.cpp:12604</a></div></div>
<div class="ttc" id="aclass_unit_html_a1b5426ed0a821b78377faac8113796b1"><div class="ttname"><a href="../../da/db7/class_unit.html#a1b5426ed0a821b78377faac8113796b1">Unit::GetAuraOfRankedSpell</a></div><div class="ttdeci">Aura * GetAuraOfRankedSpell(uint32 spellId, ObjectGuid casterGUID=ObjectGuid::Empty, ObjectGuid itemCasterGUID=ObjectGuid::Empty, uint8 reqEffMask=0) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l05094">Unit.cpp:5094</a></div></div>
<div class="ttc" id="aclass_unit_html_a1be09c524dfdd2c3538f2ae977c58399"><div class="ttname"><a href="../../da/db7/class_unit.html#a1be09c524dfdd2c3538f2ae977c58399">Unit::RemoveAura</a></div><div class="ttdeci">void RemoveAura(AuraApplicationMap::iterator &amp;i, AuraRemoveMode mode=AURA_REMOVE_BY_DEFAULT)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l04293">Unit.cpp:4293</a></div></div>
<div class="ttc" id="aclass_unit_html_a2681906ad625eb9effbe367c7f53a930"><div class="ttname"><a href="../../da/db7/class_unit.html#a2681906ad625eb9effbe367c7f53a930">Unit::_UnapplyAura</a></div><div class="ttdeci">void _UnapplyAura(AuraApplicationMap::iterator &amp;i, AuraRemoveMode removeMode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l04083">Unit.cpp:4083</a></div></div>
<div class="ttc" id="aclass_unit_html_a287b4053316a12110b478f5e757a3055"><div class="ttname"><a href="../../da/db7/class_unit.html#a287b4053316a12110b478f5e757a3055">Unit::GetVisibleAuras</a></div><div class="ttdeci">VisibleAuraMap const  * GetVisibleAuras()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l02238">Unit.h:2238</a></div></div>
<div class="ttc" id="aclass_unit_html_a2e6a98844f96c211f47b911a2766ada8"><div class="ttname"><a href="../../da/db7/class_unit.html#a2e6a98844f96c211f47b911a2766ada8">Unit::GetSpellModOwner</a></div><div class="ttdeci">Player * GetSpellModOwner() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l15937">Unit.cpp:15937</a></div></div>
<div class="ttc" id="aclass_unit_html_a2e9a4c70bb5a75e546c63acf5242b6f0"><div class="ttname"><a href="../../da/db7/class_unit.html#a2e9a4c70bb5a75e546c63acf5242b6f0">Unit::FindCurrentSpellBySpellId</a></div><div class="ttdeci">Spell * FindCurrentSpellBySpellId(uint32 spell_id) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l03671">Unit.cpp:3671</a></div></div>
<div class="ttc" id="aclass_unit_html_a3ac5eb5e55d7c23cda7d7a7f3d23cc68"><div class="ttname"><a href="../../da/db7/class_unit.html#a3ac5eb5e55d7c23cda7d7a7f3d23cc68">Unit::GetAuraApplication</a></div><div class="ttdeci">AuraApplication * GetAuraApplication(uint32 spellId, ObjectGuid casterGUID=ObjectGuid::Empty, ObjectGuid itemCasterGUID=ObjectGuid::Empty, uint8 reqEffMask=0, AuraApplication *except=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l05057">Unit.cpp:5057</a></div></div>
<div class="ttc" id="aclass_unit_html_a490990b2ec18be95c613e6394e4f3f6a"><div class="ttname"><a href="../../da/db7/class_unit.html#a490990b2ec18be95c613e6394e4f3f6a">Unit::CalcSpellDuration</a></div><div class="ttdeci">int32 CalcSpellDuration(SpellInfo const *spellProto)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l14013">Unit.cpp:14013</a></div></div>
<div class="ttc" id="aclass_unit_html_a4bc8894be0429317c16b9caa371032f6"><div class="ttname"><a href="../../da/db7/class_unit.html#a4bc8894be0429317c16b9caa371032f6">Unit::RemoveVisibleAura</a></div><div class="ttdeci">void RemoveVisibleAura(uint8 slot)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l02247">Unit.h:2247</a></div></div>
<div class="ttc" id="aclass_unit_html_a51d433dde350cd94d7c3c43e30ca997f"><div class="ttname"><a href="../../da/db7/class_unit.html#a51d433dde350cd94d7c3c43e30ca997f">Unit::AddAura</a></div><div class="ttdeci">Aura * AddAura(uint32 spellId, Unit *target)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l17980">Unit.cpp:17980</a></div></div>
<div class="ttc" id="aclass_unit_html_a51ec81e114bf82a2485ba9f66200afd2"><div class="ttname"><a href="../../da/db7/class_unit.html#a51ec81e114bf82a2485ba9f66200afd2">Unit::CastCustomSpell</a></div><div class="ttdeci">SpellCastResult CastCustomSpell(Unit *victim, uint32 spellId, int32 const *bp0, int32 const *bp1, int32 const *bp2, bool triggered, Item *castItem=nullptr, AuraEffect const *triggeredByAura=nullptr, ObjectGuid originalCaster=ObjectGuid::Empty)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l01144">Unit.cpp:1144</a></div></div>
<div class="ttc" id="aclass_unit_html_a520e229dc1a93ea4a53d0ba81e586d11"><div class="ttname"><a href="../../da/db7/class_unit.html#a520e229dc1a93ea4a53d0ba81e586d11">Unit::GetAuraEffect</a></div><div class="ttdeci">AuraEffect * GetAuraEffect(uint32 spellId, uint8 effIndex, ObjectGuid casterGUID=ObjectGuid::Empty) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l04989">Unit.cpp:4989</a></div></div>
<div class="ttc" id="aclass_unit_html_a58a507ebe628930b8a506144b364d84b"><div class="ttname"><a href="../../da/db7/class_unit.html#a58a507ebe628930b8a506144b364d84b">Unit::getClass</a></div><div class="ttdeci">uint8 getClass() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l01545">Unit.h:1545</a></div></div>
<div class="ttc" id="aclass_unit_html_a69c5ac45b65cf0dede6e0ee837361f61"><div class="ttname"><a href="../../da/db7/class_unit.html#a69c5ac45b65cf0dede6e0ee837361f61">Unit::HasAura</a></div><div class="ttdeci">bool HasAura(uint32 spellId, ObjectGuid casterGUID=ObjectGuid::Empty, ObjectGuid itemCasterGUID=ObjectGuid::Empty, uint8 reqEffMask=0) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l05187">Unit.cpp:5187</a></div></div>
<div class="ttc" id="aclass_unit_html_a6bbd36a660c01a3d5f3e28a6e8eb894c"><div class="ttname"><a href="../../da/db7/class_unit.html#a6bbd36a660c01a3d5f3e28a6e8eb894c">Unit::VisibleAuraMap</a></div><div class="ttdeci">std::map&lt; uint8, AuraApplication * &gt; VisibleAuraMap</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l01441">Unit.h:1441</a></div></div>
<div class="ttc" id="aclass_unit_html_a71c66b7e4d8815d9ea68b838f4ff0f09"><div class="ttname"><a href="../../da/db7/class_unit.html#a71c66b7e4d8815d9ea68b838f4ff0f09">Unit::ModifyPower</a></div><div class="ttdeci">int32 ModifyPower(Powers power, int32 val)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l13328">Unit.cpp:13328</a></div></div>
<div class="ttc" id="aclass_unit_html_a73f40bd61fe24bcead25d6ab3b9efc25"><div class="ttname"><a href="../../da/db7/class_unit.html#a73f40bd61fe24bcead25d6ab3b9efc25">Unit::GetAuraEffectDummy</a></div><div class="ttdeci">AuraEffect * GetAuraEffectDummy(uint32 spellid) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l05045">Unit.cpp:5045</a></div></div>
<div class="ttc" id="aclass_unit_html_a745ede574ea561dcfdd7f32f2f2a6c7e"><div class="ttname"><a href="../../da/db7/class_unit.html#a745ede574ea561dcfdd7f32f2f2a6c7e">Unit::HasSpell</a></div><div class="ttdeci">virtual bool HasSpell(uint32) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l01783">Unit.h:1783</a></div></div>
<div class="ttc" id="aclass_unit_html_a7b8654ccb16f3b1e7be4d93d74a304ba"><div class="ttname"><a href="../../da/db7/class_unit.html#a7b8654ccb16f3b1e7be4d93d74a304ba">Unit::IsDuringRemoveFromWorld</a></div><div class="ttdeci">bool IsDuringRemoveFromWorld() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l02465">Unit.h:2465</a></div></div>
<div class="ttc" id="aclass_unit_html_a84c1f5910cb098f81a290fba938ad4c7"><div class="ttname"><a href="../../da/db7/class_unit.html#a84c1f5910cb098f81a290fba938ad4c7">Unit::GetSingleCastAuras</a></div><div class="ttdeci">AuraList &amp; GetSingleCastAuras()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l02048">Unit.h:2048</a></div></div>
<div class="ttc" id="aclass_unit_html_a8e8d13276a1ebef454bd4fc27fedc3f1"><div class="ttname"><a href="../../da/db7/class_unit.html#a8e8d13276a1ebef454bd4fc27fedc3f1">Unit::SpellDamageBonusTaken</a></div><div class="ttdeci">uint32 SpellDamageBonusTaken(Unit *caster, SpellInfo const *spellProto, uint32 pdamage, DamageEffectType damagetype, uint32 stack=1)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l11131">Unit.cpp:11131</a></div></div>
<div class="ttc" id="aclass_unit_html_a8ef92f1d3a61f9fb2c8c24323d5d24af"><div class="ttname"><a href="../../da/db7/class_unit.html#a8ef92f1d3a61f9fb2c8c24323d5d24af">Unit::GetDummyAuraEffect</a></div><div class="ttdeci">AuraEffect * GetDummyAuraEffect(SpellFamilyNames name, uint32 iconId, uint8 effIndex) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l02056">Unit.h:2056</a></div></div>
<div class="ttc" id="aclass_unit_html_a93f83fd909310de2c76382d00d7dbbf1"><div class="ttname"><a href="../../da/db7/class_unit.html#a93f83fd909310de2c76382d00d7dbbf1">Unit::GetMaxPower</a></div><div class="ttdeci">uint32 GetMaxPower(Powers power) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l01581">Unit.h:1581</a></div></div>
<div class="ttc" id="aclass_unit_html_a95169cc622a982afdbb1e5d865148c9d"><div class="ttname"><a href="../../da/db7/class_unit.html#a95169cc622a982afdbb1e5d865148c9d">Unit::_AddAura</a></div><div class="ttdeci">void _AddAura(UnitAura *aura, Unit *caster)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l03941">Unit.cpp:3941</a></div></div>
<div class="ttc" id="aclass_unit_html_a958172d6051b106e3b3c776e4f9f3952"><div class="ttname"><a href="../../da/db7/class_unit.html#a958172d6051b106e3b3c776e4f9f3952">Unit::GetHealth</a></div><div class="ttdeci">uint32 GetHealth() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l01559">Unit.h:1559</a></div></div>
<div class="ttc" id="aclass_unit_html_a9f63d861cbd0113802b941275e90208c"><div class="ttname"><a href="../../da/db7/class_unit.html#a9f63d861cbd0113802b941275e90208c">Unit::_TryStackingOrRefreshingExistingAura</a></div><div class="ttdeci">Aura * _TryStackingOrRefreshingExistingAura(SpellInfo const *newAura, uint8 effMask, Unit *caster, int32 *baseAmount=nullptr, Item *castItem=nullptr, ObjectGuid casterGUID=ObjectGuid::Empty, bool periodicReset=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l03882">Unit.cpp:3882</a></div></div>
<div class="ttc" id="aclass_unit_html_aa0334351e83f140bc1af4c9ed33557c4"><div class="ttname"><a href="../../da/db7/class_unit.html#aa0334351e83f140bc1af4c9ed33557c4">Unit::SetVisibleAura</a></div><div class="ttdeci">void SetVisibleAura(uint8 slot, AuraApplication *aur)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l02246">Unit.h:2246</a></div></div>
<div class="ttc" id="aclass_unit_html_aa3ca95f7a14041f562ed69c3994afdfc"><div class="ttname"><a href="../../da/db7/class_unit.html#aa3ca95f7a14041f562ed69c3994afdfc">Unit::CastSpell</a></div><div class="ttdeci">SpellCastResult CastSpell(SpellCastTargets const &amp;targets, SpellInfo const *spellInfo, CustomSpellValues const *value, TriggerCastFlags triggerFlags=TRIGGERED_NONE, Item *castItem=nullptr, AuraEffect const *triggeredByAura=nullptr, ObjectGuid originalCaster=ObjectGuid::Empty)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l01087">Unit.cpp:1087</a></div></div>
<div class="ttc" id="aclass_unit_html_aac612f06e84142d92dcfc432b5feb4ac"><div class="ttname"><a href="../../da/db7/class_unit.html#aac612f06e84142d92dcfc432b5feb4ac">Unit::RemoveAurasDueToSpell</a></div><div class="ttdeci">void RemoveAurasDueToSpell(uint32 spellId, ObjectGuid casterGUID=ObjectGuid::Empty, uint8 reqEffMask=0, AuraRemoveMode removeMode=AURA_REMOVE_BY_DEFAULT)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l04420">Unit.cpp:4420</a></div></div>
<div class="ttc" id="aclass_unit_html_ab5bd7480bb38a756459b9626c50576b7"><div class="ttname"><a href="../../da/db7/class_unit.html#ab5bd7480bb38a756459b9626c50576b7">Unit::GetVehicleKit</a></div><div class="ttdeci">Vehicle * GetVehicleKit() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l02422">Unit.h:2422</a></div></div>
<div class="ttc" id="aclass_unit_html_abbc1994b31e8c2706a99c0d35269b89c"><div class="ttname"><a href="../../da/db7/class_unit.html#abbc1994b31e8c2706a99c0d35269b89c">Unit::IsInFeralForm</a></div><div class="ttdeci">bool IsInFeralForm() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l02159">Unit.h:2159</a></div></div>
<div class="ttc" id="aclass_unit_html_abdfe022523c40277d917754f75edb722"><div class="ttname"><a href="../../da/db7/class_unit.html#abdfe022523c40277d917754f75edb722">Unit::IsFriendlyTo</a></div><div class="ttdeci">bool IsFriendlyTo(Unit const *unit) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l09649">Unit.cpp:9649</a></div></div>
<div class="ttc" id="aclass_unit_html_ad44d31430fab9282a79e8682822ccd9c"><div class="ttname"><a href="../../da/db7/class_unit.html#ad44d31430fab9282a79e8682822ccd9c">Unit::getPowerType</a></div><div class="ttdeci">Powers getPowerType() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l01578">Unit.h:1578</a></div></div>
<div class="ttc" id="aclass_unit_html_ad7e475d80b9af430cc076d7c01f967e9"><div class="ttname"><a href="../../da/db7/class_unit.html#ad7e475d80b9af430cc076d7c01f967e9">Unit::GetPower</a></div><div class="ttdeci">uint32 GetPower(Powers power) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l01580">Unit.h:1580</a></div></div>
<div class="ttc" id="aclass_unit_html_ad8ea13960b62a966b516a1929585ea7b"><div class="ttname"><a href="../../da/db7/class_unit.html#ad8ea13960b62a966b516a1929585ea7b">Unit::GetTotalAuraModifier</a></div><div class="ttdeci">int32 GetTotalAuraModifier(AuraType auratype) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l05386">Unit.cpp:5386</a></div></div>
<div class="ttc" id="aclass_unit_html_adc6d98745d565970b4a89088ec5b5a42"><div class="ttname"><a href="../../da/db7/class_unit.html#adc6d98745d565970b4a89088ec5b5a42">Unit::getLevel</a></div><div class="ttdeci">uint8 getLevel() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l01539">Unit.h:1539</a></div></div>
<div class="ttc" id="aclass_unit_html_adcdd87d0c137619dfc869536c1315dd7"><div class="ttname"><a href="../../da/db7/class_unit.html#adcdd87d0c137619dfc869536c1315dd7">Unit::AuraEffectList</a></div><div class="ttdeci">std::list&lt; AuraEffect * &gt; AuraEffectList</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l01435">Unit.h:1435</a></div></div>
<div class="ttc" id="aclass_unit_html_ae0ca62842bea9e94497c0200b37891d8"><div class="ttname"><a href="../../da/db7/class_unit.html#ae0ca62842bea9e94497c0200b37891d8">Unit::GetCreateMana</a></div><div class="ttdeci">uint32 GetCreateMana() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l02120">Unit.h:2120</a></div></div>
<div class="ttc" id="aclass_unit_html_ae2d52757675f654e5e314e49c5df210b"><div class="ttname"><a href="../../da/db7/class_unit.html#ae2d52757675f654e5e314e49c5df210b">Unit::ApplyDiminishingAura</a></div><div class="ttdeci">void ApplyDiminishingAura(DiminishingGroup group, bool apply)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l14283">Unit.cpp:14283</a></div></div>
<div class="ttc" id="aclass_unit_html_aeac23e55488fc69a1b90f0e92eaf1626"><div class="ttname"><a href="../../da/db7/class_unit.html#aeac23e55488fc69a1b90f0e92eaf1626">Unit::SpellHealingBonusTaken</a></div><div class="ttdeci">uint32 SpellHealingBonusTaken(Unit *caster, SpellInfo const *spellProto, uint32 healamount, DamageEffectType damagetype, uint32 stack=1)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2e/_unit_8cpp_source.html#l11904">Unit.cpp:11904</a></div></div>
<div class="ttc" id="aclass_unit_html_af00ac6c4dc7e639ac646fdafef336e85"><div class="ttname"><a href="../../da/db7/class_unit.html#af00ac6c4dc7e639ac646fdafef336e85">Unit::GetAuraEffectsByType</a></div><div class="ttdeci">AuraEffectList const  &amp; GetAuraEffectsByType(AuraType type) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l02047">Unit.h:2047</a></div></div>
<div class="ttc" id="aclass_unit_html_af387d5e18806e37f65ebc3408c0b8712"><div class="ttname"><a href="../../da/db7/class_unit.html#af387d5e18806e37f65ebc3408c0b8712">Unit::GetTarget</a></div><div class="ttdeci">ObjectGuid GetTarget() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d32/_unit_8h_source.html#l02502">Unit.h:2502</a></div></div>
<div class="ttc" id="aclass_vehicle_html"><div class="ttname"><a href="../../dd/df6/class_vehicle.html">Vehicle</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/_vehicle_8h_source.html#l00029">Vehicle.h:30</a></div></div>
<div class="ttc" id="aclass_vehicle_html_a1b4a880c866af98a9eccc944786e3393"><div class="ttname"><a href="../../dd/df6/class_vehicle.html#a1b4a880c866af98a9eccc944786e3393">Vehicle::GetAvailableSeatCount</a></div><div class="ttdeci">uint8 GetAvailableSeatCount() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dce/_vehicle_8cpp_source.html#l00602">Vehicle.cpp:602</a></div></div>
<div class="ttc" id="aclass_vehicle_html_a250a3ae75407ecbf79d3235a9c56679f"><div class="ttname"><a href="../../dd/df6/class_vehicle.html#a250a3ae75407ecbf79d3235a9c56679f">Vehicle::GetPassenger</a></div><div class="ttdeci">Unit * GetPassenger(int8 seatId) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dce/_vehicle_8cpp_source.html#l00226">Vehicle.cpp:226</a></div></div>
<div class="ttc" id="aclass_world_object_html"><div class="ttname"><a href="../../db/df7/class_world_object.html">WorldObject</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d30/_object_8h_source.html#l00668">Object.h:669</a></div></div>
<div class="ttc" id="aclass_world_object_html_a244693d75c766f83ce5cba27ed08a064"><div class="ttname"><a href="../../db/df7/class_world_object.html#a244693d75c766f83ce5cba27ed08a064">WorldObject::SendMessageToSet</a></div><div class="ttdeci">virtual void SendMessageToSet(WorldPacket *data, bool self)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d30/_object_8h_source.html#l00765">Object.h:765</a></div></div>
<div class="ttc" id="aclass_world_object_html_a76c507a1b3adcebf2732572bc6b67fe0"><div class="ttname"><a href="../../db/df7/class_world_object.html#a76c507a1b3adcebf2732572bc6b67fe0">WorldObject::GetMap</a></div><div class="ttdeci">Map * GetMap() const</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d30/_object_8h_source.html#l00800">Object.h:800</a></div></div>
<div class="ttc" id="aclass_world_object_html_ac7e0924673f67475886cdb46c4137700"><div class="ttname"><a href="../../db/df7/class_world_object.html#ac7e0924673f67475886cdb46c4137700">WorldObject::IsWithinLOSInMap</a></div><div class="ttdeci">bool IsWithinLOSInMap(WorldObject const *obj, LineOfSightChecks checks=LINEOFSIGHT_ALL_CHECKS) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ded/_object_8cpp_source.html#l01395">Object.cpp:1395</a></div></div>
<div class="ttc" id="aclass_world_object_html_ae1a8efe701e885f0ed1eaeb93bbece8e"><div class="ttname"><a href="../../db/df7/class_world_object.html#ae1a8efe701e885f0ed1eaeb93bbece8e">WorldObject::GetZoneAndAreaId</a></div><div class="ttdeci">void GetZoneAndAreaId(uint32 &amp;zoneid, uint32 &amp;areaid) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ded/_object_8cpp_source.html#l03207">Object.cpp:3207</a></div></div>
<div class="ttc" id="aclass_world_object_html_af150fb9ed281044f6dbaff6cb68522bc"><div class="ttname"><a href="../../db/df7/class_world_object.html#af150fb9ed281044f6dbaff6cb68522bc">WorldObject::IsSelfOrInSameMap</a></div><div class="ttdeci">bool IsSelfOrInSameMap(const WorldObject *obj) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ded/_object_8cpp_source.html#l01323">Object.cpp:1323</a></div></div>
<div class="ttc" id="aclass_world_packet_html"><div class="ttname"><a href="../../d6/d1a/class_world_packet.html">WorldPacket</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d66/_world_packet_8h_source.html#l00026">WorldPacket.h:27</a></div></div>
<div class="ttc" id="aclass_world_session_html_a6518fa6d76b730689eb44f2256af3726"><div class="ttname"><a href="../../d1/d47/class_world_session.html#a6518fa6d76b730689eb44f2256af3726">WorldSession::PlayerLoading</a></div><div class="ttdeci">bool PlayerLoading() const</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc6/_world_session_8h_source.html#l00247">WorldSession.h:247</a></div></div>
<div class="ttc" id="adtoa_8c_html_a158860430cb5f139d88fdf19cf9ad511"><div class="ttname"><a href="../../d9/d39/dtoa_8c.html#a158860430cb5f139d88fdf19cf9ad511">diff</a></div><div class="ttdeci">static Bigint * diff(Bigint *a, Bigint *b, Stack_alloc *alloc)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d39/dtoa_8c_source.html#l01108">dtoa.c:1108</a></div></div>
<div class="ttc" id="afmt_2include_2fmt_2core_8h_html_a7aead736a07eaf25623ad7bfa1f0ee2d"><div class="ttname"><a href="../../d5/d71/fmt_2include_2fmt_2core_8h.html#a7aead736a07eaf25623ad7bfa1f0ee2d">type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d71/fmt_2include_2fmt_2core_8h_source.html#l01048">core.h:1048</a></div></div>
<div class="ttc" id="agroup__u2w_html_gga1073b6abb3a749f18bf1633020879e9ba415333289b810185d3b617c43fdf5f4c"><div class="ttname"><a href="../../d2/dec/group__u2w.html#gga1073b6abb3a749f18bf1633020879e9ba415333289b810185d3b617c43fdf5f4c">SMSG_AURA_UPDATE</a></div><div class="ttdeci">@ SMSG_AURA_UPDATE</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d10/_opcodes_8h_source.html#l01204">Opcodes.h:1204</a></div></div>
<div class="ttc" id="agroup__u2w_html_gga1073b6abb3a749f18bf1633020879e9ba5fec169c1f6ef708fd7217f7dcba3a31"><div class="ttname"><a href="../../d2/dec/group__u2w.html#gga1073b6abb3a749f18bf1633020879e9ba5fec169c1f6ef708fd7217f7dcba3a31">SMSG_MODIFY_COOLDOWN</a></div><div class="ttdeci">@ SMSG_MODIFY_COOLDOWN</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d10/_opcodes_8h_source.html#l01199">Opcodes.h:1199</a></div></div>
<div class="ttc" id="am__string_8h_html_af1756e67d46227b3333bc21a1fadd361"><div class="ttname"><a href="../../d6/dda/m__string_8h.html#af1756e67d46227b3333bc21a1fadd361">memset</a></div><div class="ttdeci">#define memset(A, C, B)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dda/m__string_8h_source.html#l00051">m_string.h:51</a></div></div>
<div class="ttc" id="amy__global_8h_html_adde6aaee8457bee49c2a92621fe22b79"><div class="ttname"><a href="../../d9/df6/my__global_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a></div><div class="ttdeci">unsigned char uint8</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df6/my__global_8h_source.html#l00881">my_global.h:881</a></div></div>
<div class="ttc" id="anamespace_account_mgr_html_aa215c9a96c37b8a5d76d980ecf8de114"><div class="ttname"><a href="../../df/d1b/namespace_account_mgr.html#aa215c9a96c37b8a5d76d980ecf8de114">AccountMgr::GetId</a></div><div class="ttdeci">uint32 GetId(std::string const &amp;username)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dac/_account_mgr_8cpp_source.html#l00200">AccountMgr.cpp:200</a></div></div>
<div class="ttc" id="anamespace_account_mgr_html_af911e3860ec519c541d6df35468ee41b"><div class="ttname"><a href="../../df/d1b/namespace_account_mgr.html#af911e3860ec519c541d6df35468ee41b">AccountMgr::GetName</a></div><div class="ttdeci">bool GetName(uint32 accountId, std::string &amp;name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dac/_account_mgr_8cpp_source.html#l00228">AccountMgr.cpp:228</a></div></div>
<div class="ttc" id="anamespace_arena_spectator_html_a29f78349223aca49d417c3f818b2dd4c"><div class="ttname"><a href="../../da/d60/namespace_arena_spectator.html#a29f78349223aca49d417c3f818b2dd4c">ArenaSpectator::ShouldSendAura</a></div><div class="ttdeci">AC_GAME_API bool ShouldSendAura(Aura *aura, uint8 effMask, ObjectGuid targetGUID, bool remove)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d80/_arena_spectator_8cpp_source.html#l00282">ArenaSpectator.cpp:282</a></div></div>
<div class="ttc" id="anamespace_arena_spectator_html_a918c7c3c9fd7d26b7a78f2e6d13e1e27"><div class="ttname"><a href="../../da/d60/namespace_arena_spectator.html#a918c7c3c9fd7d26b7a78f2e6d13e1e27">ArenaSpectator::SendCommand_Aura</a></div><div class="ttdeci">void SendCommand_Aura(T *o, ObjectGuid targetGUID, const char *prefix, ObjectGuid caster, uint32 id, bool isDebuff, uint32 dispel, int32 dur, int32 maxdur, uint32 stack, bool remove)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/ded/_arena_spectator_8h_source.html#l00102">ArenaSpectator.h:102</a></div></div>
<div class="ttc" id="anamespace_byte_converter_html_a6177d7ac84a4ea6819c57a124345540e"><div class="ttname"><a href="../../de/d2e/namespace_byte_converter.html#a6177d7ac84a4ea6819c57a124345540e">ByteConverter::apply</a></div><div class="ttdeci">void apply(T *val)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/db2/_byte_converter_8h_source.html#l00040">ByteConverter.h:40</a></div></div>
<div class="ttc" id="anamespace_g3_d_html_ae911b90657d7162d47997c702af655a8"><div class="ttname"><a href="../../df/de2/namespace_g3_d.html#ae911b90657d7162d47997c702af655a8">G3D::uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dfa/g3dmath_8h_source.html#l00168">g3dmath.h:168</a></div></div>
<div class="ttc" id="anamespace_g3_d_html_aef6949de035da2287649c9db11ec3ba4"><div class="ttname"><a href="../../df/de2/namespace_g3_d.html#aef6949de035da2287649c9db11ec3ba4">G3D::uint8</a></div><div class="ttdeci">uint8_t uint8</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dfa/g3dmath_8h_source.html#l00164">g3dmath.h:164</a></div></div>
<div class="ttc" id="anamespace_g3_d_html_af80d9dbc6fa48c9ff714c7158adb60ae"><div class="ttname"><a href="../../df/de2/namespace_g3_d.html#af80d9dbc6fa48c9ff714c7158adb60ae">G3D::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dfa/g3dmath_8h_source.html#l00167">g3dmath.h:167</a></div></div>
<div class="ttc" id="anamespace_object_accessor_html_a02c2dfb59db7d7e2501dcc9a4f9baf07"><div class="ttname"><a href="../../d4/d27/namespace_object_accessor.html#a02c2dfb59db7d7e2501dcc9a4f9baf07">ObjectAccessor::GetUnit</a></div><div class="ttdeci">Unit * GetUnit(WorldObject const &amp;, ObjectGuid const guid)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d5d/_object_accessor_8cpp_source.html#l00199">ObjectAccessor.cpp:199</a></div></div>
<div class="ttc" id="anamespacedetail_1_1digits_html_aad69d2373aa047bdd9e81494bf3da5ae"><div class="ttname"><a href="../../df/d60/namespacedetail_1_1digits.html#aad69d2373aa047bdd9e81494bf3da5ae">detail::digits::result</a></div><div class="ttdeci">result</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d50/format-inl_8h_source.html#l00622">format-inl.h:622</a></div></div>
<div class="ttc" id="arecastnavigation_2_license_8txt_html_a0982397e348bfa91aa5cde96862ce11f"><div class="ttname"><a href="../../dc/dc5/recastnavigation_2_license_8txt.html#a0982397e348bfa91aa5cde96862ce11f">applications</a></div><div class="ttdeci">without any express or implied warranty In no event will the authors be held liable for any damages arising from the use of this software Permission is granted to anyone to use this software for any including commercial applications</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc5/recastnavigation_2_license_8txt_source.html#l00008">License.txt:8</a></div></div>
<div class="ttc" id="asrc_2common_2_logging_2_log_8h_html_a0e09b50c268dc6897a1c70aa46de936e"><div class="ttname"><a href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a0e09b50c268dc6897a1c70aa46de936e">LOG_FATAL</a></div><div class="ttdeci">#define LOG_FATAL(filterType__,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d07/src_2common_2_logging_2_log_8h_source.html#l00257">Log.h:257</a></div></div>
<div class="ttc" id="asrc_2common_2_logging_2_log_8h_html_a271e427d8e8481efd5cd5f537ec9e419"><div class="ttname"><a href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a271e427d8e8481efd5cd5f537ec9e419">LOG_INFO</a></div><div class="ttdeci">#define LOG_INFO(filterType__,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d07/src_2common_2_logging_2_log_8h_source.html#l00269">Log.h:269</a></div></div>
<div class="ttc" id="asrc_2common_2_logging_2_log_8h_html_a43832e3fa8508deb4ce43e520005fcd9"><div class="ttname"><a href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a43832e3fa8508deb4ce43e520005fcd9">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR(filterType__,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d07/src_2common_2_logging_2_log_8h_source.html#l00261">Log.h:261</a></div></div>
<div class="ttc" id="asrc_2common_2_logging_2_log_8h_html_a47ac782b14a7531c6232777165a1a161"><div class="ttname"><a href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a47ac782b14a7531c6232777165a1a161">LOG_DEBUG</a></div><div class="ttdeci">#define LOG_DEBUG(filterType__,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d07/src_2common_2_logging_2_log_8h_source.html#l00273">Log.h:273</a></div></div>
<div class="ttc" id="asrc_2common_2_utilities_2_random_8h_html_a4b15099bc81731469c5078a778673c94"><div class="ttname"><a href="../../d1/d65/src_2common_2_utilities_2_random_8h.html#a4b15099bc81731469c5078a778673c94">roll_chance_f</a></div><div class="ttdeci">bool roll_chance_f(float chance)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d65/src_2common_2_utilities_2_random_8h_source.html#l00053">Random.h:53</a></div></div>
<div class="ttc" id="asrc_2common_2_utilities_2_random_8h_html_a50320d4edff86db31b25138ae72161ad"><div class="ttname"><a href="../../d1/d65/src_2common_2_utilities_2_random_8h.html#a50320d4edff86db31b25138ae72161ad">roll_chance_i</a></div><div class="ttdeci">bool roll_chance_i(int chance)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d65/src_2common_2_utilities_2_random_8h_source.html#l00059">Random.h:59</a></div></div>
<div class="ttc" id="asrc_2common_2_utilities_2util_8h_html_ae00607f8188c59ffcea5a3997c0120b0"><div class="ttname"><a href="../../d9/de9/src_2common_2_utilities_2util_8h.html#ae00607f8188c59ffcea5a3997c0120b0">CalculatePct</a></div><div class="ttdeci">T CalculatePct(T base, U pct)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de9/src_2common_2_utilities_2util_8h_source.html#l00098">Util.h:98</a></div></div>
<div class="ttc" id="asrc_2common_2common_8h_html_a84190f79c8167211609f67284e066c58"><div class="ttname"><a href="../../d1/d8b/src_2common_2common_8h.html#a84190f79c8167211609f67284e066c58">IN_MILLISECONDS</a></div><div class="ttdeci">constexpr auto IN_MILLISECONDS</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8b/src_2common_2common_8h_source.html#l00062">Common.h:62</a></div></div>
<div class="ttc" id="astruct_acore_1_1_unit_list_searcher_html"><div class="ttname"><a href="../../da/d76/struct_acore_1_1_unit_list_searcher.html">Acore::UnitListSearcher</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dc9/_grid_notifiers_8h_source.html#l00391">GridNotifiers.h:392</a></div></div>
<div class="ttc" id="astruct_cell_html_a15697efba7478b6e227b5f3c7aafc961"><div class="ttname"><a href="../../dc/d9f/struct_cell.html#a15697efba7478b6e227b5f3c7aafc961">Cell::VisitAllObjects</a></div><div class="ttdeci">static void VisitAllObjects(WorldObject const *obj, T &amp;visitor, float radius, bool dont_load=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d39/_cell_impl_8h_source.html#l00207">CellImpl.h:207</a></div></div>
<div class="ttc" id="astruct_condition_source_info_html"><div class="ttname"><a href="../../df/dab/struct_condition_source_info.html">ConditionSourceInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d62/_condition_mgr_8h_source.html#l00177">ConditionMgr.h:178</a></div></div>
<div class="ttc" id="astruct_position_html_a4e813a59345a6275e8b87b96be03e60b"><div class="ttname"><a href="../../d1/d26/struct_position.html#a4e813a59345a6275e8b87b96be03e60b">Position::GetPositionZ</a></div><div class="ttdeci">float GetPositionZ() const</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d30/_object_8h_source.html#l00336">Object.h:336</a></div></div>
<div class="ttc" id="astruct_spell_modifier_html"><div class="ttname"><a href="../../d3/d39/struct_spell_modifier.html">SpellModifier</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d39/_player_8h_source.html#l00175">Player.h:176</a></div></div>
<div class="ttc" id="astruct_spell_proc_entry_html"><div class="ttname"><a href="../../d0/d79/struct_spell_proc_entry.html">SpellProcEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d75/_spell_mgr_8h_source.html#l00288">SpellMgr.h:289</a></div></div>
<div class="ttc" id="astruct_spell_proc_entry_html_a027db1efff77802e06a96f7464fc50d3"><div class="ttname"><a href="../../d0/d79/struct_spell_proc_entry.html#a027db1efff77802e06a96f7464fc50d3">SpellProcEntry::cooldown</a></div><div class="ttdeci">uint32 cooldown</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d75/_spell_mgr_8h_source.html#l00300">SpellMgr.h:300</a></div></div>
<div class="ttc" id="astruct_spell_proc_entry_html_a267045b5891b545a1edd3d321f251d1c"><div class="ttname"><a href="../../d0/d79/struct_spell_proc_entry.html#a267045b5891b545a1edd3d321f251d1c">SpellProcEntry::chance</a></div><div class="ttdeci">float chance</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d75/_spell_mgr_8h_source.html#l00299">SpellMgr.h:299</a></div></div>
<div class="ttc" id="astruct_spell_proc_entry_html_a69f23fe7134391526d6f98ad32e6628a"><div class="ttname"><a href="../../d0/d79/struct_spell_proc_entry.html#a69f23fe7134391526d6f98ad32e6628a">SpellProcEntry::ratePerMinute</a></div><div class="ttdeci">float ratePerMinute</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d75/_spell_mgr_8h_source.html#l00298">SpellMgr.h:298</a></div></div>
<div class="ttc" id="astructdata_html"><div class="ttname"><a href="../../df/dea/structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/ddf/fmt_2include_2fmt_2format_8h_source.html#l00897">format.h:897</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
