<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Azerotcore-wotlk: Logging system &quot;log4j-like&quot;</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Azerotcore-wotlk
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Logging system "log4j-like" </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md112"></a>
LOGGERS AND APPENDERS</h1>
<div class="fragment"><div class="line">Logging system has two components: loggers and appenders. These types of</div>
<div class="line">components enable users to log messages according to message type and level and</div>
<div class="line">control at runtime where they are reported.</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md113"></a>
1. &lt;strong&gt;LOGGERS&lt;/strong&gt;</h1>
<div class="fragment"><div class="line">The first and foremost advantage of this system resided in the ability to</div>
<div class="line">disable certain log statements while allowing others to print unhindered.</div>
<div class="line">This capability assumes that the loggers are categorized according to some</div>
<div class="line">developer-chosen criteria.</div>
</div><!-- fragment --><p>Loggers are named entitites. <a class="el" href="../../d3/d42/class_logger.html">Logger</a> names are case-sensitive and they follow the hierarchical naming rule:</p>
<div class="fragment"><div class="line">A Logger is said to be an ancestor of another logger if its name followed</div>
<div class="line">by a dot is a prefix of the descendant logger name. A logger is salid to be</div>
<div class="line">a parent of a child logger if there are no ancestors between itself and the</div>
<div class="line">descendant logger.</div>
</div><!-- fragment --><p>For example, the logger named <code>"entities.player"</code> is a parent of the logger named <code>"entities.player.character"</code>. Similarly, <code>"entities"</code> is a parent of <code>"entities.player"</code> and an ancestor of <code>"entities.player.character"</code>.</p>
<p>Loggers may be assigned levels. The set of possible levels are <code>TRACE</code>, <code>DEBUG</code>, <code>INFO</code>, <code>WARN</code>, <code>ERROR</code> AND <code>FATAL</code>, or be disabled using level <code>DISABLED</code>.</p>
<p>By definition the printing method determines the level of a logging request. For example:</p>
<div class="fragment"><div class="line"><a class="code" href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a271e427d8e8481efd5cd5f537ec9e419">LOG_INFO</a>(...) <span class="comment">// is a logging request of level INFO.</span></div>
<div class="ttc" id="asrc_2common_2_logging_2_log_8h_html_a271e427d8e8481efd5cd5f537ec9e419"><div class="ttname"><a href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a271e427d8e8481efd5cd5f537ec9e419">LOG_INFO</a></div><div class="ttdeci">#define LOG_INFO(filterType__,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d07/src_2common_2_logging_2_log_8h_source.html#l00269">Log.h:269</a></div></div>
</div><!-- fragment --><p>A logging request is said to be enabled if its level is less than or equal to the level of its logger. Otherwise, the request is said to be disabled. A logger without an assigned level will inherit one from the hierarchy</p>
<p>Example</p>
<div class="fragment"><div class="line">Logger Name        Assigned Level      Inherited Level</div>
<div class="line">root               Proot               Proot</div>
<div class="line">server             None                Proot</div>
</div><!-- fragment --><p>As <code>"server"</code> is not defined, it uses the root logger and it's log level.</p>
<div class="fragment"><div class="line">FATAL &lt; ERROR &lt; WARN &lt; INFO &lt; DEBUG &lt; TRACE</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md114"></a>
2. &lt;strong&gt;APPENDERS&lt;/strong&gt;</h1>
<div class="fragment"><div class="line">The ability to selectively enable of dissable logging request based on their</div>
<div class="line">loggers is only part of the picture. This system allows logging requests to</div>
<div class="line">print to multiple destinations. An output destination is called an appender.</div>
<div class="line">Current system defines appenders for Console, files and Database, but can be</div>
<div class="line">easily extended to remote socket server, NT event loggers, syslog daemons or</div>
<div class="line">any other system.</div>
</div><!-- fragment --><p>More than one appender can be attached to one logger. Each enabled logging request for a given logger will be forwarded to all the appenders in that logger</p>
<p><b>CONFIGURATION</b></p>
<p>System will read all config elements with prefix <code>"Logger."</code> and <code>"Appender."</code> and configure the logging system. If <code>"root"</code> can not be properly configured the core will remove all loggers and appenders and create a default set:</p>
<div class="fragment"><div class="line">- Logger &quot;root&quot; with log level Error</div>
<div class="line">- Logger &quot;server&quot; with log level Info</div>
<div class="line">- Appender &quot;Console&quot; to log to console</div>
</div><!-- fragment --><p><a class="el" href="../../d2/d52/class_appender.html">Appender</a> config line follows the format:</p>
<div class="fragment"><div class="line">Type,LogLevel,Flags,optional1,optional2</div>
</div><!-- fragment --><div class="fragment"><div class="line">Its a list of elements separated by comma where each element has its own meaning</div>
<div class="line">    Type: Type of the appender</div>
<div class="line">        1 - (Console)</div>
<div class="line">        2 - (File)</div>
<div class="line">        3 - (DB)</div>
<div class="line">    LogLevel</div>
<div class="line">        0 - (Disabled)</div>
<div class="line">        1 - (Fatal)</div>
<div class="line">        2 - (Error)</div>
<div class="line">        3 - (Warning)</div>
<div class="line">        4 - (Info)</div>
<div class="line">        5 - (Debug)</div>
<div class="line">        6 - (Trace)</div>
<div class="line">    Flags: Define some extra modifications to do to logging message</div>
<div class="line">        1 - Prefix Timestamp to the text</div>
<div class="line">        2 - Prefix Log Level to the text</div>
<div class="line">        4 - Prefix Log Filter type to the text</div>
<div class="line">        8 - Append timestamp to the log file name. Format: YYYY-MM-DD_HH-MM-SS</div>
<div class="line">            (Only used with Type = 2)</div>
<div class="line">       16 - Make a backup of existing file before overwrite</div>
<div class="line">            (Only used with Mode = w)</div>
</div><!-- fragment --><p>Depending on the type, elements <code>optional1</code> and <code>optional2</code> will take different </p><div class="fragment"><div class="line">Colors (read as optional1 if Type = Console)</div>
<div class="line">    Format: &quot;fatal error warn info debug trace&quot;</div>
<div class="line">    0 - BLACK</div>
<div class="line">    1 - RED</div>
<div class="line">    2 - GREEN</div>
<div class="line">    3 - BROWN</div>
<div class="line">    4 - BLUE</div>
<div class="line">    5 - MAGENTA</div>
<div class="line">    6 - CYAN</div>
<div class="line">    7 - GREY</div>
<div class="line">    8 - YELLOW</div>
<div class="line">    9 - LRED</div>
<div class="line">   10 - LGREEN</div>
<div class="line">   11 - LBLUE</div>
<div class="line">   12 - LMAGENTA</div>
<div class="line">   13 - LCYAN</div>
<div class="line">   14 - WHITE</div>
<div class="line">    Example: &quot;1 9 3 6 5 8&quot;</div>
<div class="line"> </div>
<div class="line">File: Name of the file (read as optional1 if Type = File)</div>
<div class="line">    Allows to use one &quot;%u&quot; to create dynamic files</div>
<div class="line"> </div>
<div class="line">Mode: Mode to open the file (read as optional2 if Type = File)</div>
<div class="line">    a - (Append)</div>
<div class="line">    w - (Overwrite)</div>
</div><!-- fragment --><p>Example:</p>
<div class="fragment"><div class="line">Appender.Console1=1,5,6</div>
</div><!-- fragment --><p>Creates new appender to log to console any message with log level <code>DEBUG</code> or less and prefixes log type and level to the message.</p>
<div class="fragment"><div class="line">Appender.Console2=1,2,1,&quot;1 9 3 6 5 8&quot;</div>
</div><!-- fragment --><p>Creates new appender to log to console any message with log level <code>ERROR</code> or less and prefixes timestamp to the message using colored text.</p>
<div class="fragment"><div class="line">Appender.File=2,5,7,Auth.log,w</div>
</div><!-- fragment --><p>Creates new appender to log to file <code>"Auth.log"</code> any message with log level <code>DEBUG</code> or less and prefixes timestamp, type and level to message</p>
<p>In the example, having two different loggers to log to console is perfectly legal but redundant.</p>
<p>Once we have the list of loggers to read, system will try to configure a new logger from its config line. <a class="el" href="../../d3/d42/class_logger.html">Logger</a> config line follows the format:</p>
<div class="fragment"><div class="line">LogLevel,AppenderList</div>
</div><!-- fragment --><p>Its a list of elements separated by comma where each element has its own meaning </p><div class="fragment"><div class="line">LogLevel</div>
<div class="line">    0 - (Disabled)</div>
<div class="line">    1 - (Fatal)</div>
<div class="line">    2 - (Error)</div>
<div class="line">    3 - (Warning)</div>
<div class="line">    4 - (Info)</div>
<div class="line">    5 - (Debug)</div>
<div class="line">    6 - (Trace)</div>
<div class="line">AppenderList: List of appenders linked to logger</div>
<div class="line">(Using spaces as separator).</div>
</div><!-- fragment --><p><b>EXAMPLES</b></p>
<ol type="1">
<li><b>EXAMPLE 1</b></li>
</ol>
<p><a class="el" href="../../d6/d70/class_log.html">Log</a> errors to console and a file called server.log that only contain logs for this server run. File should prefix timestamp, type and log level to the messages. Console should prefix type and log level.</p>
<div class="fragment"><div class="line">Appender.Console=1,2,6</div>
<div class="line">Appender.Server=2,2,7,Server.log,w</div>
<div class="line">Logger.root=2,Console Server</div>
</div><!-- fragment --><p>Lets trace how system will log two different messages:</p>
<div class="fragment"><div class="line"><a class="code" href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a43832e3fa8508deb4ce43e520005fcd9">LOG_ERROR</a>(<span class="stringliteral">&quot;guild&quot;</span>, <span class="stringliteral">&quot;Guild 1 created&quot;</span>);</div>
<div class="ttc" id="asrc_2common_2_logging_2_log_8h_html_a43832e3fa8508deb4ce43e520005fcd9"><div class="ttname"><a href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a43832e3fa8508deb4ce43e520005fcd9">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR(filterType__,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d07/src_2common_2_logging_2_log_8h_source.html#l00261">Log.h:261</a></div></div>
</div><!-- fragment --><p>System will try to find logger of type GUILD, as no logger is configured for GUILD it will use Root logger. As message <a class="el" href="../../d6/d70/class_log.html">Log</a> Level is equal or less than the <a class="el" href="../../d6/d70/class_log.html">Log</a> level of logger the message is sent to the Appenders configured in the <a class="el" href="../../d3/d42/class_logger.html">Logger</a>. <code>"Console"</code> and <code>"Server"</code>.</p>
<p>Console will write: </p><div class="fragment"><div class="line">&quot;ERROR [GUILD] Guild 1 created&quot;</div>
</div><!-- fragment --><p>Server will write to file </p><div class="fragment"><div class="line">&quot;2012-08-15 ERROR [GUILD] Guild 1 created&quot;</div>
</div><!-- fragment --><div class="fragment"><div class="line"><a class="code" href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a271e427d8e8481efd5cd5f537ec9e419">LOG_INFO</a>(<span class="stringliteral">&quot;entities.player.character&quot;</span>, <span class="stringliteral">&quot;Player Name Logged in&quot;</span>);</div>
</div><!-- fragment --><p>System will try to find logger of type <code>"character"</code>, as no logger is configured for <code>"character"</code> it will use Root logger. As message <a class="el" href="../../d6/d70/class_log.html">Log</a> Level is not equal or less than the <a class="el" href="../../d6/d70/class_log.html">Log</a> level of logger the message its discarted.</p>
<ol type="1">
<li><b>EXAMPLE 2</b></li>
</ol>
<p>Same example that above, but now i want to see all messages of level INFO on file and server file should add timestamp on creation.</p>
<div class="fragment"><div class="line">Appender.Console=1,2,6</div>
<div class="line">Appender.Server=2,4,15,Server.log</div>
<div class="line">Logger.root=3,Console Server</div>
</div><!-- fragment --><p>Lets trace how system will log two different messages: </p><div class="fragment"><div class="line"><a class="code" href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a43832e3fa8508deb4ce43e520005fcd9">LOG_ERROR</a>(<span class="stringliteral">&quot;guild&quot;</span>, <span class="stringliteral">&quot;Guild 1 created&quot;</span>);</div>
</div><!-- fragment --><p>Performs exactly as example 1.</p>
<div class="fragment"><div class="line"><a class="code" href="../../d3/d07/src_2common_2_logging_2_log_8h.html#a271e427d8e8481efd5cd5f537ec9e419">LOG_INFO</a>(<span class="stringliteral">&quot;entities.player.character&quot;</span>, <span class="stringliteral">&quot;Player Name Logged in&quot;</span>);</div>
</div><!-- fragment --><p>System will try to find logger of type <code>"character"</code>, as no logger is configured for <code>"character"</code> it will use Root logger. As message <a class="el" href="../../d6/d70/class_log.html">Log</a> Level is equal or less than the <a class="el" href="../../d6/d70/class_log.html">Log</a> level of logger the message is sent to the Appenders configured in the <a class="el" href="../../d3/d42/class_logger.html">Logger</a>. <code>"Console"</code> and <code>"Server"</code>. Console will discard msg as <a class="el" href="../../d6/d70/class_log.html">Log</a> Level is not less or equal to this appender</p>
<p>Server will write to file: </p><div class="fragment"><div class="line">&quot;2012-08-15 INFO [CHARACTER ] Player Name Logged in&quot;</div>
</div><!-- fragment --><ol type="1">
<li><b>EXAMPLE 3</b></li>
</ol>
<p>As a dev, i may be interested in logging just a particular part of the core while i'm trying to fix something. So... i want to debug <code>"guild"</code> to maximum and also some <code>"character"</code> events to some point. Also im checking some Waypoints so i want SQLDEV to be logged to file without prefixes. All other messages should only be logged to console, <code>"guild"</code> to <code>TRACE</code> and <code>"character"</code> to <code>INFO</code></p>
<div class="fragment"><div class="line">Appender.Console=1,6</div>
<div class="line">Appender.SQLDev=2,5,0,SQLDev.log</div>
<div class="line">Logger.guild=6,Console</div>
<div class="line">Logger.entities.player.character=4,Console</div>
<div class="line">Logger.sql.dev=4,SQLDev</div>
</div><!-- fragment --><p>With this config, any message logger with a <a class="el" href="../../d6/d70/class_log.html">Log</a> type different to <code>"guild"</code>, <code>"character"</code> or <code>"sql.dev"</code> will be ignored, as we didn't define a logger Root and system created a default Root disabled. <a class="el" href="../../d2/d52/class_appender.html">Appender</a> Console, log level should be defined to allow all possible messages of its loggers, in this case <code>"guild"</code> uses <code>TRACE (6)</code>, so <a class="el" href="../../d2/d52/class_appender.html">Appender</a> should allow it. <a class="el" href="../../d3/d42/class_logger.html">Logger</a> Characters will limit it's own messages to <code>INFO (4)</code> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
